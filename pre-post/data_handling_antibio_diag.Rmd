
```{r, include=params$log}
###
# study name: TIMCI
# program name: data_handling_antibio_diag.Rmd  
# program purpose: program that performs some data manipulation and derives variables for antibiotics and diagnosis anaylsis
# author: Silvia Cicconi  
###
```


```{r LOAD ANTIBIOTICS AND DIAGNOSIS}

#load antibiotics 
antibio_ke <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_ke)), "TIMCI Kenya diagnoses abx_CH.xlsx", sep="/")), 2)
antibio_se <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_se)), "TIMCI Senegal diagnoses abx_CH.xlsx", sep="/")), 2)
antibio_old <- read.xlsx(file.path(paste(dirname(dirname(dirname(dir_dat_se))), "drug_coding_old.xlsx", sep="/")))

#extend "other" code
antibio_ke[which(antibio_ke$code=="rx_antibio_oth_hf"):nrow(antibio_ke),"code"] <- "rx_antibio_oth_hf"
antibio_se[which(antibio_se$code=="rx_antibio_oth_hf"):nrow(antibio_se),"code"] <- "rx_antibio_oth_hf"

```

```{r FORMAT AND SELECT OLD ANTIBIOTICS AND ANTIMALARIALS}

#split number and corresponding drug name
antibio_old$num <- substr(antibio_old[,1],1,2)

#remove commas if included (in case number was single digit)
antibio_old$num <- gsub(",", "", antibio_old$num)

#select antibiotics common to both countries
old_list <- antibio_old$num[which(antibio_old$sys.antibio=="y")]

#select antibiotics from Kenya and Senegal separately
old_list_ke <- antibio_old$Kenya.num[which(antibio_old$sys.antibio.kenya=="y")]
old_list_se <- antibio_old$Senegal.num[which(antibio_old$sys.antibio.senegal=="y")]

#select antimalarials 
old_list_antimal <- antibio_old$num[which(antibio_old$antimalarials=="y")]

##split multiple drugs into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11)
d1 <- max(lengths(regmatches(d0$rx_misc, gregexpr(";", d0$rx_misc))))+1; d1 #max n
d0 <- separate(d0, rx_misc, into = paste("rx_misc", seq(1,d1,1), sep="_"), sep = ";", fill = "right", remove=F)

d2 <- max(lengths(regmatches(d0$rx_misc_hf, gregexpr(";", d0$rx_misc_hf))))+1; d2 #max n
d0 <- separate(d0, rx_misc_hf, into = paste("rx_misc_hf", seq(1,d2,1), sep="_"), sep = ";", fill = "right", remove=F)


#generate antimalarials old flag
d0$antimal_old <- 0
for(i in 1:d1){
  d0$antimal_old[which(d0[,paste("rx_misc", i, sep="_")]%in%old_list_antimal)] <- 1
}
d0$antimal_old_hf <- 0
for(j in 1:d2){
  d0$antimal_old_hf[which(d0[,paste("rx_misc_hf", i, sep="_")]%in%old_list_antimal)] <- 1
}

#generate antibiotics old flag
d0$antibio_old <- 0
for(i in 1:d1){
  d0$antibio_old[which(d0$country=="ke" & d0[,paste("rx_misc", i, sep="_")]%in%c(old_list, old_list_ke))] <- 1
    d0$antibio_old[which(d0$country=="se" & d0[,paste("rx_misc", i, sep="_")]%in%c(old_list, old_list_se))] <- 1
}
d0$antibio_old_hf <- 0
for(j in 1:d2){
  d0$antibio_old_hf[which(d0$country=="ke" & d0[,paste("rx_misc_hf", j, sep="_")]%in%c(old_list, old_list_ke))] <- 1
    d0$antibio_old_hf[which(d0$country=="se" & d0[,paste("rx_misc_hf", j, sep="_")]%in%c(old_list, old_list_se))] <- 1
}


#add antibiotics with specific route
antibio_old[which(antibio_old$sys.antibio!="y"),]

#check single-drug question route
#cipro
d0_cb_ke[which(d0_cb_ke$db_name=="rx_ciprofloxacin_route"), c("db_name", "value", "category")]
d0_cb_se[which(d0_cb_se$name=="rx_ciprofloxacin_route"), c("name", "values")]

for(i in 1:d1){
  d0$antibio_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Ciprofloxacin", antibio_old[,1])] & d0$rx_ciprofloxacin_route%in%c(1,2))] <- 1
}
for(j in 1:d2){
  d0$antibio_old_hf[which(d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Ciprofloxacin", antibio_old[,1])] & d0$rx_ciprofloxacin_route_hf%in%c(1,2))] <- 1
}


#genta
d0_cb_ke[which(d0_cb_ke$db_name=="rx_gentamicin_route"), c("db_name", "value", "category")]
d0_cb_se[which(d0_cb_se$name=="rx_gentamicin_route"), c("name", "values")]

for(i in 1:d1){
  for(k in 1:d1){
  d0$antibio_old[which((d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Gentamicin", antibio_old[,1])] & d0$rx_gentamicin_route==2) | (d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Gentamicin", antibio_old[,1])] & d0$rx_gentamicin_route==98 & (d0[,paste("rx_misc", k, sep="_")]==antibio_old$num[grep("Amoxicillin", antibio_old[,1])][1] | d0[,paste("rx_misc", k, sep="_")]==antibio_old$num[grep("Amoxicillin", antibio_old[,1])][1] | d0[,paste("rx_misc", k, sep="_")]==antibio_old$num[grep("Benzylpenicillin", antibio_old[,1])] | d0[,paste("rx_misc", k, sep="_")]==antibio_old$num[grep("Ampicillin", antibio_old[,1])])))] <- 1
}}
for(j in 1:d2){
    for(k in 1:d1){
   d0$antibio_old_hf[which((d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Gentamicin", antibio_old[,1])] & d0$rx_gentamicin_route_hf==2) | (d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Gentamicin", antibio_old[,1])] & d0$rx_gentamicin_route_hf==98 & (d0[,paste("rx_misc_hf", k, sep="_")]==antibio_old$num[grep("Amoxicillin", antibio_old[,1])][1] | d0[,paste("rx_misc_hf", k, sep="_")]==antibio_old$num[grep("Benzylpenicillin", antibio_old[,1])] | d0[,paste("rx_misc_hf", k, sep="_")]==antibio_old$num[grep("Ampicillin", antibio_old[,1])])))] <- 1
}}



```

```{r ANTIMALARIAL PRESCRIPTION}

#flag antimalarials prescription
d0_cb_ke[which(d0_cb_ke$db_name=="rx_antimalarials"), c("db_name", "value", "category")]

#flag
d0$antimal_flag <- 0
d0$antimal_flag[which((!is.na(d0$rx_antimalarials) & d0$rx_antimalarials!=96) | (!is.na(d0$rx_antimalarials_hf) & d0$rx_antimalarials_hf!=96) | d0$antimal_old==1 | d0$antimal_old_hf==1)] <- 1
d0$antimal_flag <- as.factor(d0$antimal_flag)

```

```{r ANTIBIOTICS PRESCRIPTION}

##check single-drug questions for antibiotics
names(d0)[which(substr(names(d0), 1, 2)=="rx")]

#select systemic antibiotics from "other" list (as defined with clinical team)
other_ke_list <- antibio_ke$value[which(antibio_ke$Systemic.abx=="y" & antibio_ke$code=="rx_antibio_oth_hf")]; other_ke_list
other_se_list <- antibio_se$value[which(antibio_se$Systemic.abx=="y" & antibio_se$code=="rx_antibio_oth_hf")]; other_se_list

##generate flag for other antibiotics
##split multiple drugs into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11)
a1 <- max(lengths(regmatches(d0$rx_antibio_oth, gregexpr(" ", d0$rx_antibio_oth))))+1; a1 #max n
d0 <- separate(d0, rx_antibio_oth, into = paste("rx_antibio_oth", seq(1,a1,1), sep="_"), sep = " ", fill = "right", remove=F)

a2 <- max(lengths(regmatches(d0$rx_antibio_oth_hf, gregexpr(" ", d0$rx_antibio_oth_hf))))+1; a2 #max n
d0 <- separate(d0, rx_antibio_oth_hf, into = paste("rx_antibio_oth_hf", seq(1,a2,1), sep="_"), sep = " ", fill = "right", remove=F)


d0$antibio_other <- 0
for(i in 1:a1){
  d0$antibio_other[which(d0$country=="ke" & d0[,paste("rx_antibio_oth", i, sep="_")]%in%other_ke_list)] <- 1
    d0$antibio_other[which(d0$country=="se" & d0[,paste("rx_antibio_oth", i, sep="_")]%in%other_se_list)] <- 1
}
d0$antibio_other_hf <- 0
for(j in 1:a2){
  d0$antibio_other_hf[which(d0$country=="ke" & d0[,paste("rx_antibio_oth_hf", j, sep="_")]%in%other_ke_list)] <- 1
    d0$antibio_other_hf[which(d0$country=="se" & d0[,paste("rx_antibio_oth_hf", j, sep="_")]%in%other_se_list)] <- 1
}


######################################
#flag antibiotics prescription
d0$antibio <- 0
d0$antibio[which(d0$rx_amoxicillin==1 | d0$rx_aclav==1 | d0$rx_ampicillin==1 |  d0$rx_azithromycin==1 | d0$rx_penicillinG==1 | d0$rx_benzathinepeniG==1 |  d0$rx_ceftriaxone==1 |  d0$rx_cef_antibiotics==1 | (d0$rx_ciprofloxacin==1 & d0$rx_ciprofloxacin_route%in%c(1,2)) |  d0$rx_cotrimoxazole==1 |  d0$rx_metronidazol==1  |  (d0$rx_gentamicin==1 & d0$rx_gentamicin_route==2) | (d0$rx_gentamicin==1 & d0$rx_gentamicin_route==98 & (d0$rx_amoxicillin==1 | d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1 | d0$rx_ampicillin==1)))] <- 1 #single drugs
d0$antibio[which(d0$antibio==0 & (d0$antibio_old==1 | d0$antibio_other==1))] <- 1 #if no single drugs selected, other

d0$antibio_hf <- 0
d0$antibio_hf[which(d0$rx_amoxicillin_hf==1 | d0$rx_aclav_hf==1 | d0$rx_ampicillin_hf==1 |  d0$rx_azithromycin_hf==1 | d0$rx_penicillinG_hf==1 | d0$rx_benzathinepeniG_hf==1 |  d0$rx_ceftriaxone_hf==1 |  d0$rx_cef_antibiotics_hf==1 | (d0$rx_ciprofloxacin_hf==1 & d0$rx_ciprofloxacin_route_hf%in%c(1,2)) |  d0$rx_cotrimoxazole_hf==1 | d0$rx_metronidazol_hf==1  |  (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf==2) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf==98 & (d0$rx_amoxicillin_hf==1 | d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1 | d0$rx_ampicillin_hf==1)))] <- 1 #single drugs
d0$antibio_hf[which(d0$antibio_hf==0 & (d0$antibio_old_hf==1 | d0$antibio_other_hf==1))] <- 1 #if no single drugs selected, other


#flag if one of the two sources recorded antibiotic prescription
d0$antibio_flag <- 0
d0$antibio_flag[which(d0$antibio==1 | d0$antibio_hf==1)] <- 1
d0$antibio_flag <- as.factor(d0$antibio_flag)

```

```{r LOAD DIAGNOSIS}

#load data
dia_ke_yi <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_ke)), "TIMCI Kenya diagnoses abx_YI.xlsx", sep="/")), 1)
dia_ke_ch <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_ke)), "TIMCI Kenya diagnoses abx_CH.xlsx", sep="/")), 1)

dia_se_yi <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_se)), "TIMCI Senegal diagnoses abx_YI.xlsx", sep="/")), 1)
dia_se_ch <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_se)), "TIMCI Senegal diagnoses abx_CH.xlsx", sep="/")), 1)


#ensure all y/n low cases in last columns
for(i in 4:ncol(dia_ke_yi)) dia_ke_yi[which(dia_ke_yi[,i]=="Y" | dia_ke_yi[,i]=="N" | dia_ke_yi[,i]=="Maybe"), i] <- tolower(dia_ke_yi[which(dia_ke_yi[,i]=="Y" | dia_ke_yi[,i]=="N" | dia_ke_yi[,i]=="Maybe"), i])
for(i in 4:ncol(dia_ke_ch)) dia_ke_ch[which(dia_ke_ch[,i]=="Y" | dia_ke_ch[,i]=="N" | dia_ke_ch[,i]=="Maybe"), i] <- tolower(dia_ke_ch[which(dia_ke_ch[,i]=="Y" | dia_ke_ch[,i]=="N"  | dia_ke_ch[,i]=="Maybe"), i])

for(i in 4:ncol(dia_se_yi)) dia_se_yi[which(dia_se_yi[,i]=="Y" | dia_se_yi[,i]=="N" | dia_se_yi[,i]=="Maybe"), i] <- tolower(dia_se_yi[which(dia_se_yi[,i]=="Y" | dia_se_yi[,i]=="N" | dia_se_yi[,i]=="Maybe"), i])
for(i in 4:ncol(dia_se_ch)) dia_se_ch[which(dia_se_ch[,i]=="Y" | dia_se_ch[,i]=="N" | dia_se_ch[,i]=="Maybe"), i] <- tolower(dia_se_ch[which(dia_se_ch[,i]=="Y" | dia_se_ch[,i]=="N" | dia_se_ch[,i]=="Maybe"), i])


#add IMCI code variable (unique code ID)
dia_ke_yi$IMCI.code <- c(paste(seq(10, (109), 1), "ke_yi", sep=""), paste("ke_yi", seq(10, ((nrow(dia_ke_yi)-100)+9), 1), sep=""))
dia_ke_ch$IMCI.code <- paste(seq(10, (nrow(dia_ke_ch)+9), 1), "ke_ch", sep="")

dia_se_yi$IMCI.code <- paste(seq(10, (nrow(dia_se_yi)+9), 1), "se_yi", sep="")
dia_se_ch$IMCI.code <- paste(seq(10, (nrow(dia_se_ch)+9), 1), "se_ch", sep="")


##split multiple diagnosis or symptoms into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11)
n1 <- max(lengths(regmatches(d0$dx, gregexpr(";", d0$dx))))+1; n1 #max n
d0 <- separate(d0, dx, into = paste("dx", seq(1,n1,1), sep="_"), sep = ";", fill = "right", remove=F)

n2 <- max(lengths(regmatches(d0$dx_mlist, gregexpr(";", d0$dx_mlist))))+1; n2 #max n
d0 <- separate(d0, dx_mlist, into = paste("dx_mlist", seq(1,n2,1), sep="_"), sep = ";", fill = "right", remove=F)


```

```{r FORMAT SENEGAL CODEBOOK FOR DIAGNOSIS}

#only diagnosis variables
cb_se <- d0_cb_se[which(d0_cb_se$name%in%c("dx", "dx_mlist")), c("name", "values")] 

#separate each option in a different row
cb_se <- separate_rows(cb_se, values, sep="\\|")

#separate columns
cb_se <- separate(cb_se, values, into = c("value","category"), sep = "=", fill = "right", remove=F)

```

```{r IMCI DIAGNOSIS CODING YI KENYA}

#derive a variable that code IMCI diagnosis 
#as a child can have more than one diagnosis, it needs to allow appending multiple ones

###flag
d0$IMCI_der <- ""

#Possible Serious Bacterial Infection or Very Severe Disease
dia_ke_yi[1,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$temp_meas>=38 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsion"))] |
(d0$dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Loss of appetite", "Suspected meningitis", "Very severe disease", "Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion", "CNS Danger sign"))] |
                   (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe pneumonia / very severe disease", "IMCI/IMAI Pneumonia"))] & d0$who_age_ctg=="[1-6d]") |
(d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] & d0$temp_meas>=38))) |
(d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] & d0$temp_meas>=38))  )] <- paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$temp_meas>=38 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsion"))] |
(d0$dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Loss of appetite", "Suspected meningitis", "Very severe disease", "Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion", "CNS Danger sign"))] |
                   (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe pneumonia / very severe disease", "IMCI/IMAI Pneumonia"))] & d0$who_age_ctg=="[1-6d]") |
(d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] & d0$temp_meas>=38))) |
(d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] & d0$temp_meas>=38))  )], dia_ke_yi$IMCI.code[1], sep=";")
  
  }
}

#Pneumonia
dia_ke_yi[2,2:3]
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]"))  )] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]"))  )], dia_ke_yi$IMCI.code[2], sep=";")
}


#Local Infection
dia_ke_yi[3,2:3] #not specified


#Infection unlikely
dia_ke_yi[4,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough / cold / URTI"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough", "Common cold"))] ))  )] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough / cold / URTI"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough", "Common cold"))] ))  )], dia_ke_yi$IMCI.code[4], sep=";")
}
}


#Very low weight for age
dia_ke_yi[5,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_other_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] & d0$who_age_ctg=="[1-6d]") | (d0$wt_meas<2 & d0$who_age_ctg=="[1-6d]") ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_other_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] & d0$who_age_ctg=="[1-6d]") | (d0$wt_meas<2 & d0$who_age_ctg=="[1-6d]") ) )], dia_ke_yi$IMCI.code[5], sep=";")
}


#Low weight for age or feeding problem
dia_ke_yi[6,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Low weight"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0$dx_oth_yn==1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Oral Candidiasis", "Oral aphthous ulcers", "Herpes simplex - Oral Lesions (Herpes labialis)"))])) )    )] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Low weight"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0$dx_oth_yn==1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Oral Candidiasis", "Oral aphthous ulcers", "Herpes simplex - Oral Lesions (Herpes labialis)"))])) )    )], dia_ke_yi$IMCI.code[6], sep=";")
}
}

#No Feeding Problem
dia_ke_yi[7,2:3] #not specified


#Severe Dehydration
dia_ke_yi[8,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Dehydration"))]) ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Dehydration"))]) ) )], dia_ke_yi$IMCI.code[8], sep=";")
}


#Some Dehydration
dia_ke_yi[9,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Some Dehydration"))]) ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Some Dehydration"))]) ) )], dia_ke_yi$IMCI.code[9], sep=";")
}


#No Dehydration
dia_ke_yi[10,2:3]
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==0 | (d0$dx_dehydration==1 & d0$dx_dehydration_severity==0))) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==0 | (d0$dx_dehydration==1 & d0$dx_dehydration_severity==0))) ) ], dia_ke_yi$IMCI.code[10], sep=";")


#HIV Confirmed
dia_ke_yi[11,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known HIV"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV"))]) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known HIV"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV"))]) ) ], dia_ke_yi$IMCI.code[11], sep=";")
}
}

#HIV Exposed
dia_ke_yi[12,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Possible HIV", "Negative HIV test"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Possible HIV", "Negative HIV test"))] )], dia_ke_yi$IMCI.code[12], sep=";")
}

#HIV Infection Status Unknown 
dia_ke_yi[13,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV screening unavailable"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV screening unavailable"))] )], dia_ke_yi$IMCI.code[13], sep=";")
}


#HIV Infection Unlikely 
dia_ke_yi[14,2:3] #not specified

#Severe Jaundice
dia_ke_yi[15,2:3] #not specified

#Jaundice
dia_ke_yi[16,2:3] #not specified

#No Jaundice
dia_ke_yi[17,2:3] #not specified

#Other
dia_ke_yi[18,2:3] #not specified
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Febrile urinary tract infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Febrile urinary tract infection"))] )], dia_ke_yi$IMCI.code[18], sep=";")
}


dia_ke_yi[19,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Asthma"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Asthma"))] )], dia_ke_yi$IMCI.code[19], sep=";")
}


dia_ke_yi[20,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bronchiolitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bronchiolitis"))] )], dia_ke_yi$IMCI.code[20], sep=";")
}

dia_ke_yi[21,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Wheeze / wheezing"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Wheeze / wheezing"))] )], dia_ke_yi$IMCI.code[21], sep=";")
}

dia_ke_yi[22,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))] )], dia_ke_yi$IMCI.code[22], sep=";")
}

dia_ke_yi[23,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] )], dia_ke_yi$IMCI.code[23], sep=";")
}

dia_ke_yi[24,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tuberculosis (TB)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tuberculosis (TB)"))] )], dia_ke_yi$IMCI.code[24], sep=";")
}

dia_ke_yi[25,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] )], dia_ke_yi$IMCI.code[25], sep=";")
}

dia_ke_yi[26,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5) )], dia_ke_yi$IMCI.code[26], sep=";")

dia_ke_yi[27,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) )], dia_ke_yi$IMCI.code[27], sep=";")

dia_ke_yi[28,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5) )], dia_ke_yi$IMCI.code[28], sep=";")

dia_ke_yi[29,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) )], dia_ke_yi$IMCI.code[29], sep=";")

dia_ke_yi[30,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_ear_infection==1) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_ear_infection==1)], dia_ke_yi$IMCI.code[30], sep=";")

dia_ke_yi[31,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe anemia"))])) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe anemia"))])) )], dia_ke_yi$IMCI.code[31], sep=";")
}

dia_ke_yi[32,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(0,3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild/Moderate anemia"))])) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(0,3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild/Moderate anemia"))])) )], dia_ke_yi$IMCI.code[32], sep=";")
}

dia_ke_yi[33,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated severe acute malnutrition", "Uncomplicated Severe acute malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated severe acute malnutrition", "Uncomplicated Severe acute malnutrition"))] )], dia_ke_yi$IMCI.code[33], sep=";")
}

dia_ke_yi[34,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate malnutrition"))] )], dia_ke_yi$IMCI.code[34], sep=";")
}


dia_ke_yi[35,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated prolonged fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated prolonged fever"))] )], dia_ke_yi$IMCI.code[35], sep=";")
}

dia_ke_yi[36,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Prolonged Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Prolonged Fever"))] )], dia_ke_yi$IMCI.code[36], sep=";")
}

dia_ke_yi[37,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition"))] )], dia_ke_yi$IMCI.code[37], sep=";")
}

dia_ke_yi[38,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis"))] )], dia_ke_yi$IMCI.code[38], sep=";")
}

dia_ke_yi[39,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Lower urinary tract infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Lower urinary tract infection"))] )], dia_ke_yi$IMCI.code[39], sep=";")
}

dia_ke_yi[40,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Conjunctivitis"))] )], dia_ke_yi$IMCI.code[40], sep=";")
}

dia_ke_yi[41,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess"))] )], dia_ke_yi$IMCI.code[41], sep=";")
}

dia_ke_yi[42,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Simple abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Simple abscess"))] )], dia_ke_yi$IMCI.code[42], sep=";")
}

dia_ke_yi[43,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated cellulitis"))] )], dia_ke_yi$IMCI.code[43], sep=";")
}

dia_ke_yi[44,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Cellulitis"))] )], dia_ke_yi$IMCI.code[44], sep=";")
}

dia_ke_yi[45,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated deep wound"))] )], dia_ke_yi$IMCI.code[45], sep=";")
}

dia_ke_yi[46,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated superifical wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated superifical wound"))] )], dia_ke_yi$IMCI.code[46], sep=";")
}

dia_ke_yi[47,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Acute Ear Infection"))] )], dia_ke_yi$IMCI.code[47], sep=";")
}


dia_ke_yi[48,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Acute Ear Infection"))] )], dia_ke_yi$IMCI.code[48], sep=";")
}

dia_ke_yi[49,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Chronic Ear Infection"))] )], dia_ke_yi$IMCI.code[49], sep=";")
}

dia_ke_yi[50,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection"))] )], dia_ke_yi$IMCI.code[50], sep=";")
}

dia_ke_yi[51,2:3] 
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) )], dia_ke_yi$IMCI.code[51], sep=";")

dia_ke_yi[52,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe suspected malaria"))] )], dia_ke_yi$IMCI.code[52], sep=";")
}

dia_ke_yi[53,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated malaria"))] )], dia_ke_yi$IMCI.code[53], sep=";")
}

dia_ke_yi[54,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspected malaria"))] )], dia_ke_yi$IMCI.code[54], sep=";")
}

dia_ke_yi[55,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of Tuberculosis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of Tuberculosis"))] )], dia_ke_yi$IMCI.code[55], sep=";")
}

dia_ke_yi[56,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever without source: Presumed viral illness"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever without source: Presumed viral illness"))] )], dia_ke_yi$IMCI.code[56], sep=";")
}

dia_ke_yi[57,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Reactive Airway Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Reactive Airway Disease"))] )], dia_ke_yi$IMCI.code[57], sep=";")
}

dia_ke_yi[58,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Croup"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Croup"))] )], dia_ke_yi$IMCI.code[58], sep=";")
}

dia_ke_yi[59,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild Croup"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild Croup"))] )], dia_ke_yi$IMCI.code[59], sep=";")
}

dia_ke_yi[60,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of foreign object in airways"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of foreign object in airways"))] )], dia_ke_yi$IMCI.code[60], sep=";")
}

dia_ke_yi[61,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Significant hemoptysis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Significant hemoptysis"))] )], dia_ke_yi$IMCI.code[61], sep=";")
}

dia_ke_yi[62,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe persistent diarrhoea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe persistent diarrhoea"))] )], dia_ke_yi$IMCI.code[62], sep=";")
}

dia_ke_yi[63,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Persistent diarrhea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Persistent diarrhea"))] )], dia_ke_yi$IMCI.code[63], sep=";")
}

dia_ke_yi[64,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea"))] )], dia_ke_yi$IMCI.code[64], sep=";")
}


dia_ke_yi[65,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-Severe Abdominal Condition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-Severe Abdominal Condition"))] )], dia_ke_yi$IMCI.code[65], sep=";")
}

dia_ke_yi[66,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Constipation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Constipation"))] )], dia_ke_yi$IMCI.code[66], sep=";")
}

dia_ke_yi[67,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Oxyuriasis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Oxyuriasis"))] )], dia_ke_yi$IMCI.code[67], sep=";")
}

dia_ke_yi[68,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Balanitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Balanitis"))] )], dia_ke_yi$IMCI.code[68], sep=";")
}

dia_ke_yi[69,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Vulvovaginitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Vulvovaginitis"))] )], dia_ke_yi$IMCI.code[69], sep=";")
}


dia_ke_yi[70,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Inguinal hernia"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Inguinal hernia"))] )], dia_ke_yi$IMCI.code[70], sep=";")
}


dia_ke_yi[71,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspected Testicular Torsion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspected Testicular Torsion"))] )], dia_ke_yi$IMCI.code[71], sep=";")
}

dia_ke_yi[72,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] )], dia_ke_yi$IMCI.code[72], sep=";")
}

dia_ke_yi[73,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection"))] )], dia_ke_yi$IMCI.code[73], sep=";")
}

dia_ke_yi[74,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Foreign body in ear"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Foreign body in ear"))] )], dia_ke_yi$IMCI.code[74], sep=";")
}

dia_ke_yi[75,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Acute Pharyngitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Acute Pharyngitis"))] )], dia_ke_yi$IMCI.code[75], sep=";")
}

dia_ke_yi[76,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Viral Acute Pharyngitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Viral Acute Pharyngitis"))] )], dia_ke_yi$IMCI.code[76], sep=";")
}

dia_ke_yi[77,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Neck mass"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Neck mass"))] )], dia_ke_yi$IMCI.code[77], sep=";")
}

dia_ke_yi[78,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Infectious uncomplicated lymphadenitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Infectious uncomplicated lymphadenitis"))] )], dia_ke_yi$IMCI.code[78], sep=";")
}

dia_ke_yi[79,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated lymphadenopathy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated lymphadenopathy"))] )], dia_ke_yi$IMCI.code[79], sep=";")
}

dia_ke_yi[80,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mumps"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mumps"))] )], dia_ke_yi$IMCI.code[80], sep=";")
}

dia_ke_yi[81,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Viral Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Viral Conjunctivitis"))] )], dia_ke_yi$IMCI.code[81], sep=";")
}

dia_ke_yi[82,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Orbital Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Orbital Cellulitis"))] )], dia_ke_yi$IMCI.code[82], sep=";")
}

dia_ke_yi[83,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Preseptal Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Preseptal Cellulitis"))] )], dia_ke_yi$IMCI.code[83], sep=";")
}

dia_ke_yi[84,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Eye Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Eye Disease"))] )], dia_ke_yi$IMCI.code[84], sep=";")
}

dia_ke_yi[85,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Corneal Abrasion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Corneal Abrasion"))] )], dia_ke_yi$IMCI.code[85], sep=";")
}

dia_ke_yi[86,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe complicated measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe complicated measles"))] )], dia_ke_yi$IMCI.code[86], sep=";")
}

dia_ke_yi[87,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Measles with eye or mouth complications"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Measles with eye or mouth complications"))] )], dia_ke_yi$IMCI.code[87], sep=";")
}

dia_ke_yi[88,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-severe measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-severe measles"))] )], dia_ke_yi$IMCI.code[88], sep=";")
}

dia_ke_yi[89,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated chicken pox"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated chicken pox"))] )], dia_ke_yi$IMCI.code[89], sep=";")
}

dia_ke_yi[90,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated chicken pox"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated chicken pox"))] )], dia_ke_yi$IMCI.code[90], sep=";")
}

dia_ke_yi[91,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non specific viral rash"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non specific viral rash"))] )], dia_ke_yi$IMCI.code[91], sep=";")
}

dia_ke_yi[92,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Scarlet Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Scarlet Fever"))] )], dia_ke_yi$IMCI.code[92], sep=";")
}

dia_ke_yi[93,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Anaphylaxis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Anaphylaxis"))] )], dia_ke_yi$IMCI.code[93], sep=";")
}

dia_ke_yi[94,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Urticaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Urticaria"))] )], dia_ke_yi$IMCI.code[94], sep=";")
}

dia_ke_yi[95,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Eczema (Atopic dermatitis)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Eczema (Atopic dermatitis)"))] )], dia_ke_yi$IMCI.code[95], sep=";")
}

dia_ke_yi[96,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Heat rash (Milliaria crystallina/rubra)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Heat rash (Milliaria crystallina/rubra)"))] )], dia_ke_yi$IMCI.code[96], sep=";")
}

dia_ke_yi[97,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Diaper rash"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Diaper rash"))] )], dia_ke_yi$IMCI.code[97], sep=";")
}

dia_ke_yi[98,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Impetigo"))] )], dia_ke_yi$IMCI.code[98], sep=";")
}

dia_ke_yi[99,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Impetigo"))] )], dia_ke_yi$IMCI.code[99], sep=";")
}

dia_ke_yi[100,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Extensive folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Extensive folliculitis"))] )], dia_ke_yi$IMCI.code[100], sep=";")
}

dia_ke_yi[101,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Folliculitis"))] )], dia_ke_yi$IMCI.code[101], sep=";")
}

dia_ke_yi[102,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Molluscum contagiosum"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Molluscum contagiosum"))] )], dia_ke_yi$IMCI.code[102], sep=";")
}

dia_ke_yi[103,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Generalized (extensive) Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Generalized (extensive) Tinea corporis"))] )], dia_ke_yi$IMCI.code[103], sep=";")
}

dia_ke_yi[104,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tinea corporis"))] )], dia_ke_yi$IMCI.code[104], sep=";")
}

dia_ke_yi[105,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tinea Capitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tinea Capitis"))] )], dia_ke_yi$IMCI.code[105], sep=";")
}

dia_ke_yi[106,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Scabies"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Scabies"))] )], dia_ke_yi$IMCI.code[106], sep=";")
}

dia_ke_yi[107,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pediculosis (Head lice)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pediculosis (Head lice)"))] )], dia_ke_yi$IMCI.code[107], sep=";")
}

dia_ke_yi[108,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis"))] )], dia_ke_yi$IMCI.code[108], sep=";")
}

dia_ke_yi[109,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic limp or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic limp or joint pain"))] )], dia_ke_yi$IMCI.code[109], sep=";")
}

dia_ke_yi[110,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute limp or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute limp or joint pain"))] )], dia_ke_yi$IMCI.code[110], sep=";")
}

dia_ke_yi[111,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated deep wound"))] )], dia_ke_yi$IMCI.code[111], sep=";")
}

dia_ke_yi[112,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated superficial wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated superficial wound"))] )], dia_ke_yi$IMCI.code[112], sep=";")
}

dia_ke_yi[113,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Confirmed fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Confirmed fracture"))] )], dia_ke_yi$IMCI.code[113], sep=";")
}

dia_ke_yi[114,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Confirmed dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Confirmed dislocation"))] )], dia_ke_yi$IMCI.code[114], sep=";")
}

dia_ke_yi[115,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of fracture/dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of fracture/dislocation"))] )], dia_ke_yi$IMCI.code[115], sep=";")
}

dia_ke_yi[116,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Clavicular fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Clavicular fracture"))] )], dia_ke_yi$IMCI.code[116], sep=";")
}

dia_ke_yi[117,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Contusion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Contusion"))] )], dia_ke_yi$IMCI.code[117], sep=";")
}

dia_ke_yi[118,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major head injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major head injury"))] )], dia_ke_yi$IMCI.code[118], sep=";")
}

dia_ke_yi[119,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate Head Injury"))] )], dia_ke_yi$IMCI.code[119], sep=";")
}

dia_ke_yi[120,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Minor Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Minor Head Injury"))] )], dia_ke_yi$IMCI.code[120], sep=";")
}

dia_ke_yi[121,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major Burn"))] )], dia_ke_yi$IMCI.code[121], sep=";")
}

dia_ke_yi[122,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Minor Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Minor Burn"))] )], dia_ke_yi$IMCI.code[122], sep=";")
}

dia_ke_yi[123,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Inhalation injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Inhalation injury"))] )], dia_ke_yi$IMCI.code[123], sep=";")
}

dia_ke_yi[124,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Carbon monoxide poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Carbon monoxide poisoning"))] )], dia_ke_yi$IMCI.code[124], sep=";")
}

dia_ke_yi[125,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of poisoning"))] )], dia_ke_yi$IMCI.code[125], sep=";")
}

dia_ke_yi[126,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Suspicion of poisoning"))] )], dia_ke_yi$IMCI.code[126], sep=";")
}

dia_ke_yi[127,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major trauma"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Major trauma"))] )], dia_ke_yi$IMCI.code[127], sep=";")
}

dia_ke_yi[128,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Vit A Supplementation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Vit A Supplementation"))] )], dia_ke_yi$IMCI.code[128], sep=";")
}

dia_ke_yi[129,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Incomplete vaccination"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Incomplete vaccination"))] )], dia_ke_yi$IMCI.code[129], sep=";")
}

dia_ke_yi[130,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Deworming"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Deworming"))] )], dia_ke_yi$IMCI.code[130], sep=";")
}

dia_ke_yi[131,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known sickle cell disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known sickle cell disease"))] )], dia_ke_yi$IMCI.code[131], sep=";")
}

dia_ke_yi[132,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cerebral palsy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cerebral palsy"))] )], dia_ke_yi$IMCI.code[132], sep=";")
}


dia_ke_yi[133,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Congenital heart disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Congenital heart disease"))] )], dia_ke_yi$IMCI.code[133], sep=";")
}

dia_ke_yi[134,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Nyingine"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Nyingine"))] )], dia_ke_yi$IMCI.code[134], sep=";")
}


dia_ke_yi[135,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever without source presumed bacterial infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever without source presumed bacterial infection"))] )], dia_ke_yi$IMCI.code[135], sep=";")
}


```

```{r IMCI DIAGNOSIS CODING YI SENEGAL}

#derive a variable that code IMCI diagnosis 
#as a child can have more than one diagnosis, it needs to allow appending multiple ones

#Possible Serious Bacterial Infection or Very Severe Disease
dia_se_yi[1,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  (d0$temp_meas>37.5 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | (d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))] | (d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))] & d0$temp_meas>37.5) |
(dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsions","Lthargie","Hypotonie","Apnes","Infection nonatale","Mningite nonatale",
                                                                                        "Asphyxie prinatale","Hypothermie","Ttanos nonatal","Staphylococcie maligne de la face",
                                                                                        "Ttanos","Sepsis","Septicmie","Choc septique","Coma","Convulsions","Epilepsie",
                                                                                        "Etat de mal convulsif","Mningoencphalite virale","Mningite bactrienne",
                                                                                        "Mningite bactrienne dcapite","Mningite virale"))] |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie","Pneumonie chimique","Pleursie","Pleuropneumonie","Bronchopneumonie","Pneumocystose","Staphylococcie pulmonaire"))] & d0$who_age_ctg=="[1-6d]") |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie nonatale"))] & d0$who_age_ctg=="[1-6d]") |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre","Fivre","Fivre typhode","Fivre au long cours","Fivre jaune","Ictre fbrile"))] & d0$temp_meas>37.5) ) ) ))]  <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  (d0$temp_meas>37.5 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | (d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))] | (d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))] & d0$temp_meas>37.5) |
(dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsions","Lthargie","Hypotonie","Apnes","Infection nonatale","Mningite nonatale",
                                                                                        "Asphyxie prinatale","Hypothermie","Ttanos nonatal","Staphylococcie maligne de la face",
                                                                                        "Ttanos","Sepsis","Septicmie","Choc septique","Coma","Convulsions","Epilepsie",
                                                                                        "Etat de mal convulsif","Mningoencphalite virale","Mningite bactrienne",
                                                                                        "Mningite bactrienne dcapite","Mningite virale"))] |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie","Pneumonie chimique","Pleursie","Pleuropneumonie","Bronchopneumonie","Pneumocystose","Staphylococcie pulmonaire"))] & d0$who_age_ctg=="[1-6d]") |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie nonatale"))] & d0$who_age_ctg=="[1-6d]") |
                  (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre","Fivre","Fivre typhode","Fivre au long cours","Fivre jaune","Ictre fbrile"))] & d0$temp_meas>37.5) ) ) ))] , dia_se_yi$IMCI.code[1], sep=";")
  
  }
}

#Pneumonia
dia_se_yi[2,2:3]
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  (d0$dx_oth_yn==1 & ((d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie nonatale"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie", "Pneumonie chimique", "Pleuropneumonie","Bronchopneumonie","Pneumocystose","Staphylococcie pulmonaire"))] & d0$who_age_ctg=="[1-6d]")) )  )] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  (d0$dx_oth_yn==1 & ((d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie nonatale"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pneumonie", "Pneumonie chimique", "Pleuropneumonie","Bronchopneumonie","Pneumocystose","Staphylococcie pulmonaire"))] & d0$who_age_ctg=="[1-6d]")) )  )], dia_se_yi$IMCI.code[2], sep=";")
}


#Local Infection
dia_se_yi[3,2:3] #not specified
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Epidermolyse bulleuse congnitale", "Omphalite", "Pustulose cutane"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Epidermolyse bulleuse congnitale", "Omphalite", "Pustulose cutane"))])], dia_se_yi$IMCI.code[3], sep=";")
}


#HIV Confirmed
dia_se_yi[4,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection  VIH", "SIDA"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("VIH / SIDA"))]) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection  VIH", "SIDA"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("VIH / SIDA"))]) ) ], dia_se_yi$IMCI.code[4], sep=";")
}
}

#HIV Exposed
dia_se_yi[5,2:3] #not specified


#HIV Infection Status Unknown 
dia_se_yi[6,2:3] #not specified


#HIV Infection Unlikely 
dia_se_yi[7,2:3] #not specified


#Jaundice
dia_se_yi[8,2:3] 
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal", "Jaunisse", "Ictre fbrile"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") )] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal", "Jaunisse", "Ictre fbrile"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") )], dia_se_yi$IMCI.code[8], sep=";")
}


#Severe Jaundice
dia_se_yi[9,2:3] 
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & ((d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal", "Jaunisse", "Ictre fbrile"))] & d0$who_age_ctg=="[1-6d]") | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nuclaire"))] ))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &d0$dx_oth_yn==1 & ((d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal", "Jaunisse", "Ictre fbrile"))] & d0$who_age_ctg=="[1-6d]") | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nuclaire"))] ))], dia_se_yi$IMCI.code[9], sep=";")
}



#Very low weight for age
dia_se_yi[10,2:3] #not specified

#Low weight for age or feeding problem
dia_se_yi[11,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Candisose buccale"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Candisose buccale"))])], dia_se_yi$IMCI.code[11], sep=";")
}


#Infection unlikely
dia_se_yi[12,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux-rhume","Bronchite","Asthme","Angine","Pharyngite","Rhinopharyngite","Amygdalite","Phlegmon amygdalien","Sinusite","Rhinite"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux / rhume /IVRS", "Asthme"))]) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux-rhume","Bronchite","Asthme","Angine","Pharyngite","Rhinopharyngite","Amygdalite","Phlegmon amygdalien","Sinusite","Rhinite"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux / rhume /IVRS", "Asthme"))]) ) ], dia_se_yi$IMCI.code[12], sep=";")
}
}


#Severe Dehydration
dia_se_yi[13,2:3] 
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2))] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2))], dia_se_yi$IMCI.code[13], sep=";")


#Some Dehydration
dia_se_yi[14,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4))] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4))], dia_se_yi$IMCI.code[14], sep=";")


#No Dehydration
dia_se_yi[15,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & ( (d0$dx_dehydration==1 & d0$dx_dehydration_severity==5) | d0$dx_dehydration==0))] <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_diarrhoea==1 & ( (d0$dx_dehydration==1 & d0$dx_dehydration_severity==5) | d0$dx_dehydration==0))], dia_se_yi$IMCI.code[15], sep=";")


#Other
dia_se_yi[16,2:3] 
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) )], dia_se_yi$IMCI.code[16], sep=";")
    
dia_se_yi[17,2:3] 
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5,98) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5,98) )], dia_se_yi$IMCI.code[17], sep=";")
    
dia_se_yi[18,2:3] 
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_ear_infection==1) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_ear_infection==1)], dia_se_yi$IMCI.code[18], sep=";")
    
dia_se_yi[19,2:3] 
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) )], dia_se_yi$IMCI.code[19], sep=";")
    
dia_se_yi[20,2:3] 
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5,98) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5,98) )], dia_se_yi$IMCI.code[20], sep=";")


dia_se_yi[21,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bronchiolite","Respiration sifflante / sifflements"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bronchiolite","Respiration sifflante / sifflements"))] ) ], dia_se_yi$IMCI.code[21], sep=";")
}


dia_se_yi[22,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose (TB)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose (TB)"))] )], dia_se_yi$IMCI.code[22], sep=";")
}


dia_se_yi[23,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))] )], dia_se_yi$IMCI.code[23], sep=";")
}

dia_se_yi[24,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mastodite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mastodite"))] )], dia_se_yi$IMCI.code[24], sep=";")
}

dia_se_yi[25,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Insuffisance pondrale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Insuffisance pondrale"))] )], dia_se_yi$IMCI.code[25], sep=";")
}

dia_se_yi[26,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Sclrme"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Sclrme"))] )], dia_se_yi$IMCI.code[26], sep=";")
}

dia_se_yi[27,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection materno-foetale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection materno-foetale"))] )], dia_se_yi$IMCI.code[27], sep=";")
}

dia_se_yi[28,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Inhalation mconiale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Inhalation mconiale"))] )], dia_se_yi$IMCI.code[28], sep=";")
}


dia_se_yi[29,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Empyme crbral"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Empyme crbral"))] )], dia_se_yi$IMCI.code[29], sep=";")
}

dia_se_yi[30,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs crbral"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs crbral"))] )], dia_se_yi$IMCI.code[30], sep=";")
}


dia_se_yi[31,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire"))] )], dia_se_yi$IMCI.code[31], sep=";")
}


dia_se_yi[32,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pylonphrite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pylonphrite"))] )], dia_se_yi$IMCI.code[32], sep=";")
}

dia_se_yi[33,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cystite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cystite"))] )], dia_se_yi$IMCI.code[33], sep=";")
}

dia_se_yi[34,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hmaturie"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hmaturie"))] )], dia_se_yi$IMCI.code[34], sep=";")
}

dia_se_yi[35,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Uropathie obstructive"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Uropathie obstructive"))] )], dia_se_yi$IMCI.code[35], sep=";")
}

dia_se_yi[36,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Epididymite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Epididymite"))] )], dia_se_yi$IMCI.code[36], sep=";")
}

dia_se_yi[37,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Urtrite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Urtrite"))] )], dia_se_yi$IMCI.code[37], sep=";")
}

dia_se_yi[38,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ostomylite aigu"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ostomylite aigu"))] )], dia_se_yi$IMCI.code[38], sep=";")
}

dia_se_yi[39,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cellulite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cellulite"))] )], dia_se_yi$IMCI.code[39], sep=";")
}

dia_se_yi[40,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fasciite ncrosante"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fasciite ncrosante"))] )], dia_se_yi$IMCI.code[40], sep=";")
}

dia_se_yi[41,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mal de Pott"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mal de Pott"))] )], dia_se_yi$IMCI.code[41], sep=";")
}


dia_se_yi[42,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Brlures"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Brlures"))] )], dia_se_yi$IMCI.code[42], sep=";")
}


dia_se_yi[43,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire"))] )], dia_se_yi$IMCI.code[43], sep=";")
}


dia_se_yi[44,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose ganglionnaire"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose ganglionnaire"))] )], dia_se_yi$IMCI.code[44], sep=";")
}

dia_se_yi[45,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Staphylococcie maligne de la face"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Staphylococcie maligne de la face"))] )], dia_se_yi$IMCI.code[45], sep=";")
}

dia_se_yi[46,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Lpre"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Lpre"))] )], dia_se_yi$IMCI.code[46], sep=";")
}


dia_se_yi[47,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Trachome"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Trachome"))] )], dia_se_yi$IMCI.code[47], sep=";")
}


dia_se_yi[48,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Endocardite d'Osler"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Endocardite d'Osler"))] )], dia_se_yi$IMCI.code[48], sep=";")
}


dia_se_yi[49,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pricardite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pricardite"))] )], dia_se_yi$IMCI.code[49], sep=";")
}

dia_se_yi[50,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abdomen aigu chirurgical"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abdomen aigu chirurgical"))] )], dia_se_yi$IMCI.code[50], sep=";")
}

dia_se_yi[51,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cholra"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cholra"))] )], dia_se_yi$IMCI.code[51], sep=";")
}

dia_se_yi[52,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pritonite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pritonite"))] )], dia_se_yi$IMCI.code[52], sep=";")
}


dia_se_yi[53,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Rectorragie"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Rectorragie"))] )], dia_se_yi$IMCI.code[53], sep=";")
}


dia_se_yi[54,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Amibiase intestinale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Amibiase intestinale"))] )], dia_se_yi$IMCI.code[54], sep=";")
}

dia_se_yi[55,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Chore de Sydenham"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Chore de Sydenham"))] )], dia_se_yi$IMCI.code[55], sep=";")
}

dia_se_yi[56,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Malformation ano-rectale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Malformation ano-rectale"))] )], dia_se_yi$IMCI.code[56], sep=";")
}

dia_se_yi[57,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))] )], dia_se_yi$IMCI.code[57], sep=";")
}

dia_se_yi[58,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Asphyxie prinatale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Asphyxie prinatale"))] )], dia_se_yi$IMCI.code[58], sep=";")
}

dia_se_yi[59,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Occlusion nonatale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Occlusion nonatale"))] )], dia_se_yi$IMCI.code[59], sep=";")
}

dia_se_yi[60,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Coqueluche"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Coqueluche"))] )], dia_se_yi$IMCI.code[60], sep=";")
}

dia_se_yi[61,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose pulmonaire"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose pulmonaire"))] )], dia_se_yi$IMCI.code[61], sep=";")
}

dia_se_yi[62,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose pleurale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose pleurale"))] )], dia_se_yi$IMCI.code[62], sep=";")
}

dia_se_yi[63,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Phlegmon amygdalien"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Phlegmon amygdalien"))] )], dia_se_yi$IMCI.code[63], sep=";")
}

dia_se_yi[64,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs rtro-pharyng"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs rtro-pharyng"))] )], dia_se_yi$IMCI.code[64], sep=";")
}

dia_se_yi[65,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs parapharyng"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abcs parapharyng"))] )], dia_se_yi$IMCI.code[65], sep=";")
}

dia_se_yi[66,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ethmoidte"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ethmoidte"))] )], dia_se_yi$IMCI.code[66], sep=";")
}

dia_se_yi[67,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Otite moyenne aigue"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Otite moyenne aigue"))] )], dia_se_yi$IMCI.code[67], sep=";")
}

dia_se_yi[68,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Otite chronique"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Otite chronique"))] )], dia_se_yi$IMCI.code[68], sep=";")
}

dia_se_yi[69,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Adnophlgmon"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Adnophlgmon"))] )], dia_se_yi$IMCI.code[69], sep=";")
}

dia_se_yi[70,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite"))] )], dia_se_yi$IMCI.code[70], sep=";")
}

dia_se_yi[71,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Atrsie intestinale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Atrsie intestinale"))] )], dia_se_yi$IMCI.code[71], sep=";")
}

dia_se_yi[72,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Atrsie duodnale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Atrsie duodnale"))] )], dia_se_yi$IMCI.code[72], sep=";")
}

dia_se_yi[73,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Maladie de Hirshsprung"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Maladie de Hirshsprung"))] )], dia_se_yi$IMCI.code[73], sep=";")
}

dia_se_yi[74,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Volvulus du grle"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Volvulus du grle"))] )], dia_se_yi$IMCI.code[74], sep=";")
}

dia_se_yi[75,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal"))] )], dia_se_yi$IMCI.code[75], sep=";")
}

dia_se_yi[76,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Entrocolite ulcro-ncrosante"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Entrocolite ulcro-ncrosante"))] )], dia_se_yi$IMCI.code[76], sep=";")
}


dia_se_yi[77,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale"))] )], dia_se_yi$IMCI.code[77], sep=";")
}

dia_se_yi[78,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ophtalmie du nouveau-n"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ophtalmie du nouveau-n"))] )], dia_se_yi$IMCI.code[78], sep=";")
}

dia_se_yi[79,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale","Dtresse neurologique","Maladie des membranes hyalines","Tachypne transitoire du nouveau-n"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale","Dtresse neurologique","Maladie des membranes hyalines","Tachypne transitoire du nouveau-n"))] )], dia_se_yi$IMCI.code[79], sep=";")
}

dia_se_yi[80,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Macrosomie foetale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Macrosomie foetale"))] )], dia_se_yi$IMCI.code[80], sep=";")
}


dia_se_yi[81,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hypothyrodie congnitale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hypothyrodie congnitale"))] )], dia_se_yi$IMCI.code[81], sep=";")
}


dia_se_yi[82,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Prmaturit", "Retard de croissance intra-utrin"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Prmaturit", "Retard de croissance intra-utrin"))] )], dia_se_yi$IMCI.code[82], sep=";")
}


dia_se_yi[83,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Postmaturit"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Postmaturit"))] )], dia_se_yi$IMCI.code[83], sep=";")
}

dia_se_yi[84,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite"))] )], dia_se_yi$IMCI.code[84], sep=";")
}

dia_se_yi[85,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Douleurs abdominales","Constipation","Vomissements","Vomissements" , "Gastroenterite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Douleurs abdominales","Constipation","Vomissements","Vomissements" , "Gastroenterite"))] )], dia_se_yi$IMCI.code[85], sep=";")
}


dia_se_yi[86,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hyperglycemie"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hyperglycemie"))] )], dia_se_yi$IMCI.code[86], sep=";")
}

dia_se_yi[87,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fracture de membre"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fracture de membre"))] )], dia_se_yi$IMCI.code[87], sep=";")
}

dia_se_yi[88,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal"))] )], dia_se_yi$IMCI.code[88], sep=";")
}

dia_se_yi[89,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjunctivite neonatal"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjunctivite neonatal"))] )], dia_se_yi$IMCI.code[89], sep=";")
}

dia_se_yi[90,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bosse sro-sanguine"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bosse sro-sanguine"))] )], dia_se_yi$IMCI.code[90], sep=";")
}


dia_se_yi[91,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Intoxication au monoxyde de carbone"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Intoxication au monoxyde de carbone"))] )], dia_se_yi$IMCI.code[91], sep=";")
}

dia_se_yi[92,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hernie umbilicale"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hernie umbilicale"))] )], dia_se_yi$IMCI.code[92], sep=";")
}

dia_se_yi[93,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Helminthiases"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Helminthiases"))] )], dia_se_yi$IMCI.code[93], sep=";")
}

dia_se_yi[94,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite"))] )], dia_se_yi$IMCI.code[94], sep=";")
}

dia_se_yi[95,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Erysiple"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Erysiple"))] )], dia_se_yi$IMCI.code[95], sep=";")
}


```

```{r IMCI DIAGNOSIS CODING OLDER CHILDREN KENYA}

#Any severe disease
dia_ke_ch[1,2:3]
d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 &  d0$dx_severe==1)] <- dia_ke_ch$IMCI.code[1]

#Hypoxaemia
dia_ke_ch[2,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")])], dia_ke_ch$IMCI.code[2], sep=";")
}

#Very severe disease
dia_ke_ch[3,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very severe disease", "CNS Danger sign"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsions"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very severe disease", "CNS Danger sign"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsions"))]))], dia_ke_ch$IMCI.code[3], sep=";")
}
}

#Severe pneumonia / very severe disease
dia_ke_ch[4,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(1,2) | (d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3 | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")]))) | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Severe pneumonia / very severe disease")]))]  <- paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(1,2) | (d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3 | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")]))) | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Severe pneumonia / very severe disease")]))], dia_ke_ch$IMCI.code[4], sep=";")
}

#Pneumonia 
dia_ke_ch[5,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(3,4,5) | (d0$dx_pneumonia_severity==98 & d0[,paste("dx", i, sep="_")]!=d0_cb_ke$value[which(d0_cb_ke$category=="Severe pneumonia / very severe disease")])) | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="IMCI/IMAI Pneumonia")]))]  <- paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(3,4,5) | (d0$dx_pneumonia_severity==98 & d0[,paste("dx", i, sep="_")]!=d0_cb_ke$value[which(d0_cb_ke$category=="Severe pneumonia / very severe disease")])) | d0[,paste("dx", i, sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="IMCI/IMAI Pneumonia")]))], dia_ke_ch$IMCI.code[5], sep=";")
}


#Cough / cold
dia_ke_ch[6,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough", "Common cold"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough / cold / URTI"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough", "Common cold"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Cough / cold / URTI"))]))], dia_ke_ch$IMCI.code[6], sep=";")
}
}


#Other respiratory
dia_ke_ch[7,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Asthma", "Bronchiolitis", "Wheeze / wheezing"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Asthma", "Bronchiolitis", "Wheeze / wheezing"))]) )], dia_ke_ch$IMCI.code[7], sep=";")
}

}


#Severe dehydration
dia_ke_ch[8,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) |   d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & d0$dx_dehydration_severity%in%c(1,2)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Dehydration"))]))] <-  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) |   d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & d0$dx_dehydration_severity%in%c(1,2)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Dehydration"))]))], dia_ke_ch$IMCI.code[8], sep=";")
}



#Some dehydration
dia_ke_ch[9,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & d0$dx_dehydration_severity%in%c(3,4,5)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Some Dehydration"))]))] <-  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) |   d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & d0$dx_dehydration_severity%in%c(3,4,5)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Some Dehydration"))]))], dia_ke_ch$IMCI.code[9], sep=";")
}


#No dehydration
dia_ke_ch[10,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) |   d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & (d0$dx_dehydration==0 | d0$dx_dehydration_severity==0)))] <-  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) |   d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & (d0$dx_dehydration==0 | d0$dx_dehydration_severity==0)))], dia_ke_ch$IMCI.code[10], sep=";")
}


#Severe persistent diarrhoea
dia_ke_ch[11,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & (grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe persistent diarrhoea"))]))] <-  paste(  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & (grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe persistent diarrhoea"))]))], dia_ke_ch$IMCI.code[11], sep=";")
}


#Persistent diarrhoea
dia_ke_ch[12,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==T) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Persistent diarrhea"))]))] <-  paste( d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==T) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Persistent diarrhea"))]))], dia_ke_ch$IMCI.code[12], sep=";")
}


#Dysentery
dia_ke_ch[13,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dysentery"))]))], dia_ke_ch$IMCI.code[13], sep=";")
}
}


#Diarrhoea, dehydration unspecified
dia_ke_ch[14,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Acute diarrhea","Diarrhoea"))]) & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )], dia_ke_ch$IMCI.code[14], sep=";")
}

#Other gastrointestinal
dia_ke_ch[15,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))])], dia_ke_ch$IMCI.code[15], sep=";")
}

#Genitourinary
dia_ke_ch[16,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Febrile urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Febrile urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))])], dia_ke_ch$IMCI.code[16], sep=";")
}

#Very severe febrile disease or severe malaria
dia_ke_ch[17,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_malaria_severity%in%c(1,2) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))])  | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))]) & (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsions"))] | d0$dx_severe==1 | d0$hypox_country==3 | d0[,paste("dx", i,sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")]))))] <- 
  paste(  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & ((d0$dx_malaria_severity%in%c(1,2) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))])  | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))]) & (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Convulsions"))] | d0$dx_severe==1 | d0$hypox_country==3 | d0[,paste("dx", i,sep="_")]==d0_cb_ke$value[which(d0_cb_ke$category=="Hypoxaemia")]))))], dia_ke_ch$IMCI.code[17], sep=";")
  }
}


#malaria
dia_ke_ch[18,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated malaria", "Suspected malaria"))] | d0$malaria_res==2))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated malaria", "Suspected malaria"))] | d0$malaria_res==2))], dia_ke_ch$IMCI.code[18], sep=";")
}


#Fever / Fever (no malaria)
dia_ke_ch[19,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever"))] | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion"))]))] , dia_ke_ch$IMCI.code[19], sep=";")
  }
}

#Prolonged fever
dia_ke_ch[20,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated prolonged fever", "Prolonged Fever"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated prolonged fever", "Prolonged Fever"))])], dia_ke_ch$IMCI.code[20], sep=";")
}

#Severe complicated measles
dia_ke_ch[21,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe complicated measles"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe complicated measles"))])], dia_ke_ch$IMCI.code[21], sep=";")
}

#Measles with eye or mouth complications
dia_ke_ch[22,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Measles with eye or mouth complications"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Measles with eye or mouth complications"))])], dia_ke_ch$IMCI.code[22], sep=";")
}

#Measles / suspected measles
dia_ke_ch[23,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-severe measles"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Non-severe measles"))])], dia_ke_ch$IMCI.code[23], sep=";")
}


#Mastoiditis
dia_ke_ch[24,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mastoiditis"))]))], dia_ke_ch$IMCI.code[24], sep=";")
  }
}

#Acute ear infection
dia_ke_ch[25,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==2 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==2 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))]))], dia_ke_ch$IMCI.code[25], sep=";")
}

#Chronic ear infection
dia_ke_ch[26,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))]))], dia_ke_ch$IMCI.code[26], sep=";")
}

#No ear infection
dia_ke_ch[27,2:3]  #not coded


#Other ENT
dia_ke_ch[28,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))]))], dia_ke_ch$IMCI.code[28], sep=";")
}

#Complicated severe acute malnutrition
dia_ke_ch[29,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==2 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated severe acute malnutrition"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==2 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated severe acute malnutrition"))]))], dia_ke_ch$IMCI.code[29], sep=";")
}

#Uncomplicated severe acute malnutrition
dia_ke_ch[30,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Severe acute malnutrition"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Uncomplicated Severe acute malnutrition"))])], dia_ke_ch$IMCI.code[30], sep=";")
}


#Severe acute malnutrition
dia_ke_ch[31,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Complicated severe acute malnutrition")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Uncomplicated severe acute malnutrition")], d0$IMCI_der)==F & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Complicated severe acute malnutrition")], d0$IMCI_der)==F & grepl(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Uncomplicated severe acute malnutrition")], d0$IMCI_der)==F & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))], dia_ke_ch$IMCI.code[31], sep=";")
}


#Moderate acute malnutrition
dia_ke_ch[32,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate malnutrition"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Moderate malnutrition"))]))], dia_ke_ch$IMCI.code[32], sep=";")
}


#No acute malnutrition
dia_ke_ch[33,2:3]
d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)], dia_ke_ch$IMCI.code[33], sep=";")


#Malnutrition / low WFA unspecified
dia_ke_ch[34,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Low weight"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Very low weight for age"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Low weight"))]))], dia_ke_ch$IMCI.code[34], sep=";")
}
}

#Severe anaemia
dia_ke_ch[35,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(1,2) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe anemia"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(1,2) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe anemia"))]))], dia_ke_ch$IMCI.code[35], sep=";")
}

#Anaemia
dia_ke_ch[36,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild/Moderate anemia"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Mild/Moderate anemia"))]))], dia_ke_ch$IMCI.code[36], sep=";")
}

#No anaemia
dia_ke_ch[37,2:3]
d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)] <- 
paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)], dia_ke_ch$IMCI.code[37], sep=";")

#Confirmed HIV
dia_ke_ch[38,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$hiv==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known HIV"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$hiv==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Known HIV"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("HIV"))]))], dia_ke_ch$IMCI.code[38], sep=";")
}
}


#HIV exposed
dia_ke_ch[39,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$hiv_res==2 | d0$mother_hiv==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Possible HIV"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$hiv_res==2 | d0$mother_hiv==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Possible HIV"))]))], dia_ke_ch$IMCI.code[39], sep=";")
}


#HIV infection unlikely
dia_ke_ch[40,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Negative HIV test"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Negative HIV test"))])], dia_ke_ch$IMCI.code[40], sep=";")
}


#TB / suspicion of TB
dia_ke_ch[41,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | d0$tb_ppx==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of Tuberculosis"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tuberculosis (TB)"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | d0$tb_ppx==1 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Suspicion of Tuberculosis"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Tuberculosis (TB)"))]))], dia_ke_ch$IMCI.code[41], sep=";")
}
}


#Eye
dia_ke_ch[42,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))])], dia_ke_ch$IMCI.code[42], sep=";")
}

#Skin (non-measles)
dia_ke_ch[43,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))])], dia_ke_ch$IMCI.code[43], sep=";")
}


#Accidents / Trauma / MSK
dia_ke_ch[44,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limp or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limp or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))])], dia_ke_ch$IMCI.code[44], sep=";")
}


```

```{r IMCI DIAGNOSIS CODING OLDER CHILDREN SENEGAL}

#derive a variable that code IMCI diagnosis 
#as a child can have more than one diagnosis, it needs to allow appending multiple ones

##split multiple diagnosis or symptoms into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11) - already done above


#Any severe disease
dia_se_ch[1,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 &  d0$dx_severe==1)] <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 &  d0$dx_severe==1)], dia_ke_ch$IMCI.code[1], sep=";")

#Hypoxaemia
dia_se_ch[2,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 &  d0$hypox_country==3)] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 &  d0$hypox_country==3)], dia_se_ch$IMCI.code[2], sep=";")
}

#Very severe disease
dia_se_ch[3,2:3]
for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))])], dia_se_ch$IMCI.code[3], sep=";")
}

#Severe pneumonia / very severe disease
dia_se_ch[4,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_pneumonia_severity%in%c(1,2) | (d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3))))]  <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_pneumonia_severity%in%c(1,2) | (d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3))))], dia_se_ch$IMCI.code[4], sep=";")

#Pneumonia 
dia_se_ch[5,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(3,4,5) | (d0$dx_pneumonia_severity==98 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe pneumonia / very severe disease")], d0$IMCI_der)==F)) |  d0[,paste("dx", i, sep="_")]==cb_se$value[which(cb_se$category=="Bronchopneumonie")]))]  <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & ((d0$dx_pneumonia_severity%in%c(3,4,5) | (d0$dx_pneumonia_severity==98 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe pneumonia / very severe disease")], d0$IMCI_der)==F)) |  d0[,paste("dx", i, sep="_")]==cb_se$value[which(cb_se$category=="Bronchopneumonie")]))], dia_se_ch$IMCI.code[5], sep=";")
}


#Cough / cold
dia_se_ch[6,2:3]
for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux / rhume / IVRS"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Toux / rhume / IVRS"))])], dia_se_ch$IMCI.code[6], sep=";")
}


#Other respiratory
dia_se_ch[7,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale", "Pneumonie nonatale","Asphyxie prinatale","Bronchite"))] | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Asthme", "Bronchiolite", "Respiration sifflante / sifflements"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale", "Pneumonie nonatale","Asphyxie prinatale","Bronchite"))] | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Asthme", "Bronchiolite", "Respiration sifflante / sifflements"))]) )], dia_se_ch$IMCI.code[7], sep=";")
}
}


#Severe dehydration
dia_se_ch[8,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration_severity%in%c(1,2)))] <-  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration_severity%in%c(1,2)))], dia_se_ch$IMCI.code[8], sep=";")

#Some dehydration
dia_se_ch[9,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration_severity%in%c(3,4,5)))] <-  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration_severity%in%c(3,4,5)))], dia_se_ch$IMCI.code[9], sep=";")


#No dehydration
dia_se_ch[10,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & (d0$dx_dehydration==0 | d0$dx_dehydration_severity==0)))] <-  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & (d0$dx_dehydration==0 | d0$dx_dehydration_severity==0)))], dia_se_ch$IMCI.code[10], sep=";")


#Severe persistent diarrhoea
dia_se_ch[11,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea_duration==1 & (grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)))] <-  paste(  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea_duration==1 & (grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)))], dia_se_ch$IMCI.code[11], sep=";")


#Persistent diarrhoea
dia_se_ch[12,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea_duration==1 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F))] <-  paste( d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea_duration==1 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F))], dia_se_ch$IMCI.code[12], sep=";")


#Dysentery
dia_se_ch[13,2:3]
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dysenterie"))])], dia_se_ch$IMCI.code[13], sep=";")
}


#Diarrhoea, dehydration unspecified
dia_se_ch[14,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F &  grepl(dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )], dia_se_ch$IMCI.code[14], sep=";")


#Other gastrointestinal
dia_se_ch[15,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Vomissements","Ballonnement abdominal","Douleurs abdominales","Abdomen aigu chirurgical","Gastroentrite","Constipation","Rectorragie","Hernie inguinale","Hernie ombilicale","Epigastralgies","Helminthiases","Parasitose digestive"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Vomissements","Ballonnement abdominal","Douleurs abdominales","Abdomen aigu chirurgical","Gastroentrite","Constipation","Rectorragie","Hernie inguinale","Hernie ombilicale","Epigastralgies","Helminthiases","Parasitose digestive"))])], dia_se_ch$IMCI.code[15], sep=";")
}

#Genitourinary
dia_se_ch[16,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire" , "Cystite"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire" , "Cystite"))])], dia_se_ch$IMCI.code[16], sep=";")
}

#Very severe febrile disease or severe malaria
dia_se_ch[17,2:3]
for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(1,2)  | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))]) & ((d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))] | d0$dx_severe==1 | d0$hypox_country==3)))))] <- 
  paste(  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(1,2)  | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))]) & ((d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Convulsion"))] | d0$dx_severe==1 | d0$hypox_country==3)))))], dia_se_ch$IMCI.code[17], sep=";")
  }


#malaria
dia_se_ch[18,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) | d0$malaria_res==2))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) | d0$malaria_res==2))], dia_se_ch$IMCI.code[18], sep=";")


#Fever / Fever (no malaria)
dia_se_ch[19,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))] | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre fbrile"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))] | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre fbrile"))]))], dia_se_ch$IMCI.code[19], sep=";")
  }
}

#Prolonged fever
dia_se_ch[20,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre au long cours"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre au long cours"))])], dia_se_ch$IMCI.code[20], sep=";")
}

#Severe complicated measles
dia_se_ch[21,2:3] #not specified


#Measles with eye or mouth complications
dia_se_ch[22,2:3] #not specified


#Measles / suspected measles
dia_se_ch[23,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Rougeole"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Rougeole"))])], dia_se_ch$IMCI.code[23], sep=";")
}


#Mastoiditis
dia_se_ch[24,2:3]
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mastodite"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Mastodite"))])], dia_se_ch$IMCI.code[24], sep=";")
  }

#Acute ear infection
dia_se_ch[25,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_ear_infection_duration==2)] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_ear_infection_duration==2)], dia_se_ch$IMCI.code[25], sep=";")

#Chronic ear infection
dia_se_ch[26,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_ear_infection_duration==1)] <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_ear_infection_duration==1)], dia_se_ch$IMCI.code[26], sep=";")

#No ear infection
dia_se_ch[27,2:3]  #not coded


#Other ENT
dia_se_ch[28,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Angine","Pharyngite","Rhinopharyngite","Amygdalite","Rhinite","Carie dentaire","Candisose buccale","Oreillons"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Angine","Pharyngite","Rhinopharyngite","Amygdalite","Rhinite","Carie dentaire","Candisose buccale","Oreillons"))]))], dia_se_ch$IMCI.code[28], sep=";")
}

#Complicated severe acute malnutrition
dia_se_ch[29,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_malnutrition_severity==2)] <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_malnutrition_severity==2)], dia_se_ch$IMCI.code[29], sep=";")


#Uncomplicated severe acute malnutrition
dia_se_ch[30,2:3] #not coded


#Severe acute malnutrition
dia_se_ch[31,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity!=2 & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity!=2 & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))], dia_se_ch$IMCI.code[31], sep=";")


#Moderate acute malnutrition
dia_se_ch[32,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3")))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3")))], dia_se_ch$IMCI.code[32], sep=";")


#No acute malnutrition
dia_se_ch[33,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)], dia_se_ch$IMCI.code[33], sep=";")



#Other nutritional problem / malnutrition unspecified
dia_se_ch[34,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Retard de croissance","Retard pondral","Surpoids"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Insuffisance pondrale"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Retard de croissance","Retard pondral","Surpoids"))] |  d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Insuffisance pondrale"))]))], dia_se_ch$IMCI.code[34], sep=";")
}
}

#Severe anaemia
dia_se_ch[35,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_anaeamia_severity%in%c(1,2))] <- paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_anaeamia_severity%in%c(1,2))], dia_se_ch$IMCI.code[35], sep=";")


#Anaemia
dia_se_ch[36,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pleur"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pleur"))]))], dia_se_ch$IMCI.code[36], sep=";")
}

#No anaemia
dia_se_ch[37,2:3]
d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)], dia_se_ch$IMCI.code[37], sep=";")


#Sickle cell disease / trait
dia_se_ch[38,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Drpanocytose homozygote SS"))] | d0$scd%in%c(2,3)))] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Drpanocytose homozygote SS"))] | d0$scd%in%c(2,3)))], dia_se_ch$IMCI.code[38], sep=";")
}


#Confirmed HIV
dia_se_ch[39,2:3]
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("VIH / SIDA"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("VIH / SIDA"))])], dia_se_ch$IMCI.code[39], sep=";")
}



#HIV exposed
dia_se_ch[40,2:3] #not coded



#HIV infection unlikely
dia_se_ch[41,2:3] #not coded


#TB / suspicion of TB
dia_se_ch[42,2:3]
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose (TB)"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Tuberculose (TB)"))])], dia_se_ch$IMCI.code[42], sep=";")
}


#Eye
dia_se_ch[43,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale", "Conjonctivite"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale", "Conjonctivite"))])], dia_se_ch$IMCI.code[43], sep=";")
}

#Skin (non-measles)
dia_se_ch[44,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite","Cellulite","Syndrome pieds-main","Allergie mdicamenteuse","Toxidermie"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Pyodermite","Cellulite","Syndrome pieds-main","Allergie mdicamenteuse","Toxidermie"))])], dia_se_ch$IMCI.code[44], sep=";")
}


#Accidents / Trauma / MSK
dia_se_ch[45,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Myopathie","Fracture de membre","Intoxication aux organo-phosphors","Ingestion de Javel","Brlures","Ingestion de ptrole","Intoxication aux hydrocarbures","Accident de la voie publique","Intoxication au monoxyde de carbone"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Myopathie","Fracture de membre","Intoxication aux organo-phosphors","Ingestion de Javel","Brlures","Ingestion de ptrole","Intoxication aux hydrocarbures","Accident de la voie publique","Intoxication au monoxyde de carbone"))])], dia_se_ch$IMCI.code[45], sep=";")
}

#Other
dia_se_ch[46,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre nonatal"))])], dia_se_ch$IMCI.code[46], sep=";")
}

dia_se_ch[47,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Jaunisse"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Jaunisse"))])], dia_se_ch$IMCI.code[47], sep=";")
}

dia_se_ch[48,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection nonatale"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection nonatale"))])], dia_se_ch$IMCI.code[48], sep=";")
}


dia_se_ch[49,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Traumatisme obsttrical"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Traumatisme obsttrical"))])], dia_se_ch$IMCI.code[49], sep=";")
}

dia_se_ch[50,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hypoglycmie"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hypoglycmie"))])], dia_se_ch$IMCI.code[50], sep=";")
}

dia_se_ch[51,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bosse sro-sanguine"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Bosse sro-sanguine"))])], dia_se_ch$IMCI.code[51], sep=";")
}

dia_se_ch[52,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Collapsus"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Collapsus"))])], dia_se_ch$IMCI.code[52], sep=";")
}

dia_se_ch[53,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hyperglycmie"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Hyperglycmie"))])], dia_se_ch$IMCI.code[53], sep=";")
}


```

```{r ADJUST FORMATTING}

#delete duplicated codes that could have been appended with for loops above
d0$IMCI_der <- sapply(strsplit(d0$IMCI_der, ";"), function(x) paste(rle(x)$values,collapse=";"))

#remove ";" if string start
d0$IMCI_der[which(substr(d0$IMCI_der,1,1)==";")] <- substring(d0$IMCI_der[which(substr(d0$IMCI_der,1,1)==";")],first=2)

```

```{r SEVERITY AND ANTIBIO}

#flag severity 
d0$severe_diag <- 0
for(j in dia_ke_yi$IMCI.code[which(dia_ke_yi$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_ke_ch$IMCI.code[which(dia_ke_ch$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_se_yi$IMCI.code[which(dia_se_yi$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_se_ch$IMCI.code[which(dia_se_ch$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}

#flag antibiotic required
d0$antibio_req <- 0
for(j in dia_ke_yi$IMCI.code[which(dia_ke_yi$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_ke_ch$IMCI.code[which(dia_ke_ch$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_se_yi$IMCI.code[which(dia_se_yi$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_se_ch$IMCI.code[which(dia_se_ch$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}


########################
###code special cases
##Kenya young infants
sev_list_ke_yi <- dia_ke_yi[which((dia_ke_yi$Severe!="y" & dia_ke_yi$Severe!="n" & dia_ke_yi$Severe!="maybe") | (dia_ke_yi$Needs.systemic.abx!="y" & dia_ke_yi$Needs.systemic.abx!="n" & dia_ke_yi$Needs.systemic.abx!="maybe")), c(2,4,6,10)]

sev_list_ke_yi[1,] #not coded
sev_list_ke_yi[2,] #not coded
sev_list_ke_yi[3,] #not coded
sev_list_ke_yi[4,] 
  d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==1 & grepl(sev_list_ke_yi$IMCI.code[4],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_ke_yi[5,] 
  d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==1 & grepl(sev_list_ke_yi$IMCI.code[5],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_ke_yi[6,] 
  d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==1 & grepl(sev_list_ke_yi$IMCI.code[6],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_ke_yi[7,] #not coded
sev_list_ke_yi[8,] #not coded
sev_list_ke_yi[9,] 
  d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==1 & grepl(sev_list_ke_yi$IMCI.code[9],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_ke_yi[10,] 
  d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==1 & grepl(sev_list_ke_yi$IMCI.code[10],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1


##Senegal young infants
sev_list_se_yi <- dia_se_yi[which((dia_se_yi$Severe!="y" & dia_se_yi$Severe!="n" & dia_se_yi$Severe!="maybe") | (dia_se_yi$Needs.systemic.abx!="y" & dia_se_yi$Needs.systemic.abx!="n" & dia_se_yi$Needs.systemic.abx!="maybe")), c(2,4,6,10)]

sev_list_se_yi[1,] #not coded
sev_list_se_yi[2,] #not coded
sev_list_se_yi[3,] #not coded


##Kenya older children
sev_list_ke_ch <- dia_ke_ch[which((dia_ke_ch$Severe!="y" & dia_ke_ch$Severe!="n" & dia_ke_ch$Severe!="maybe") | (dia_ke_ch$Needs.systemic.abx!="y" & dia_ke_ch$Needs.systemic.abx!="n" & dia_ke_ch$Needs.systemic.abx!="maybe")), c(2,4,6,9)]

sev_list_ke_ch[1,]
for(i in 1:n1){
  d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))])] <- 1
}

sev_list_ke_ch[2,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition"))])] <- 1
    d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Severe Abdominal Condition"))])] <- 1
}

sev_list_ke_ch[3,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis", "Suspected Testicular Torsion"))])] <- 1
   d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Pyelonephritis", "Lower urinary tract infection"))])] <- 1
}

sev_list_ke_ch[4,]
for(i in 1:n1){
   d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Fever without source presumed bacterial infection"))])] <- 1
}

sev_list_ke_ch[5,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dental Abscess","Complicated Neck mass"))]))] <- 1
   d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Dental Abscess","Bacterial Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis"))]))] <- 1
}

sev_list_ke_ch[6,] #"maybe" assume as no 
sev_list_ke_ch[7,] #"maybe" assume as no 
sev_list_ke_ch[8,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_ke_ch[9,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic

sev_list_ke_ch[10,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Orbital Cellulitis","Severe Eye Disease","Corneal Abrasion"))])] <- 1
    d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Orbital Cellulitis","Preseptal Cellulitis"))])] <- 1
}

sev_list_ke_ch[11,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess","Complicated cellulitis","Complicated chicken pox","Anaphylaxis","Complicated Impetigo","Extensive folliculitis"))])] <- 1
    d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Complicated abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated Impetigo","Extensive folliculitis"))])] <- 1
}

sev_list_ke_ch[12,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Major head injury","Major Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Major trauma"))])] <- 1
    d0$antibio_req[which(d0$country=="ke" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_ke$value[which(d0_cb_ke$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound"))])] <- 1
}



##Senegal older children
sev_list_se_ch <- dia_se_ch[which((dia_se_ch$Severe!="y" & dia_se_ch$Severe!="n" & dia_se_ch$Severe!="maybe") | (dia_se_ch$Needs.systemic.abx!="y" & dia_se_ch$Needs.systemic.abx!="n" & dia_se_ch$Needs.systemic.abx!="maybe")), c(2,5,7,10)]

sev_list_se_ch[1,]
for(i in 1:n1){
  d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale", "Pneumonie nonatale"))])] <- 1
  d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Dtresse respiratoire nonatale", "Pneumonie nonatale"))])] <- 1
}

sev_list_se_ch[2,]
for(i in 1:n1){
    d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal","Abdomen aigu chirurgical"))])] <- 1
    d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Abdomen aigu chirurgical"))])] <- 1
}

sev_list_se_ch[3,]
for(i in 1:n1){
   d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Infection urinaire","Cystite"))])] <- 1
}

sev_list_se_ch[4,]
for(i in 1:n1){
   d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre fbrile"))])] <- 1
}

sev_list_se_ch[5,]
for(i in 1:n1){
  d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Angine","Pharyngite","Rhinopharyngite","Amygdalite"))]))] <- 1
}

sev_list_se_ch[6,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_se_ch[7,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_se_ch[8,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic

sev_list_se_ch[9,] 
for(i in 1:n1){
    d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale"))])] <- 1
    d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Conjonctivite nonatale"))])] <- 1
}

sev_list_se_ch[10,]
for(i in 1:n1){
    d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cellulite","Toxidermie"))])] <- 1
    d0$antibio_req[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cellulite"))])] <- 1
}

sev_list_se_ch[11,]
for(i in 1:n1){
    d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Myopathie","Fracture de membre","Intoxication aux organo-phosphors","Ingestion de Javel","Brlures","Ingestion de ptrole","Intoxication aux hydrocarbures","Accident de la voie publique","Intoxication au monoxyde de carbone"))])] <- 1
    
}


sev_list_se_ch[12,]
d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & grepl(sev_list_se_ch$IMCI.code[13],d0$IMCI_der)==T & d0$age_mo>=2)] <- 1

sev_list_se_ch[13,]
d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & grepl(sev_list_se_ch$IMCI.code[14],d0$IMCI_der)==T & d0$age_mo>=2)] <- 1

sev_list_se_ch[14,]
d0$severe_diag[which(d0$country=="se" & d0$yg_infant==0 & grepl(sev_list_se_ch$IMCI.code[15],d0$IMCI_der)==T & d0$age_mo>=2)] <- 1

sev_list_se_ch[15,] #no action required
sev_list_se_ch[16,] #no action required
sev_list_se_ch[17,] #maybe assume no
sev_list_se_ch[17,] #maybe assume no


#format
d0$severe_diag <- factor(d0$severe_diag)
d0$antibio_req <- factor(d0$antibio_req)


###Split severe diagnosis with and without hypoxaemia
d0$severe_diag2 <- NA
d0$severe_diag2[which(d0$severe_diag==0)] <- 0
d0$severe_diag2[which(d0$severe_diag==1 & d0$hypox_country!=3)] <- 1
d0$severe_diag2[which(d0$severe_diag==1 & d0$hypox_country==3)] <- 2
d0$severe_diag2 <- set_labels(factor(d0$severe_diag2, levels=c(2,1,0)), labels=c("Yes, with severe hypoxaemia", "Yes, without severe hypoxaemia", "No"))

```

```{r FIRST LINE ANTIBIOTIC}

#flag single diagnosis
d0$single_diag <- NA
d0$single_diag[which(grepl(";", d0$IMCI_der)==T)] <- 0
d0$single_diag[which(grepl(";", d0$IMCI_der)==F & d0$IMCI_der!="")] <- 1


#initialize as zero diagnosis requiring a specific antibiotic
d0$antibio_first_line <- NA
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==1 & d0$single_diag==1 & d0$IMCI_der%in%dia_ke_yi$IMCI.code[which(!is.na(dia_ke_yi$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_ke_ch$IMCI.code[which(!is.na(dia_ke_ch$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==1 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_yi$IMCI.code[which(!is.na(dia_se_yi$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_ch$IMCI.code[which(!is.na(dia_se_ch$First.line.abx))])] <- 0 #all that have first line antibiotics

##initialize as zero diagnosis requiring a specific antibiotic
first_line_list_ke_yi <- table(dia_ke_yi$First.line.abx[which(!is.na(dia_ke_yi$First.line.abx))], dia_ke_yi$IMCI.code[which(!is.na(dia_ke_yi$First.line.abx))])
first_line_list_ke_ch <- table(dia_ke_ch$First.line.abx[which(!is.na(dia_ke_ch$First.line.abx))], dia_ke_ch$IMCI.code[which(!is.na(dia_ke_ch$First.line.abx))])
first_line_list_se_yi <- table(dia_se_yi$First.line.abx[which(!is.na(dia_se_yi$First.line.abx))], dia_se_yi$IMCI.code[which(!is.na(dia_se_yi$First.line.abx))])
first_line_list_se_ch <- table(dia_se_ch$First.line.abx[which(!is.na(dia_se_ch$First.line.abx))], dia_se_ch$IMCI.code[which(!is.na(dia_se_ch$First.line.abx))])


##format old structure into single flags for relevant antibiotics
d0$ampicillin_old <- NA
d0$amoxicillin_old <- NA
d0$benzathinepeni_old <- NA
d0$gentamicin_old <- NA
d0$ceftriaxone_old <- NA
d0$ciprofloxacin_old <- NA
d0$cotrimoxazole_old <- NA
d0$penicillinV_old <- NA


for(i in 1:d1){
  for(j in 1:d2){
d0$ampicillin_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Ampicillin", antibio_old[,1])][1] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Ampicillin", antibio_old[,1])][1])] <- 1
d0$amoxicillin_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Amoxicillin", antibio_old[,1])][1] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Amoxicillin", antibio_old[,1])][1])] <- 1
d0$benzathinepeni_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Benzylpeni", antibio_old[,1])] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Benzylpeni", antibio_old[,1])])] <- 1
d0$gentamicin_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Genta", antibio_old[,1])] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Genta", antibio_old[,1])])] <- 1
d0$ceftriaxone_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Ceftriaxone", antibio_old[,1])] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Ceftriaxone", antibio_old[,1])])] <- 1
d0$ciprofloxacin_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Ciprofloxacin", antibio_old[,1])] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Ciprofloxacin", antibio_old[,1])])] <- 1
d0$cotrimoxazole_old[which(d0[,paste("rx_misc", i, sep="_")]==antibio_old$num[grep("Co-trimoxazole", antibio_old[,1])] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$num[grep("Co-trimoxazole", antibio_old[,1])])] <- 1
d0$penicillinV_old[which((d0$country=="ke" & (d0[,paste("rx_misc", i, sep="_")]==antibio_old$Kenya.num[grep("Penicillin V", antibio_old$Kenya.other)] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$Kenya.num[grep("Penicillin V", antibio_old$Kenya.other)])) | (d0$country=="se" & (d0[,paste("rx_misc", i, sep="_")]==antibio_old$Senegal.num[grep("Penicillin V", antibio_old$Senegal.other)] | d0[,paste("rx_misc_hf", j, sep="_")]==antibio_old$Senegal.num[grep("Penicillin V", antibio_old$Senegal.other)])))] <- 1
  }
}



##
##Kenya young infants
first_line_list_ke_yi[1,];row.names(first_line_list_ke_yi)[1]  #ampi and genta or genta and amox or genta and penicillin
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_ke_yi[1,]!=0)==T) & (((d0$rx_ampicillin==1 | d0$rx_ampicillin_hf==1 | d0$ampicillin_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  ) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1 | d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1 | d0$benzathinepeni_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  ) | ((d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  )  ) )] <- 1

first_line_list_ke_yi[2,];row.names(first_line_list_ke_yi)[2]  #amoxicillin
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_ke_yi[1,]!=0)==T) & (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1))] <- 1

first_line_list_ke_yi[3,];row.names(first_line_list_ke_yi)[3]  #cotrimoxazole
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_ke_yi[1,]!=0)==T) & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 1


##
##Senegal young infants
first_line_list_se_yi[1,];row.names(first_line_list_se_yi)[1]  #ampi and genta or genta and amox or genta and penicillin or ceftriaxone
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_se_yi[1,]!=0)==T) & (((d0$rx_ampicillin==1 | d0$rx_ampicillin_hf==1 | d0$ampicillin_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  ) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1 | d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1 | d0$benzathinepeni_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  ) | ((d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1) & ((d0$rx_gentamicin==1 & d0$rx_gentamicin_route%in%c(2,98)) | (d0$rx_gentamicin_hf==1 & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98)))  ) | (d0$rx_ceftriaxone==1 | d0$rx_ceftriaxone_hf==1 | d0$ceftriaxone_old==1)   ) )] <- 1

first_line_list_se_yi[2,];row.names(first_line_list_se_yi)[2]  #amoxicillin
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_se_yi[1,]!=0)==T) & (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1))] <- 1

first_line_list_se_yi[3,];row.names(first_line_list_se_yi)[3]  #cotrimoxazole
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_se_yi[1,]!=0)==T) & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 1


##
##Kenya older children
first_line_list_ke_ch[1,];row.names(first_line_list_ke_ch)[1]  #re-set to no first line required
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[1,]!=0)==T))] <- NA

first_line_list_ke_ch[2,];row.names(first_line_list_ke_ch)[2]  #amoxicillin
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[2,]!=0)==T) & (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1))] <- 1

first_line_list_ke_ch[3,];row.names(first_line_list_ke_ch)[3]  #amoxicillin or bepen+gent
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[3,]!=0)==T) & ((((d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1) & d0$rx_gentamicin & d0$rx_gentamicin_route%in%c(2,98)) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1) & d0$rx_gentamicin_hf & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$benzathinepeni_old==1 & d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98))) | (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1)))] <- 1

first_line_list_ke_ch[4,];row.names(first_line_list_ke_ch)[4] #bepen+gent
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[4,]!=0)==T) & (((d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1) & d0$rx_gentamicin & d0$rx_gentamicin_route%in%c(2,98)) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1) & d0$rx_gentamicin_hf & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$benzathinepeni_old==1 & d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98))))] <- 1

first_line_list_ke_ch[5,];row.names(first_line_list_ke_ch)[5] #Ceftriaxone
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[5,]!=0)==T) & (d0$rx_ceftriaxone==1 | d0$rx_ceftriaxone_hf==1 | d0$ceftriaxone_old==1))] <- 1

first_line_list_ke_ch[6,];row.names(first_line_list_ke_ch)[6] #Ciprofloxacin
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[6,]!=0)==T) & ((d0$rx_ciprofloxacin==1 & d0$rx_ciprofloxacin_route%in%c(1,2)) | (d0$rx_ciprofloxacin_hf==1 & d0$rx_ciprofloxacin_route_hf%in%c(1,2)) | (d0$ciprofloxacin_old==1 & d0$rx_ciprofloxacin_route%in%c(1,2))))] <- 1

first_line_list_ke_ch[7,];row.names(first_line_list_ke_ch)[7] #re-set to no first line required
d0$antibio_first_line[which(d0$country=="ke" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_ke_ch[7,]!=0)==T))] <- NA


##
##Senegal older children
first_line_list_se_ch[1,];row.names(first_line_list_se_ch)[1]  #re-set to no first line required$
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[1,]!=0)==T))] <- NA

first_line_list_se_ch[2,];row.names(first_line_list_se_ch)[2]  #amoxicillin
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[2,]!=0)==T) & (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1))] <- 1

first_line_list_se_ch[3,];row.names(first_line_list_se_ch)[3]  #amoxicillin or bepen+gent
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[3,]!=0)==T) & ((((d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1) & d0$rx_gentamicin & d0$rx_gentamicin_route%in%c(2,98)) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1) & d0$rx_gentamicin_hf & d0$rx_gentamicin_route_hf%in%c(2,98)) | (d0$benzathinepeni_old==1 & d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98))) | (d0$rx_amoxicillin==1 | d0$rx_amoxicillin_hf==1 | d0$amoxicillin_old==1) ))] <- 1

first_line_list_se_ch[4,];row.names(first_line_list_se_ch)[4] #bepen+gent
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[4,]!=0)==T) & (((d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1) & d0$rx_gentamicin & d0$rx_gentamicin_route%in%c(2,98)) | ((d0$rx_benzathinepeniG_hf==1 | d0$rx_penicillinG_hf==1) & d0$rx_gentamicin_hf & d0$rx_gentamicin_route_hf%in%c(2,98))  | (d0$benzathinepeni_old==1 & d0$gentamicin_old & d0$rx_gentamicin_route%in%c(2,98))))] <- 1

first_line_list_se_ch[5,];row.names(first_line_list_se_ch)[5] #Ceftriaxone
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[5,]!=0)==T) & (d0$rx_ceftriaxone==1 | d0$rx_ceftriaxone_hf==1 | d0$ceftriaxone_old==1))] <- 1

first_line_list_se_ch[6,];row.names(first_line_list_se_ch)[6] #Ciprofloxacin
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[6,]!=0)==T) & ((d0$rx_ciprofloxacin==1 & d0$rx_ciprofloxacin_route%in%c(1,2)) | (d0$rx_ciprofloxacin_hf==1 & d0$rx_ciprofloxacin_route_hf%in%c(1,2)) | (d0$ciprofloxacin_old==1 & d0$rx_ciprofloxacin_route%in%c(1,2))))] <- 1

first_line_list_se_ch[7,];row.names(first_line_list_se_ch)[7] #re-set to no first line required
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[7,]!=0)==T))] <- NA

first_line_list_se_ch[8,];row.names(first_line_list_se_ch)[8] #re-set to no first line required
d0$antibio_first_line[which(d0$country=="se" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_se_ch[8,]!=0)==T))] <- NA

```

```{r ANTIBIOTIC APPROPRIATENESS}

#appropriate
d0$antibio_app <- NA
d0$antibio_app[which(d0$single_diag==1 & d0$antibio_req==1 & d0$antibio_flag==1)] <- 1
d0$antibio_app[which(d0$single_diag==1 & d0$antibio_req==1 & d0$antibio_flag==0)] <- 0
d0$antibio_app <- as.factor(d0$antibio_app)

#unappropriate
d0$antibio_unapp <- NA
d0$antibio_unapp[which(d0$single_diag==1 & d0$antibio_req==0 & d0$antibio_flag==1)] <- 1
d0$antibio_unapp[which(d0$single_diag==1 & d0$antibio_req==0 & d0$antibio_flag==0)] <- 0
d0$antibio_app <- as.factor(d0$antibio_app)

##adapt for special cases - Kenya
dia_ke_ch[grep("Yes*", dia_ke_ch$Needs.systemic.abx), c(2,6,7,9)]

#hiv
d0$antibio_app[which(d0$country=="ke" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_ke_ch$IMCI.code[grep("Yes*", dia_ke_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 1

d0$antibio_unapp[which(d0$country=="ke" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_ke_ch$IMCI.code[grep("Yes*", dia_ke_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 0

##adapt for special cases - Senegal
dia_se_ch[grep("Yes*", dia_se_ch$Needs.systemic.abx), c(2,7,8,10)]

#hiv
d0$antibio_app[which(d0$country=="se" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_ch$IMCI.code[grep("co-trimoxazole", dia_se_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 1

d0$antibio_unapp[which(d0$country=="se" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_ch$IMCI.code[grep("co-trimoxazole", dia_se_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & (d0$rx_cotrimoxazole==1 | d0$rx_cotrimoxazole_hf==1 | d0$cotrimoxazole_old==1))] <- 0

#sickel cells
 d0$antibio_app[which(d0$country=="se" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_ch$IMCI.code[grep("prophylactic penicillin V", dia_se_ch$Needs.systemic.abx)] & d0$scd==2 & d0$antibio_flag==1 & (d0$rx_antibio_oth==antibio_se$value[which(antibio_se$response=="Phnoxymthylpnicilline OU Ospen")] | d0$rx_antibio_oth_hf==antibio_se$value[which(antibio_se$response=="Phnoxymthylpnicilline OU Ospen")] | d0$penicillinV_old==1))] <- 1
 
 d0$antibio_unapp[which(d0$country=="se" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_se_ch$IMCI.code[grep("prophylactic penicillin V", dia_se_ch$Needs.systemic.abx)] & d0$scd==2 & d0$antibio_flag==1 & (d0$rx_antibio_oth==antibio_se$value[which(antibio_se$response=="Phnoxymthylpnicilline OU Ospen")] | d0$rx_antibio_oth_hf==antibio_se$value[which(antibio_se$response=="Phnoxymthylpnicilline OU Ospen")] | d0$penicillinV_old==1))] <- 0

```

```{r DEFINE PULSE OX INDICATION}

#all young infants, all older children in Kenya, children with cough/difficulty breathing or yellow/red IMCI in Senegal

##from IMCI
d0$pulse_ox_ind_imci <- 0
d0$pulse_ox_ind_imci[d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="ke")] <- 1
for(k in dia_se_ch$IMCI.code[which(dia_se_ch$Pulse.ox=="y")]){d0$pulse_ox_ind_imci[grepl(`k`, d0$IMCI_der)==T & d0$country=="se" & d0$yg_infant==0] <- 1}

###code special cases
pulseox_list_se <- dia_se_ch[which(dia_se_ch$Pulse.ox!="y" & dia_se_ch$Pulse.ox!="n"), c(2,4,10)]

#Hypoxaemia
pulseox_list_se[1,] #not coded

#Other gastrointestinal
pulseox_list_se[2,] 
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ballonnement abdominal", "Abdomen aigu chirurgical","Rectorragie"))])] <- 1
}

#Fever / Fever (no malaria)
pulseox_list_se[3,] 
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Ictre fbrile"))])] <- 1
}

#Other ENT
pulseox_list_se[4,] 
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Angine","Pharyngite","Rhinopharyngite","Amygdalite","Oreillons"))]))] <- 1
}

#Skin (non-measles)
pulseox_list_se[5,] 
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Cellulite"))])] <- 1
}

#Accidents / Trauma / MSK
pulseox_list_se[6,] 
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Brlures","Intoxication au monoxyde de carbone"))])] <- 1
}

#Other
pulseox_list_se[7,] 
for(i in 1:n1){
  for(j in 1:n2){
  d0$pulse_ox_ind_imci[which(d0$country=="se" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Jaunisse"))] & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%cb_se$value[which(cb_se$category%in%c("Fivre"))])  ))] <- 1
  }
}


##from caregiver
d0$pulse_ox_ind_cg <- 0
d0$pulse_ox_ind_cg[d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="ke")] <- 1
d0$pulse_ox_ind_cg[which(d0$country=="se" & d0$yg_infant==0 & (d0$sx_cough==1 | d0$sx_difficulty_breath==1))] <- 1

##Overall
d0$pulse_ox_ind <- 0
d0$pulse_ox_ind[which(d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="ke") | (d0$yg_infant==0 & d0$country=="se" & (d0$pulse_ox_ind_imci==1 | d0$pulse_ox_ind_cg==1)))] <- 1


```

```{r DERIVE ADDITIONAL VARIABLES FOR ANALYSIS}

#children who received referral advise on day 0 and are classified as not having severe disease
d0$ref_non_sev <- 0
d0$ref_non_sev[which(d0$severe_diag==0 & d0$urg_ref==1)] <- 1


#severe hypoxaemia with no other severe disease
d0$sev_hyp <- 0
d0$sev_hyp[which(d0$hypox_country==3 & (d0$severe_diag==0 | d0$IMCI_der%in%c(dia_ke_ch$IMCI.code[which(dia_ke_ch$IMNCI.diagnosis=="Hypoxaemia")], dia_se_ch$IMCI.code[which(dia_se_ch$IMNCI.diagnosis=="Hypoxaemia")], dia_ke_yi$IMCI.code[which(dia_ke_yi$IMNCI.diagnosis=="Hypoxaemia")], dia_se_yi$IMCI.code[which(dia_se_yi$IMNCI.diagnosis=="Hypoxaemia")]) ) )] <- 1
d0$sev_hyp <- factor(d0$sev_hyp)

##flag hypoxaemic children (country cut-off), referred, who received oxygen at hospital
d0$hypo_o2_ref <- 0
d0$hypo_o2_ref[which(d0$hypox_country==3 & d0$urg_ref==1 & d0$o2==1)] <- 1
d0$hypo_o2_ref <- factor(d0$hypo_o2_ref)


```



```{r SAVE DATASET AFTER MANIPULATION}

save(d0, d7, hos, scrn, country_list, file=file.path(paste(dir_gen_dat, "manipulated_data.RData", sep="/")))

```



