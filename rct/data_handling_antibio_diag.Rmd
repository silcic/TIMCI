
```{r, include=params$log}
###
# study name: TIMCI
# program name: data_handling_antibio_diag.Rmd  
# program purpose: program that performs some data manipulation and derives variables for antibiotics and diagnosis anaylsis
# author: Silvia Cicconi  
###
```


```{r LOAD ANTIBIOTICS AND DIAGNOSIS}

#load antibiotics
antibio_tz <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_tz)), "TIMCI Tanzania diagnoses abx_CH.xlsx", sep="/")), 2)
antibio_in <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_in)), "TIMCI India diagnoses abx_CH.xlsx", sep="/")), 2)

#extend "other" code
antibio_tz <- fill(antibio_tz, c("code"))
antibio_in <- fill(antibio_in, c("code"))

#ensure all y/n low cases in last columns
antibio_tz$Systemic.abx[which(antibio_tz$Systemic.abx=="Y" | antibio_tz$Systemic.abx=="N")] <- tolower(antibio_tz$Systemic.abx[which(antibio_tz$Systemic.abx=="Y" | antibio_tz$Systemic.abx=="N" )])
antibio_in$Systemic.abx[which(antibio_in$Systemic.abx=="Y" | antibio_in$Systemic.abx=="N")] <- tolower(antibio_in$Systemic.abx[which(antibio_in$Systemic.abx=="Y" | antibio_in$Systemic.abx=="N" )])


```


```{r ANTIMALARIAL PRESCRIPTION}

##flag antimalarials prescription (antimalarial flag from antibio_in for IN, rx_antimalarials in TZ)

##India
#select antimalarials 
list_antimal_in <- antibio_in$value[which(antibio_in$Column1=="antimalarial" & antibio_in$code=="rx_antimicrobials_antimalarials_hf")]

#split multiple questions
a1 <- max(lengths(regmatches(d0$rx_antimicrobials_antimalarials_hf, gregexpr(" ", d0$rx_antimicrobials_antimalarials_hf))))+1; a1 #max n
d0 <- separate(d0, rx_antimicrobials_antimalarials_hf, into = paste("rx_antimicrobials_antimalarials_hf", seq(1,a1,1), sep="_"), sep = " ", fill = "right", remove=F)


#generate antimalarials old flag
d0$antimal_flag <- 0
for(i in 1:a1){
  d0$antimal_flag[which(d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]%in%list_antimal_in & d0$country=="in")] <- 1
}


##Tanzania
#flag
d0$antimal_flag[which(!is.na(d0$rx_antimalarials) & d0$rx_antimalarials!=96 & d0$country=="tz")] <- 1

#format
d0$antimal_flag <- as.factor(d0$antimal_flag)

```

```{r ANTIBIOTICS PRESCRIPTION}

##check single-drug questions for antibiotics
names(d0)[which(substr(names(d0), 1, 2)=="rx")]

#select systemic antibiotics from "other" list (as defined with clinical team)
other_in_list <- antibio_in$value[which(antibio_in$Systemic.abx=="y" & antibio_in$code=="rx_antimicrobials_antimalarials_hf")]; other_in_list
other_tz_list <- antibio_tz$value[which(antibio_tz$Systemic.abx=="y" & antibio_tz$code=="rx_antibio_oth_hf")]; other_tz_list

#select systemic antibiotics from "misc" list (as defined with clinical team)
other_in_list2 <- antibio_in$value[which(antibio_in$Systemic.abx=="y" & antibio_in$code=="rx_misc_hf")]; other_in_list2
other_tz_list2 <- antibio_tz$value[which(antibio_tz$Systemic.abx=="y" & antibio_tz$code=="rx_misc")]; other_tz_list2

##generate flag for other antibiotics
##split multiple drugs into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11)
a2 <- max(lengths(regmatches(d0$rx_antibio_oth, gregexpr(" ", d0$rx_antibio_oth))))+1; a2 #max n
d0 <- separate(d0, rx_antibio_oth, into = paste("rx_antibio_oth", seq(1,a2,1), sep="_"), sep = " ", fill = "right", remove=F)

a3 <- max(lengths(regmatches(d0$rx_misc_hf, gregexpr(";", d0$rx_misc_hf))))+1; a3 #max n
d0 <- separate(d0, rx_misc_hf, into = paste("rx_misc_hf", seq(1,a3,1), sep="_"), sep = " ", fill = "right", remove=F)

a4 <- max(lengths(regmatches(d0$rx_misc, gregexpr(";", d0$rx_misc))))+1; a4 #max n
d0 <- separate(d0, rx_misc, into = paste("rx_misc", seq(1,a4,1), sep="_"), sep = " ", fill = "right", remove=F)


##India
d0$antibio_other <- 0
for(i in 1:a1){
  d0$antibio_other[which(d0$country=="in" & d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]%in%other_in_list)] <- 1
}
for(i in 1:a3){
  d0$antibio_other[which(d0$country=="in" & d0[,paste("rx_misc_hf", i, sep="_")]%in%other_in_list2)] <- 1
}

##Tanzania
for(i in 1:a2){
  d0$antibio_other[which(d0$country=="tz" & d0[,paste("rx_antibio_oth", i, sep="_")]%in%other_tz_list)] <- 1
}
for(i in 1:a4){
  d0$antibio_other[which(d0$country=="tz" & d0[,paste("rx_misc", i, sep="_")]%in%other_tz_list2)] <- 1
}




######################################
#flag antibiotics prescription
##India
names(d0_in)[which(substr(names(d0_in),1,2)=="rx")]
antibio_in[which(!antibio_in$code%in%c("rx_antimicrobials_antimalarials_hf","rx_misc_hf")), c("code", "value", "Systemic.abx", "Comment")]

d0$antibio_in <- 0
d0$antibio_in[which((d0$rx_amoxicillin_hf==1 | d0$rx_aclav_hf==1 | !is.na(d0$rx_ampicillin_spec_hf) |  d0$rx_azithromycin_hf==1 |  d0$rx_ceftriaxone_hf==1 |  (d0$rx_ciprofloxacin_hf==1 & d0$rx_ciprofloxacin_route_hf%in%c(1,2)) |  d0$rx_cotrimoxazole_hf==1 | d0$rx_metronidazol_hf==1) & d0$country=="in" )] <- 1 #single drugs
d0$antibio_in[which(d0$antibio_in==0 & d0$antibio_other==1 & d0$country=="in")] <- 1 #if no single drugs selected, other

##Tanzania
names(d0_tz)[which(substr(names(d0_tz),1,2)=="rx")]
antibio_tz[which(!antibio_tz$code%in%c("rx_antibio_oth_hf","rx_misc")), c("code", "value", "Systemic.abx", "Comment")]

d0$antibio_tz <- 0
d0$antibio_tz[which((d0$rx_amoxicillin==1 | d0$rx_aclav==1 | d0$rx_ampicillin==1 |  d0$rx_azithromycin==1 | d0$rx_penicillinG==1 | d0$rx_benzathinepeniG==1 |  d0$rx_ceftriaxone==1 |  (d0$rx_ciprofloxacin==1 & d0$rx_ciprofloxacin_route%in%c(1,2)) |  d0$rx_cotrimoxazole==1 |d0$rx_metronidazol==1  |  (d0$rx_gentamicin==1 & d0$rx_gentamicin_route==2) | (d0$rx_gentamicin==1 & d0$rx_gentamicin_route==98 & (d0$rx_amoxicillin==1 | d0$rx_benzathinepeniG==1 | d0$rx_penicillinG==1 | d0$rx_ampicillin==1)) |  d0$rx_azithromycin==1) & d0$country=="tz" )] <- 1 #single drugs
d0$antibio_tz[which(d0$antibio_tz==0 & d0$antibio_other==1 & d0$country=="tz")] <- 1 #if no single drugs selected, other

#flag if one of the two sources recorded antibiotic prescription
d0$antibio_flag <- 0
d0$antibio_flag[which(d0$antibio_in==1 | d0$antibio_tz==1)] <- 1
d0$antibio_flag <- as.factor(d0$antibio_flag)

###Antimicrobial flag
d0$antimicro_flag <- 0
d0$antimicro_flag[which(d0$antibio_flag==1 | d0$antimal_flag==1)] <- 1
d0$antimicro_flag <- as.factor(d0$antimicro_flag)


```

```{r LOAD DIAGNOSIS}

#load data
dia_in_yi <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_in)), "TIMCI India diagnoses abx_YI.xlsx", sep="/")), 1)
dia_in_ch <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_in)), "TIMCI India diagnoses abx_CH.xlsx", sep="/")), 1)

dia_tz_yi <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_tz)), "TIMCI Tanzania diagnoses abx_YI.xlsx", sep="/")), 1)
dia_tz_ch <- read.xlsx(file.path(paste(dirname(dirname(dir_dat_tz)), "TIMCI Tanzania diagnoses abx_CH.xlsx", sep="/")), 1)

#ensure all y/n low cases in last columns
for(i in 4:ncol(dia_in_yi)) dia_in_yi[which(dia_in_yi[,i]=="Y" | dia_in_yi[,i]=="N" | dia_in_yi[,i]=="Maybe"), i] <- tolower(dia_in_yi[which(dia_in_yi[,i]=="Y" | dia_in_yi[,i]=="N" | dia_in_yi[,i]=="Maybe"), i])
for(i in 4:ncol(dia_in_ch)) dia_in_ch[which(dia_in_ch[,i]=="Y" | dia_in_ch[,i]=="N" | dia_in_ch[,i]=="Maybe"), i] <- tolower(dia_in_ch[which(dia_in_ch[,i]=="Y" | dia_in_ch[,i]=="N"  | dia_in_ch[,i]=="Maybe"), i])

for(i in 4:ncol(dia_tz_yi)) dia_tz_yi[which(dia_tz_yi[,i]=="Y" | dia_tz_yi[,i]=="N" | dia_tz_yi[,i]=="Maybe"), i] <- tolower(dia_tz_yi[which(dia_tz_yi[,i]=="Y" | dia_tz_yi[,i]=="N" | dia_tz_yi[,i]=="Maybe"), i])
for(i in 4:ncol(dia_tz_ch)) dia_tz_ch[which(dia_tz_ch[,i]=="Y" | dia_tz_ch[,i]=="N" | dia_tz_ch[,i]=="Maybe"), i] <- tolower(dia_tz_ch[which(dia_tz_ch[,i]=="Y" | dia_tz_ch[,i]=="N" | dia_tz_ch[,i]=="Maybe"), i])

#add IMCI code variable (unique code ID)
dia_in_yi$IMCI.code <- c(paste(seq(10, (109), 1), "in_yi", sep=""), paste("in_yi", seq(10, ((nrow(dia_in_yi)-100)+9), 1), sep=""))
dia_in_ch$IMCI.code <- paste(seq(10, (nrow(dia_in_ch)+9), 1), "in_ch", sep="")

dia_tz_yi$IMCI.code <- c(paste(seq(10, (109), 1), "tz_yi", sep=""), paste("tz_yi", seq(10, ((nrow(dia_tz_yi)-100)+9), 1), sep=""))
dia_tz_ch$IMCI.code <- paste(seq(10, (nrow(dia_tz_ch)+9), 1), "tz_ch", sep="")

##split multiple diagnosis or symptoms into multiple variables to avoid mis-classification between one digit and two digits numbers (e.g. 1, 11)
n1 <- max(lengths(regmatches(d0$dx, gregexpr(";", d0$dx))))+1; n1 #max n
d0 <- separate(d0, dx, into = paste("dx", seq(1,n1,1), sep="_"), sep = ";", fill = "right", remove=F)

n2 <- max(lengths(regmatches(d0$dx_mlist, gregexpr(";", d0$dx_mlist))))+1; n2 #max n
d0 <- separate(d0, dx_mlist, into = paste("dx_mlist", seq(1,n2,1), sep="_"), sep = ";", fill = "right", remove=F)

```

```{r IMCI DIAGNOSIS CODING YI INDIA}

#derive a variable that code IMCI diagnosis 
#as a child can have more than one diagnosis, it needs to allow appending multiple ones

###flag
d0$IMCI_der <- ""

#Possible Serious Bacterial Infection or Very Severe Disease
dia_in_yi[1,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & (d0$temp_meas_farenheit>=99.5 | d0$temp_meas_farenheit<95.9 | d0$hypox_country==3 | (dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Loss of appetite", "CNS Danger sign"))]) | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever", "Complicated prolonged fever", "Prolonged Fever", "Fever without source presumed bacterial infection", "Febrile urinary tract infection", "Pyrexia"))] & d0$temp_meas_farenheit>=99.5) | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe pneumonia / very severe disease","IMCI/IMAI Pneumonia"))] & d0$who_age_ctg=="[1-6d]") | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspected meningitis","Very severe disease","Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion","Convulsions"))] ))) )] <- paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & (d0$temp_meas_farenheit>=99.5 | d0$temp_meas_farenheit<95.9 | d0$hypox_country==3 | (dx_oth_yn = 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Loss of appetite", "CNS Danger sign"))]) | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever", "Complicated prolonged fever", "Prolonged Fever", "Fever without source presumed bacterial infection", "Febrile urinary tract infection", "Pyrexia"))] & d0$temp_meas_farenheit>=99.5) | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe pneumonia / very severe disease","IMCI/IMAI Pneumonia"))] & d0$who_age_ctg=="[1-6d]") | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspected meningitis","Very severe disease","Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion","Convulsions"))] ))) )], dia_in_yi$IMCI.code[1], sep=";")
  
  }
}

#Pneumonia
dia_in_yi[2,2:3]
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]")] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]")], dia_in_yi$IMCI.code[2], sep=";")
}


#Local Infection
dia_in_yi[3,2:3] #not specified
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Boils"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Boils"))])], dia_in_yi$IMCI.code[2], sep=";")
}


#Infection unlikely
dia_in_yi[4,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & ((d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cough", "Common cold","Cold","Upper Respiratory Tract Infection (URTI)","Viral Acute Pharyngitis","Dry Cough"))] | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever"))] & d0$temp_meas_farenheit<99.5) ))  )] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & ((d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cough", "Common cold","Cold","Upper Respiratory Tract Infection (URTI)","Viral Acute Pharyngitis","Dry Cough"))] | (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever"))] & d0$temp_meas_farenheit<99.5) ))  )], dia_in_yi$IMCI.code[4], sep=";")
}


#Very low weight for age
dia_in_yi[5,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 &  ((d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))]) | d0$wt_meas<1.8) )] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 &  (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))]) | d0$wt_meas<1.8) )], dia_in_yi$IMCI.code[5], sep=";")
}


#Low weight for age or feeding problem
dia_in_yi[6,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Difficulty in Feeding"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Difficulty in Feeding"))])], dia_in_yi$IMCI.code[6], sep=";")
}

#No Feeding Problem
dia_in_yi[7,2:3] #not specified


#Severe dysentery
dia_in_yi[8,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Dysentery"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Dysentery"))])], dia_in_yi$IMCI.code[8], sep=";")
}


#Persistent diarrhea
dia_in_yi[9,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Persistent diarrhea"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Persistent diarrhea"))])], dia_in_yi$IMCI.code[9], sep=";")
}


#Severe Dehydration
dia_in_yi[10,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Dehydration"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Dehydration"))])], dia_in_yi$IMCI.code[10], sep=";")
}

#Some Dehydration
dia_in_yi[11,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Some Dehydration"))])] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Some Dehydration"))])], dia_in_yi$IMCI.code[11], sep=";")
}

#No Dehydration
dia_in_yi[12,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute diarrhea"))] & grepl(dia_in_yi$IMCI.code[which(dia_in_yi$IMNCI.diagnosis=="Some Dehydration")], d0$IMCI_der)==F & grepl(dia_in_yi$IMCI.code[which(dia_in_yi$IMNCI.diagnosis=="Severe Dehydration")], d0$IMCI_der)==F)] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute diarrhea"))] & grepl(dia_in_yi$IMCI.code[which(dia_in_yi$IMNCI.diagnosis=="Some Dehydration")], d0$IMCI_der)==F & grepl(dia_in_yi$IMCI.code[which(dia_in_yi$IMNCI.diagnosis=="Severe Dehydration")], d0$IMCI_der)==F)], dia_in_yi$IMCI.code[12], sep=";")
}

#Severe Jaundice
dia_in_yi[13,2:3] #not possible to code (age=first day of life is an exclusion criteria)
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Jaundice"))] & d0$who_age_ctg=="[1-6d]" )] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Jaundice"))] & d0$who_age_ctg=="[1-6d]")], dia_in_yi$IMCI.code[14], sep=";")
}

#Jaundice
dia_in_yi[14,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Jaundice"))] & d0$who_age_ctg%in%c("[1-6d]","[7-27d]","[28-59d]"))] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Jaundice"))] & d0$who_age_ctg%in%c("[1-6d]","[7-27d]","[28-59d]"))], dia_in_yi$IMCI.code[14], sep=";")
}

#No Jaundice
dia_in_yi[15,2:3] #not specified


#HIV Confirmed
dia_in_yi[16,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known HIV"))]) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known HIV"))]) ], dia_in_yi$IMCI.code[16], sep=";")
}

#HIV Infection Unlikely 
dia_in_yi[17,2:3] #not specified

#HIV Infection Status Unknown 
dia_in_yi[18,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("HIV screening unavailable"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("HIV screening unavailable"))] )], dia_in_yi$IMCI.code[18], sep=";")
}

#HIV Exposed
dia_in_yi[19,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Possible HIV", "Negative HIV test"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Possible HIV", "Negative HIV test"))] )], dia_in_yi$IMCI.code[19], sep=";")
}

#Other
dia_in_yi[20,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild/Moderate anemia"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild/Moderate anemia"))] )], dia_in_yi$IMCI.code[20], sep=";")
}


dia_in_yi[21,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe anemia"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe anemia"))] )], dia_in_yi$IMCI.code[21], sep=";")
}


dia_in_yi[22,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated severe acute malnutrition","Uncomplicated Severe acute malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated severe acute malnutrition","Uncomplicated Severe acute malnutrition"))] )], dia_in_yi$IMCI.code[22], sep=";")
}

dia_in_yi[23,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate malnutrition"))] )], dia_in_yi$IMCI.code[23], sep=";")
}

dia_in_yi[24,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe malaria","Severe suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe malaria","Severe suspected malaria"))] )], dia_in_yi$IMCI.code[24], sep=";")
}

dia_in_yi[25,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated malaria","Suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated malaria","Suspected malaria"))] )], dia_in_yi$IMCI.code[25], sep=";")
}

dia_in_yi[26,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated prolonged fever","Prolonged Fever"))] & d0$temp_meas_farenheit < 99.5 ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated prolonged fever","Prolonged Fever"))] & d0$temp_meas_farenheit < 99.5 )], dia_in_yi$IMCI.code[26], sep=";")
}

dia_in_yi[27,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever without source presumed bacterial infection"))] & d0$temp_meas_farenheit < 99.5 ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever without source presumed bacterial infection"))] & d0$temp_meas_farenheit < 99.5 )], dia_in_yi$IMCI.code[27], sep=";")
}

dia_in_yi[28,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever without source: Presumed viral illness"))] & d0$temp_meas_farenheit < 99.5 ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever without source: Presumed viral illness"))] & d0$temp_meas_farenheit < 99.5 )], dia_in_yi$IMCI.code[28], sep=";")
}

dia_in_yi[29,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Febrile urinary tract infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Febrile urinary tract infection"))] )], dia_in_yi$IMCI.code[29], sep=";")
}

dia_in_yi[30,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Reactive Airway Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Reactive Airway Disease"))] )], dia_in_yi$IMCI.code[30], sep=";")
}

dia_in_yi[31,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Croup"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Croup"))] )], dia_in_yi$IMCI.code[31], sep=";")
}

dia_in_yi[32,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild Croup", "Non-Severe Abdominal Condition","Constipation","Oral Candidiasis","Viral Conjunctivitis","Uncomplicated chicken pox","Non specific viral rash","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Scabies","Pediculosis (Head lice)","Uncomplicated superficial wound","Abdominal pain","Loose Motion","Acute Gastritis","Acute malnutrition","Allergy","Skin Allergy","Amoebiasis","Fungal Infection","Breathlessness","Bronchitis","Burn","Chest Swelling (Costochondritis)","Cannula phlebitis","Capitis","Chicken Pox","Chicken pox rashes","Body Pain","Teniasis","Dandruff","Dermatitis","Itching","Gastritis ","Body Rashes","Skin Diseases","Vomiting","Weakness"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild Croup", "Non-Severe Abdominal Condition","Constipation","Oral Candidiasis","Viral Conjunctivitis","Uncomplicated chicken pox","Non specific viral rash","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Scabies","Pediculosis (Head lice)","Uncomplicated superficial wound","Abdominal pain","Loose Motion","Acute Gastritis","Acute malnutrition","Allergy","Skin Allergy","Amoebiasis","Fungal Infection","Breathlessness","Bronchitis","Burn","Chest Swelling (Costochondritis)","Cannula phlebitis","Capitis","Chicken Pox","Chicken pox rashes","Body Pain","Teniasis","Dandruff","Dermatitis","Itching","Gastritis ","Body Rashes","Skin Diseases","Vomiting","Weakness"))] ) ], dia_in_yi$IMCI.code[32], sep=";")
}


dia_in_yi[33,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition"))] )], dia_in_yi$IMCI.code[33], sep=";")
}

dia_in_yi[34,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis"))] )], dia_in_yi$IMCI.code[34], sep=";")
}


dia_in_yi[35,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Lower urinary tract infection","Burning urine"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Lower urinary tract infection","Burning urine"))] )], dia_in_yi$IMCI.code[35], sep=";")
}

dia_in_yi[36,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Conjunctivitis"))] )], dia_in_yi$IMCI.code[36], sep=";")
}

dia_in_yi[37,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess"))] )], dia_in_yi$IMCI.code[37], sep=";")
}

dia_in_yi[38,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Simple abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Simple abscess"))] )], dia_in_yi$IMCI.code[38], sep=";")
}

dia_in_yi[39,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated cellulitis"))] )], dia_in_yi$IMCI.code[39], sep=";")
}

dia_in_yi[40,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated cellulitis"))] )], dia_in_yi$IMCI.code[40], sep=";")
}

dia_in_yi[41,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated deep wound"))] )], dia_in_yi$IMCI.code[41], sep=";")
}

dia_in_yi[42,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated superifical wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated superifical wound"))] )], dia_in_yi$IMCI.code[42], sep=";")
}

dia_in_yi[43,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Acute Ear Infection"))] )], dia_in_yi$IMCI.code[43], sep=";")
}

dia_in_yi[44,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Acute Ear Infection"))] )], dia_in_yi$IMCI.code[44], sep=";")
}

dia_in_yi[45,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Chronic Ear Infection"))] )], dia_in_yi$IMCI.code[45], sep=";")
}


dia_in_yi[46,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute otitis media","Acute Suppurative Otitis Media","Uncomplicated Acute Ear Infection","Ear Discharge","Ear Pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute otitis media","Acute Suppurative Otitis Media","Uncomplicated Acute Ear Infection","Ear Discharge","Ear Pain"))] )], dia_in_yi$IMCI.code[46], sep=";")
}


dia_in_yi[47,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic Ear Infection"))] )], dia_in_yi$IMCI.code[47], sep=";")
}

dia_in_yi[48,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of Tuberculosis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of Tuberculosis"))] )], dia_in_yi$IMCI.code[48], sep=";")
}

dia_in_yi[49,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of foreign object in airways"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of foreign object in airways"))] )], dia_in_yi$IMCI.code[49], sep=";")
}

dia_in_yi[50,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Significant hemoptysis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Significant hemoptysis"))] )], dia_in_yi$IMCI.code[50], sep=";")
}

dia_in_yi[51,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Oxyuriasis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Oxyuriasis"))] )], dia_in_yi$IMCI.code[51], sep=";")
}

dia_in_yi[52,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Balanitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Balanitis"))] )], dia_in_yi$IMCI.code[52], sep=";")
}

dia_in_yi[53,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Vulvovaginitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Vulvovaginitis"))] )], dia_in_yi$IMCI.code[53], sep=";")
}

dia_in_yi[54,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Inguinal hernia"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Inguinal hernia"))] )], dia_in_yi$IMCI.code[54], sep=";")
}

dia_in_yi[55,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspected Testicular Torsion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspected Testicular Torsion"))] )], dia_in_yi$IMCI.code[55], sep=";")
}

dia_in_yi[56,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mastoiditis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mastoiditis"))] )], dia_in_yi$IMCI.code[56], sep=";")
}

dia_in_yi[57,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Foreign body in ear"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Foreign body in ear"))] )], dia_in_yi$IMCI.code[57], sep=";")
}

dia_in_yi[58,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Acute Pharyngitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Acute Pharyngitis"))] )], dia_in_yi$IMCI.code[58], sep=";")
}

dia_in_yi[59,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Neck mass"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Neck mass"))] )], dia_in_yi$IMCI.code[59], sep=";")
}

dia_in_yi[60,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Infectious uncomplicated lymphadenitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Infectious uncomplicated lymphadenitis"))] )], dia_in_yi$IMCI.code[60], sep=";")
}

dia_in_yi[61,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated lymphadenopathy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated lymphadenopathy"))] )], dia_in_yi$IMCI.code[61], sep=";")
}

dia_in_yi[62,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mumps"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mumps"))] )], dia_in_yi$IMCI.code[62], sep=";")
}

dia_in_yi[63,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Viral Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Viral Conjunctivitis"))] )], dia_in_yi$IMCI.code[63], sep=";")
}

dia_in_yi[64,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Orbital Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Orbital Cellulitis"))] )], dia_in_yi$IMCI.code[64], sep=";")
}

dia_in_yi[65,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Preseptal Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Preseptal Cellulitis"))] )], dia_in_yi$IMCI.code[65], sep=";")
}

dia_in_yi[66,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Eye Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Eye Disease"))] )], dia_in_yi$IMCI.code[66], sep=";")
}

dia_in_yi[67,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Corneal Abrasion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Corneal Abrasion"))] )], dia_in_yi$IMCI.code[67], sep=";")
}

dia_in_yi[68,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe complicated measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe complicated measles"))] )], dia_in_yi$IMCI.code[68], sep=";")
}

dia_in_yi[69,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Measles with eye or mouth complications"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Measles with eye or mouth complications"))] )], dia_in_yi$IMCI.code[69], sep=";")
}

dia_in_yi[70,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Non-severe measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Non-severe measles"))] )], dia_in_yi$IMCI.code[70], sep=";")
}

dia_in_yi[71,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Scarlet Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Scarlet Fever"))] )], dia_in_yi$IMCI.code[71], sep=";")
}

dia_in_yi[72,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Anaphylaxis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Anaphylaxis"))] )], dia_in_yi$IMCI.code[72], sep=";")
}

dia_in_yi[73,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Urticaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Urticaria"))] )], dia_in_yi$IMCI.code[73], sep=";")
}

dia_in_yi[74,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Impetigo"))] )], dia_in_yi$IMCI.code[74], sep=";")
}

dia_in_yi[75,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Impetigo"))] )], dia_in_yi$IMCI.code[75], sep=";")
}

dia_in_yi[76,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Extensive folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Extensive folliculitis"))] )], dia_in_yi$IMCI.code[76], sep=";")
}

dia_in_yi[77,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Folliculitis"))] )], dia_in_yi$IMCI.code[77], sep=";")
}

dia_in_yi[78,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Molluscum contagiosum"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Molluscum contagiosum"))] )], dia_in_yi$IMCI.code[78], sep=";")
}

dia_in_yi[79,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Generalized (extensive) Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Generalized (extensive) Tinea corporis"))] )], dia_in_yi$IMCI.code[79], sep=";")
}

dia_in_yi[80,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Tinea corporis"))] )], dia_in_yi$IMCI.code[80], sep=";")
}

dia_in_yi[81,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Tinea Capitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Tinea Capitis"))] )], dia_in_yi$IMCI.code[81], sep=";")
}

dia_in_yi[82,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis"))] )], dia_in_yi$IMCI.code[82], sep=";")
}

dia_in_yi[83,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic limp or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic limp or joint pain"))] )], dia_in_yi$IMCI.code[83], sep=";")
}

dia_in_yi[84,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute limb or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute limb or joint pain"))] )], dia_in_yi$IMCI.code[84], sep=";")
}

dia_in_yi[85,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated deep wound"))] )], dia_in_yi$IMCI.code[85], sep=";")
}

dia_in_yi[86,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Confirmed fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Confirmed fracture"))] )], dia_in_yi$IMCI.code[86], sep=";")
}

dia_in_yi[87,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Confirmed dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Confirmed dislocation"))] )], dia_in_yi$IMCI.code[87], sep=";")
}

dia_in_yi[88,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of fracture/dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of fracture/dislocation"))] )], dia_in_yi$IMCI.code[88], sep=";")
}

dia_in_yi[89,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Clavicular fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Clavicular fracture"))] )], dia_in_yi$IMCI.code[89], sep=";")
}

dia_in_yi[90,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Contusion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Contusion"))] )], dia_in_yi$IMCI.code[90], sep=";")
}

dia_in_yi[91,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major head injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major head injury"))] )], dia_in_yi$IMCI.code[91], sep=";")
}

dia_in_yi[92,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate Head Injury"))] )], dia_in_yi$IMCI.code[92], sep=";")
}

dia_in_yi[93,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Minor Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Minor Head Injury"))] )], dia_in_yi$IMCI.code[93], sep=";")
}

dia_in_yi[94,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major Burn"))] )], dia_in_yi$IMCI.code[94], sep=";")
}

dia_in_yi[95,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Minor Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Minor Burn"))] )], dia_in_yi$IMCI.code[95], sep=";")
}

dia_in_yi[96,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Inhalation injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Inhalation injury"))] )], dia_in_yi$IMCI.code[96], sep=";")
}

dia_in_yi[97,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Carbon monoxide poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Carbon monoxide poisoning"))] )], dia_in_yi$IMCI.code[97], sep=";")
}

dia_in_yi[98,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of poisoning"))] )], dia_in_yi$IMCI.code[98], sep=";")
}

dia_in_yi[99,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Suspicion of poisoning"))] )], dia_in_yi$IMCI.code[99], sep=";")
}

dia_in_yi[100,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major trauma"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Major trauma"))] )], dia_in_yi$IMCI.code[100], sep=";")
}

dia_in_yi[101,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Vit A Supplementation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Vit A Supplementation"))] )], dia_in_yi$IMCI.code[101], sep=";")
}

dia_in_yi[102,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Incomplete vaccination"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Incomplete vaccination"))] )], dia_in_yi$IMCI.code[102], sep=";")
}

dia_in_yi[103,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Deworming"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Deworming"))] )], dia_in_yi$IMCI.code[103], sep=";")
}

dia_in_yi[104,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known sickle cell disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known sickle cell disease"))] )], dia_in_yi$IMCI.code[104], sep=";")
}

dia_in_yi[105,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cerebral palsy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cerebral palsy"))] )], dia_in_yi$IMCI.code[105], sep=";")
}

dia_in_yi[106,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Congenital heart disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Congenital heart disease"))] )], dia_in_yi$IMCI.code[106], sep=";")
}

dia_in_yi[107,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c(" Regurgitation  "))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c(" Regurgitation  "))] )], dia_in_yi$IMCI.code[107], sep=";")
}

dia_in_yi[108,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Umbilical pain","Anal fissure"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Umbilical pain","Anal fissure"))] )], dia_in_yi$IMCI.code[108], sep=";")
}

dia_in_yi[109,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Blepharitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Blepharitis"))] )], dia_in_yi$IMCI.code[109], sep=";")
}

dia_in_yi[110,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Blood in Urine (Hematuria)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Blood in Urine (Hematuria)"))] )], dia_in_yi$IMCI.code[110], sep=";")
}

dia_in_yi[111,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Epilepsy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Epilepsy"))] )], dia_in_yi$IMCI.code[111], sep=";")
}

dia_in_yi[112,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Eye Infection","Conjuctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Eye Infection","Conjuctivitis"))] )], dia_in_yi$IMCI.code[112], sep=";")
}

dia_in_yi[113,2:3] 
for(i in 1:n1){
      d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Congenital Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Congenital Disease"))] )], dia_in_yi$IMCI.code[113], sep=";")
}




```

```{r IMCI DIAGNOSIS CODING YI TANZANIA}

#derive a variable that code IMCI diagnosis 
#as a child can have more than one diagnosis, it needs to allow appending multiple ones

#Possible Serious Bacterial Infection or Very Severe Disease
dia_tz_yi[1,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$temp_meas>=38 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsion"))] |
(d0$dx_oth_yn == 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Loss of appetite", "Suspected meningitis", "Very severe disease", "Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion"))] |
                   (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]") | 
((d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia","Severe pneumonia / very severe disease"))] | d0$dx_pneumonia==1) & d0$who_age_ctg=="[1-6d]") |
(d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] & d0$temp_meas>=38) |  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("CNS Danger sign"))] |
(d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] & d0$temp_meas>=38)))  )  )] <- paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$temp_meas>=38 | d0$temp_meas<35.5 | d0$hypox_country==3 | d0$dx_severe==1 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsion"))] |
(d0$dx_oth_yn == 1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Loss of appetite", "Suspected meningitis", "Very severe disease", "Hypoxaemia", "Very severe febrile disease", "Simple febrile convulsion"))] |
                   (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]") | 
((d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia","Severe pneumonia / very severe disease"))] | d0$dx_pneumonia==1) & d0$who_age_ctg=="[1-6d]") |
(d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] & d0$temp_meas>=38) |  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("CNS Danger sign"))] |
(d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] & d0$temp_meas>=38)))  )  )], dia_tz_yi$IMCI.code[1], sep=";")
  
  }
}

#Pneumonia
dia_tz_yi[2,2:3]
for(i in 1:n1){
d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]"))  )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_pneumonia==1 & d0$who_age_ctg=="[1-6d]") | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia", "Severe pneumonia / very severe disease"))] & d0$who_age_ctg=="[1-6d]"))  )], dia_tz_yi$IMCI.code[2], sep=";")
}


#Local Infection
dia_tz_yi[3,2:3] #not specified


#Infection unlikely
dia_tz_yi[4,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough / cold / URTI"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough", "Common cold"))] ))  )] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough / cold / URTI"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough", "Common cold"))] ))  )], dia_tz_yi$IMCI.code[4], sep=";")
}
}


#Very low weight for age
dia_tz_yi[5,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))] & d0$who_age_ctg=="[1-6d]") | (d0$wt_meas<2 & d0$who_age_ctg=="[1-6d]") ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))] & d0$who_age_ctg=="[1-6d]") | (d0$wt_meas<2 & d0$who_age_ctg=="[1-6d]") ) )], dia_tz_yi$IMCI.code[5], sep=";")
}


#Low weight for age or feeding problem
dia_tz_yi[6,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Low weight"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0$dx_oth_yn==1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Oral Candidiasis", "Oral aphthous ulcers", "Herpes simplex - Oral Lesions (Herpes labialis)"))])) )    )] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Low weight"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))] & d0$who_age_ctg%in%c("[7-27d]", "[28-59d]") ) | (d0$dx_oth_yn==1 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Oral Candidiasis", "Oral aphthous ulcers", "Herpes simplex - Oral Lesions (Herpes labialis)"))])) )    )], dia_tz_yi$IMCI.code[6], sep=";")
}
}

#No Feeding Problem
dia_tz_yi[7,2:3] #not specified


#Severe Dehydration
dia_tz_yi[8,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Dehydration"))]) ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Dehydration"))]) ) )], dia_tz_yi$IMCI.code[8], sep=";")
}


#Some Dehydration
dia_tz_yi[9,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Some Dehydration"))]) ) )] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  (d0$dx_diarrhoea==1 & (d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Some Dehydration"))]) ) )], dia_tz_yi$IMCI.code[9], sep=";")
}


#No Dehydration
dia_tz_yi[10,2:3]
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==0 | (d0$dx_dehydration==1 & d0$dx_dehydration_severity==0))) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & (d0$dx_diarrhoea==1 & (d0$dx_dehydration==0 | (d0$dx_dehydration==1 & d0$dx_dehydration_severity==0))) ) ], dia_tz_yi$IMCI.code[10], sep=";")


#HIV Confirmed
dia_tz_yi[11,2:3]
for(i in 1:n1){
  for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known HIV"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV"))]) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known HIV"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV"))]) ) ], dia_tz_yi$IMCI.code[11], sep=";")
}
}

#HIV Exposed
dia_tz_yi[12,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Possible HIV", "Negative HIV test"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Possible HIV", "Negative HIV test"))] )], dia_tz_yi$IMCI.code[12], sep=";")
}

#HIV Infection Status Unknown 
dia_tz_yi[13,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV screening unavailable"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1  & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV screening unavailable"))] )], dia_tz_yi$IMCI.code[13], sep=";")
}


#HIV Infection Unlikely 
dia_tz_yi[14,2:3] #not specified

#Severe Jaundice
dia_tz_yi[15,2:3] #not specified

#Jaundice
dia_tz_yi[16,2:3] #not specified

#No Jaundice
dia_tz_yi[17,2:3] #not specified

#Other
dia_tz_yi[18,2:3] #not specified
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Febrile urinary tract infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Febrile urinary tract infection"))] )], dia_tz_yi$IMCI.code[18], sep=";")
}


dia_tz_yi[19,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Asthma"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Asthma"))] )], dia_tz_yi$IMCI.code[19], sep=";")
}


dia_tz_yi[20,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bronchiolitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bronchiolitis"))] )], dia_tz_yi$IMCI.code[20], sep=";")
}

dia_tz_yi[21,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Wheeze / wheezing"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Wheeze / wheezing"))] )], dia_tz_yi$IMCI.code[21], sep=";")
}

dia_tz_yi[22,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))] )], dia_tz_yi$IMCI.code[22], sep=";")
}

dia_tz_yi[23,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))] )], dia_tz_yi$IMCI.code[23], sep=";")
}

dia_tz_yi[24,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tuberculosis (TB)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tuberculosis (TB)"))] )], dia_tz_yi$IMCI.code[24], sep=";")
}

dia_tz_yi[25,2:3] 
for(j in 1:n2){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] )], dia_tz_yi$IMCI.code[25], sep=";")
}

dia_tz_yi[26,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(0,3,4,5) )], dia_tz_yi$IMCI.code[26], sep=";")

dia_tz_yi[27,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) )], dia_tz_yi$IMCI.code[27], sep=";")

dia_tz_yi[28,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(0,3,4,5) )], dia_tz_yi$IMCI.code[28], sep=";")

dia_tz_yi[29,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2) )], dia_tz_yi$IMCI.code[29], sep=";")

dia_tz_yi[30,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_ear_infection==1) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_ear_infection==1)], dia_tz_yi$IMCI.code[30], sep=";")

dia_tz_yi[31,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe anemia"))])) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(1,2)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe anemia"))])) )], dia_tz_yi$IMCI.code[31], sep=";")
}

dia_tz_yi[32,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(0,3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild/Moderate anemia"))])) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & ((d0$dx_anaemia==1 & d0$dx_anaeamia_severity%in%c(0,3,4,5)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild/Moderate anemia"))])) )], dia_tz_yi$IMCI.code[32], sep=";")
}

dia_tz_yi[33,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated severe acute malnutrition", "Uncomplicated Severe acute malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated severe acute malnutrition", "Uncomplicated Severe acute malnutrition"))] )], dia_tz_yi$IMCI.code[33], sep=";")
}

dia_tz_yi[34,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate malnutrition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate malnutrition"))] )], dia_tz_yi$IMCI.code[34], sep=";")
}


dia_tz_yi[35,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated prolonged fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated prolonged fever"))] )], dia_tz_yi$IMCI.code[35], sep=";")
}

dia_tz_yi[36,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Prolonged Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Prolonged Fever"))] )], dia_tz_yi$IMCI.code[36], sep=";")
}

dia_tz_yi[37,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition"))] )], dia_tz_yi$IMCI.code[37], sep=";")
}

dia_tz_yi[38,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis"))] )], dia_tz_yi$IMCI.code[38], sep=";")
}

dia_tz_yi[39,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Lower urinary tract infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Lower urinary tract infection"))] )], dia_tz_yi$IMCI.code[39], sep=";")
}

dia_tz_yi[40,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Conjunctivitis"))] )], dia_tz_yi$IMCI.code[40], sep=";")
}

dia_tz_yi[41,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess"))] )], dia_tz_yi$IMCI.code[41], sep=";")
}

dia_tz_yi[42,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Simple abscess"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Simple abscess"))] )], dia_tz_yi$IMCI.code[42], sep=";")
}

dia_tz_yi[43,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated cellulitis"))] )], dia_tz_yi$IMCI.code[43], sep=";")
}

dia_tz_yi[44,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Cellulitis"))] )], dia_tz_yi$IMCI.code[44], sep=";")
}

dia_tz_yi[45,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated deep wound"))] )], dia_tz_yi$IMCI.code[45], sep=";")
}

dia_tz_yi[46,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated superifical wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated superifical wound"))] )], dia_tz_yi$IMCI.code[46], sep=";")
}

dia_tz_yi[47,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Acute Ear Infection"))] )], dia_tz_yi$IMCI.code[47], sep=";")
}


dia_tz_yi[48,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Acute Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Acute Ear Infection"))] )], dia_tz_yi$IMCI.code[48], sep=";")
}

dia_tz_yi[49,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Chronic Ear Infection"))] )], dia_tz_yi$IMCI.code[49], sep=";")
}

dia_tz_yi[50,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection"))] )], dia_tz_yi$IMCI.code[50], sep=";")
}

dia_tz_yi[51,2:3] 
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 &  d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_malnutrition==1 & d0$dx_malnutrition_severity%in%c(1,2) )], dia_tz_yi$IMCI.code[51], sep=";")

dia_tz_yi[52,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe suspected malaria"))] )], dia_tz_yi$IMCI.code[52], sep=";")
}

dia_tz_yi[53,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated malaria"))] )], dia_tz_yi$IMCI.code[53], sep=";")
}

dia_tz_yi[54,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspected malaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspected malaria"))] )], dia_tz_yi$IMCI.code[54], sep=";")
}

dia_tz_yi[55,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of Tuberculosis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of Tuberculosis"))] )], dia_tz_yi$IMCI.code[55], sep=";")
}

dia_tz_yi[56,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source: Presumed viral illness"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source: Presumed viral illness"))] )], dia_tz_yi$IMCI.code[56], sep=";")
}

dia_tz_yi[57,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Reactive Airway Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Reactive Airway Disease"))] )], dia_tz_yi$IMCI.code[57], sep=";")
}

dia_tz_yi[58,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Croup"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Croup"))] )], dia_tz_yi$IMCI.code[58], sep=";")
}

dia_tz_yi[59,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild Croup"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild Croup"))] )], dia_tz_yi$IMCI.code[59], sep=";")
}

dia_tz_yi[60,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of foreign object in airways"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of foreign object in airways"))] )], dia_tz_yi$IMCI.code[60], sep=";")
}

dia_tz_yi[61,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Significant hemoptysis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Significant hemoptysis"))] )], dia_tz_yi$IMCI.code[61], sep=";")
}

dia_tz_yi[62,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe persistent diarrhoea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe persistent diarrhoea"))] )], dia_tz_yi$IMCI.code[62], sep=";")
}

dia_tz_yi[63,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Persistent diarrhea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Persistent diarrhea"))] )], dia_tz_yi$IMCI.code[63], sep=";")
}

dia_tz_yi[64,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute diarrhea"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute diarrhea"))] )], dia_tz_yi$IMCI.code[64], sep=";")
}


dia_tz_yi[65,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-Severe Abdominal Condition"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-Severe Abdominal Condition"))] )], dia_tz_yi$IMCI.code[65], sep=";")
}

dia_tz_yi[66,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Constipation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Constipation"))] )], dia_tz_yi$IMCI.code[66], sep=";")
}

dia_tz_yi[67,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Oxyuriasis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Oxyuriasis"))] )], dia_tz_yi$IMCI.code[67], sep=";")
}

dia_tz_yi[68,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Balanitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Balanitis"))] )], dia_tz_yi$IMCI.code[68], sep=";")
}

dia_tz_yi[69,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Vulvovaginitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Vulvovaginitis"))] )], dia_tz_yi$IMCI.code[69], sep=";")
}


dia_tz_yi[70,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Inguinal hernia"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Inguinal hernia"))] )], dia_tz_yi$IMCI.code[70], sep=";")
}


dia_tz_yi[71,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspected Testicular Torsion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspected Testicular Torsion"))] )], dia_tz_yi$IMCI.code[71], sep=";")
}

dia_tz_yi[72,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))] )], dia_tz_yi$IMCI.code[72], sep=";")
}

dia_tz_yi[73,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection"))] )], dia_tz_yi$IMCI.code[73], sep=";")
}

dia_tz_yi[74,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Foreign body in ear"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Foreign body in ear"))] )], dia_tz_yi$IMCI.code[74], sep=";")
}

dia_tz_yi[75,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Acute Pharyngitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Acute Pharyngitis"))] )], dia_tz_yi$IMCI.code[75], sep=";")
}

dia_tz_yi[76,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Viral Acute Pharyngitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Viral Acute Pharyngitis"))] )], dia_tz_yi$IMCI.code[76], sep=";")
}

dia_tz_yi[77,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Neck mass"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Neck mass"))] )], dia_tz_yi$IMCI.code[77], sep=";")
}

dia_tz_yi[78,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Infectious uncomplicated lymphadenitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Infectious uncomplicated lymphadenitis"))] )], dia_tz_yi$IMCI.code[78], sep=";")
}

dia_tz_yi[79,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated lymphadenopathy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated lymphadenopathy"))] )], dia_tz_yi$IMCI.code[79], sep=";")
}

dia_tz_yi[80,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mumps"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mumps"))] )], dia_tz_yi$IMCI.code[80], sep=";")
}

dia_tz_yi[81,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Viral Conjunctivitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Viral Conjunctivitis"))] )], dia_tz_yi$IMCI.code[81], sep=";")
}

dia_tz_yi[82,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Orbital Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Orbital Cellulitis"))] )], dia_tz_yi$IMCI.code[82], sep=";")
}

dia_tz_yi[83,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Preseptal Cellulitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Preseptal Cellulitis"))] )], dia_tz_yi$IMCI.code[83], sep=";")
}

dia_tz_yi[84,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Eye Disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Eye Disease"))] )], dia_tz_yi$IMCI.code[84], sep=";")
}

dia_tz_yi[85,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Corneal Abrasion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Corneal Abrasion"))] )], dia_tz_yi$IMCI.code[85], sep=";")
}

dia_tz_yi[86,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe complicated measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe complicated measles"))] )], dia_tz_yi$IMCI.code[86], sep=";")
}

dia_tz_yi[87,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Measles with eye or mouth complications"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Measles with eye or mouth complications"))] )], dia_tz_yi$IMCI.code[87], sep=";")
}

dia_tz_yi[88,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-severe measles"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-severe measles"))] )], dia_tz_yi$IMCI.code[88], sep=";")
}

dia_tz_yi[89,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated chicken pox"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated chicken pox"))] )], dia_tz_yi$IMCI.code[89], sep=";")
}

dia_tz_yi[90,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated chicken pox"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated chicken pox"))] )], dia_tz_yi$IMCI.code[90], sep=";")
}

dia_tz_yi[91,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non specific viral rash"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non specific viral rash"))] )], dia_tz_yi$IMCI.code[91], sep=";")
}

dia_tz_yi[92,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Scarlet Fever"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Scarlet Fever"))] )], dia_tz_yi$IMCI.code[92], sep=";")
}

dia_tz_yi[93,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Anaphylaxis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Anaphylaxis"))] )], dia_tz_yi$IMCI.code[93], sep=";")
}

dia_tz_yi[94,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Urticaria"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Urticaria"))] )], dia_tz_yi$IMCI.code[94], sep=";")
}

dia_tz_yi[95,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Eczema (Atopic dermatitis)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Eczema (Atopic dermatitis)"))] )], dia_tz_yi$IMCI.code[95], sep=";")
}

dia_tz_yi[96,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Heat rash (Milliaria crystallina/rubra)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Heat rash (Milliaria crystallina/rubra)"))] )], dia_tz_yi$IMCI.code[96], sep=";")
}

dia_tz_yi[97,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Diaper rash"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Diaper rash"))] )], dia_tz_yi$IMCI.code[97], sep=";")
}

dia_tz_yi[98,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Impetigo"))] )], dia_tz_yi$IMCI.code[98], sep=";")
}

dia_tz_yi[99,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Impetigo"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Impetigo"))] )], dia_tz_yi$IMCI.code[99], sep=";")
}

dia_tz_yi[100,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Extensive folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Extensive folliculitis"))] )], dia_tz_yi$IMCI.code[100], sep=";")
}

dia_tz_yi[101,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Folliculitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Folliculitis"))] )], dia_tz_yi$IMCI.code[101], sep=";")
}

dia_tz_yi[102,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Molluscum contagiosum"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Molluscum contagiosum"))] )], dia_tz_yi$IMCI.code[102], sep=";")
}

dia_tz_yi[103,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Generalized (extensive) Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Generalized (extensive) Tinea corporis"))] )], dia_tz_yi$IMCI.code[103], sep=";")
}

dia_tz_yi[104,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tinea corporis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tinea corporis"))] )], dia_tz_yi$IMCI.code[104], sep=";")
}

dia_tz_yi[105,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tinea Capitis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tinea Capitis"))] )], dia_tz_yi$IMCI.code[105], sep=";")
}

dia_tz_yi[106,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Scabies"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Scabies"))] )], dia_tz_yi$IMCI.code[106], sep=";")
}

dia_tz_yi[107,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pediculosis (Head lice)"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pediculosis (Head lice)"))] )], dia_tz_yi$IMCI.code[107], sep=";")
}

dia_tz_yi[108,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis"))] )], dia_tz_yi$IMCI.code[108], sep=";")
}

dia_tz_yi[109,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic limp or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic limp or joint pain"))] )], dia_tz_yi$IMCI.code[109], sep=";")
}

dia_tz_yi[110,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute limp or joint pain"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute limp or joint pain"))] )], dia_tz_yi$IMCI.code[110], sep=";")
}

dia_tz_yi[111,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated deep wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated deep wound"))] )], dia_tz_yi$IMCI.code[111], sep=";")
}

dia_tz_yi[112,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated superficial wound"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated superficial wound"))] )], dia_tz_yi$IMCI.code[112], sep=";")
}

dia_tz_yi[113,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Confirmed fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Confirmed fracture"))] )], dia_tz_yi$IMCI.code[113], sep=";")
}

dia_tz_yi[114,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Confirmed dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Confirmed dislocation"))] )], dia_tz_yi$IMCI.code[114], sep=";")
}

dia_tz_yi[115,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of fracture/dislocation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of fracture/dislocation"))] )], dia_tz_yi$IMCI.code[115], sep=";")
}

dia_tz_yi[116,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Clavicular fracture"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Clavicular fracture"))] )], dia_tz_yi$IMCI.code[116], sep=";")
}

dia_tz_yi[117,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Contusion"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Contusion"))] )], dia_tz_yi$IMCI.code[117], sep=";")
}

dia_tz_yi[118,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major head injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major head injury"))] )], dia_tz_yi$IMCI.code[118], sep=";")
}

dia_tz_yi[119,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate Head Injury"))] )], dia_tz_yi$IMCI.code[119], sep=";")
}

dia_tz_yi[120,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Minor Head Injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Minor Head Injury"))] )], dia_tz_yi$IMCI.code[120], sep=";")
}

dia_tz_yi[121,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major Burn"))] )], dia_tz_yi$IMCI.code[121], sep=";")
}

dia_tz_yi[122,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Minor Burn"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Minor Burn"))] )], dia_tz_yi$IMCI.code[122], sep=";")
}

dia_tz_yi[123,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Inhalation injury"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Inhalation injury"))] )], dia_tz_yi$IMCI.code[123], sep=";")
}

dia_tz_yi[124,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Carbon monoxide poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Carbon monoxide poisoning"))] )], dia_tz_yi$IMCI.code[124], sep=";")
}

dia_tz_yi[125,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of poisoning"))] )], dia_tz_yi$IMCI.code[125], sep=";")
}

dia_tz_yi[126,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Suspicion of poisoning"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Suspicion of poisoning"))] )], dia_tz_yi$IMCI.code[126], sep=";")
}

dia_tz_yi[127,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major trauma"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Major trauma"))] )], dia_tz_yi$IMCI.code[127], sep=";")
}

dia_tz_yi[128,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Vit A Supplementation"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Vit A Supplementation"))] )], dia_tz_yi$IMCI.code[128], sep=";")
}

dia_tz_yi[129,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Incomplete vaccination"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Incomplete vaccination"))] )], dia_tz_yi$IMCI.code[129], sep=";")
}

dia_tz_yi[130,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Deworming"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Deworming"))] )], dia_tz_yi$IMCI.code[130], sep=";")
}

dia_tz_yi[131,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known sickle cell disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known sickle cell disease"))] )], dia_tz_yi$IMCI.code[131], sep=";")
}

dia_tz_yi[132,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cerebral palsy"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cerebral palsy"))] )], dia_tz_yi$IMCI.code[132], sep=";")
}


dia_tz_yi[133,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Congenital heart disease"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Congenital heart disease"))] )], dia_tz_yi$IMCI.code[133], sep=";")
}

dia_tz_yi[134,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Nyingine"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Nyingine"))] )], dia_tz_yi$IMCI.code[134], sep=";")
}


dia_tz_yi[135,2:3] 
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source presumed bacterial infection"))] ) ] <- 
    paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==1 & d0$dx_oth_yn==1 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source presumed bacterial infection"))] )], dia_tz_yi$IMCI.code[135], sep=";")
}


```

```{r IMCI DIAGNOSIS CODING OLDER CHILDREN INDIA}

#Any severe disease
dia_in_ch[1,2:3] #not categorized

#Hypoxaemia
dia_in_ch[2,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Hypoxaemia")]) | d0$hypox_country==3) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Hypoxaemia")]) | d0$hypox_country==3) )], dia_in_ch$IMCI.code[2], sep=";")
}

#Very severe disease
dia_in_ch[3,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe disease", "CNS Danger sign"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe disease", "CNS Danger sign"))]) )], dia_in_ch$IMCI.code[3], sep=";")
}


#Severe pneumonia / very severe disease
dia_in_ch[4,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( (d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Severe pneumonia / very severe disease") )] | (d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Cough"))] & (d0$hypox_country==3 | d0$rr_meas>=70)) ) ) ) ]  <- paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( (d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Severe pneumonia / very severe disease") )] | (d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Cough"))] & (d0$hypox_country==3 | d0$rr_meas>=70)) ) ) ) ], dia_in_ch$IMCI.code[4], sep=";")
}

#Pneumonia 
dia_in_ch[5,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  ( d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Cough"))] & (d0$rr_meas>=50 | (d0$rr_meas>=40 & d0$age_mo>=12)) )  )]  <- paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  ( d0[,paste("dx", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category%in%c("Cough"))] & (d0$rr_meas>=50 | (d0$rr_meas>=40 & d0$age_mo>=12)) )  )] , dia_in_ch$IMCI.code[5], sep=";")
}


#Cough / cold
dia_in_ch[6,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cough", "Common cold"))] & grepl(dia_in_ch$IMCI.code[which(dia_in_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F  & grepl(dia_in_ch$IMCI.code[which(dia_in_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F)] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cough", "Common cold"))] & grepl(dia_in_ch$IMCI.code[which(dia_in_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F  & grepl(dia_in_ch$IMCI.code[which(dia_in_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F)], dia_in_ch$IMCI.code[6], sep=";")
}


#Other respiratory
dia_in_ch[7,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))] )], dia_in_ch$IMCI.code[7], sep=";")
}

#Severe dehydration
dia_in_ch[8,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Dehydration"))] )] <-  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Dehydration"))] )], dia_in_ch$IMCI.code[8], sep=";")
}


#Some dehydration
dia_in_ch[9,2:3]
for(i in 1:n1){
    d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Some Dehydration"))] )] <-  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Some Dehydration"))] )], dia_in_ch$IMCI.code[9], sep=";")
}


#No dehydration
dia_in_ch[10,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute diarrhea"))] )] <-  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Acute diarrhea"))] )], dia_in_ch$IMCI.code[10], sep=";")
}


#Severe persistent diarrhoea
dia_in_ch[11,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe persistent diarrhoea"))])] <-  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe persistent diarrhoea"))])], dia_in_ch$IMCI.code[11], sep=";")
}


#Persistent diarrhoea
dia_in_ch[12,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Persistent diarrhea"))])] <-  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Persistent diarrhea"))])], dia_in_ch$IMCI.code[12], sep=";")
}


#Dysentery
dia_in_ch[13,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Dysentery"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Dysentery"))])], dia_in_ch$IMCI.code[13], sep=";")
}


#Diarrhoea, dehydration unspecified
dia_in_ch[14,2:3] #not coded
   
#Other gastrointestinal
dia_in_ch[15,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))]) )], dia_in_ch$IMCI.code[15], sep=";")
}

#Genitourinary
dia_in_ch[16,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))]) )], dia_in_ch$IMCI.code[16], sep=";")
}

#Very severe febrile disease or severe malaria
dia_in_ch[17,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))]) | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe disease"))]) & d0$malaria_res==1)  )] <- paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))]) | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very severe disease"))]) & d0$malaria_res==1)  )], dia_in_ch$IMCI.code[17], sep=";")
}

#malaria
dia_in_ch[18,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated malaria", "Suspected malaria"))]) | ( d0[,paste("dx", i, sep="_")]!=d0_cb_in$value[which(d0_cb_in$category=="Very severe febrile disease")] & d0$malaria_res==1) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated malaria", "Suspected malaria"))]) | ( d0[,paste("dx", i, sep="_")]!=d0_cb_in$value[which(d0_cb_in$category=="Very severe febrile disease")] & d0$malaria_res==1) ))], dia_in_ch$IMCI.code[18], sep=";")
}


#Fever / Fever (no malaria)
dia_in_ch[19,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$temp_meas_farenheit>=99.5 | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion", "Febrile urinary tract infection"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$temp_meas_farenheit>=99.5 | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion", "Febrile urinary tract infection"))]) ))] , dia_in_ch$IMCI.code[19], sep=";")
}

#Prolonged fever
dia_in_ch[20,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated prolonged fever", "Prolonged Fever"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated prolonged fever", "Prolonged Fever"))]) )], dia_in_ch$IMCI.code[20], sep=";")
}

#Severe complicated measles
dia_in_ch[21,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe complicated measles"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe complicated measles"))]) )], dia_in_ch$IMCI.code[21], sep=";")
}

#Measles with eye or mouth complications
dia_in_ch[22,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Measles with eye or mouth complications"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Measles with eye or mouth complications"))]) )], dia_in_ch$IMCI.code[22], sep=";")
}

#Measles / suspected measles
dia_in_ch[23,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Non-severe measles"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Non-severe measles"))]) )], dia_in_ch$IMCI.code[23], sep=";")
}


#Mastoiditis
dia_in_ch[24,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mastoiditis"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mastoiditis"))]) )], dia_in_ch$IMCI.code[24], sep=";")
}

#Acute ear infection
dia_in_ch[25,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))] )], dia_in_ch$IMCI.code[25], sep=";")
}

#Chronic ear infection
dia_in_ch[26,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))] )], dia_in_ch$IMCI.code[26], sep=";")
}

#No ear infection
dia_in_ch[27,2:3]  #not coded


#Other ENT
dia_in_ch[28,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))])], dia_in_ch$IMCI.code[28], sep=";")
}

#Complicated severe acute malnutrition
dia_in_ch[29,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated severe acute malnutrition"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated severe acute malnutrition"))] )], dia_in_ch$IMCI.code[29], sep=";")
}

#Uncomplicated severe acute malnutrition
dia_in_ch[30,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Severe acute malnutrition"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Uncomplicated Severe acute malnutrition"))]) )], dia_in_ch$IMCI.code[30], sep=";")
}


#Severe acute malnutrition
dia_in_ch[31,2:3] #not coded


#Moderate acute malnutrition
dia_in_ch[32,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate malnutrition"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Moderate malnutrition"))] )], dia_in_ch$IMCI.code[32], sep=";")
}


#No acute malnutrition
dia_in_ch[33,2:3] #not coded

#Malnutrition / low WFA unspecified
dia_in_ch[34,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$wfh_meas%in%c("-2","-3") |  (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))])) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$wfh_meas%in%c("-2","-3") |  (d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))])) )], dia_in_ch$IMCI.code[34], sep=";")
}


#Severe anaemia
dia_in_ch[35,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe anemia"))] )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe anemia"))] )], dia_in_ch$IMCI.code[35], sep=";")
}

#Anaemia
dia_in_ch[36,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild/Moderate anemia"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Mild/Moderate anemia"))])], dia_in_ch$IMCI.code[36], sep=";")
}

#No anaemia
dia_in_ch[37,2:3] #not coded

#Sickle cell disease / trait
dia_in_ch[38,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known sickle cell disease"))]) | d0$scd%in%c(1)))] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known sickle cell disease"))]) | d0$scd%in%c(1)))], dia_in_ch$IMCI.code[38], sep=";")
}



#Confirmed HIV
dia_in_ch[39,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$hiv==1 |  d0$hiv_res==1 | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known HIV"))]) ) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$hiv==1 | d0$hiv_res==1 | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Known HIV"))]) ) )], dia_in_ch$IMCI.code[39], sep=";")
}

#HIV exposed
dia_in_ch[40,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Possible HIV"))])] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 &  d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Possible HIV"))])], dia_in_ch$IMCI.code[40], sep=";")
}


#HIV infection unlikely
dia_in_ch[41,2:3] #not coded

#TB / suspicion of TB
dia_in_ch[42,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of Tuberculosis"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Suspicion of Tuberculosis"))]) ))], dia_in_ch$IMCI.code[42], sep=";")
}


#Eye
dia_in_ch[43,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))]) )], dia_in_ch$IMCI.code[43], sep=";")
}

#Skin (non-measles)
dia_in_ch[44,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess","Simple abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess","Simple abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))]) )], dia_in_ch$IMCI.code[44], sep=";")
}


#Accidents / Trauma / MSK
dia_in_ch[45,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limb or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limb or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))]) )], dia_in_ch$IMCI.code[45], sep=";")
}


```

```{r IMCI DIAGNOSIS CODING OLDER CHILDREN TANZANIA}

#Any severe disease
dia_tz_ch[1,2:3]
d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 &  d0$dx_severe==1)] <- dia_tz_ch$IMCI.code[1]

#Hypoxaemia
dia_tz_ch[2,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Hypoxaemia")]) | d0$hypox_country==3) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Hypoxaemia")]) | d0$hypox_country==3) )], dia_tz_ch$IMCI.code[2], sep=";")
}

#Very severe disease
dia_tz_ch[3,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ds==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very severe disease", "CNS Danger sign"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsions"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ds==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very severe disease", "CNS Danger sign"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsions"))]))], dia_tz_ch$IMCI.code[3], sep=";")
}
}

#Severe pneumonia / very severe disease
dia_tz_ch[4,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_pneumonia==1 & d0$dx_pneumonia_severity%in%c(1,2)) | (d0$dx_pneumonia==1 & d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease") )])) )) ) ]  <- paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_pneumonia==1 & d0$dx_pneumonia_severity%in%c(1,2)) | (d0$dx_pneumonia==1 & d0$dx_pneumonia_severity==98 & (d0$dx_severe==1 | d0$hypox_country==3 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease") )])) )) ) ], dia_tz_ch$IMCI.code[4], sep=";")
}

#Pneumonia 
dia_tz_ch[5,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_pneumonia==1 & d0$dx_pneumonia_severity%in%c(3,4,5)) | (d0$dx_pneumonia==1 & d0$dx_pneumonia_severity==98 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]!=d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease"))]) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia"))]) ))  ]  <- paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_pneumonia==1 & d0$dx_pneumonia_severity%in%c(3,4,5)) | (d0$dx_pneumonia==1 & d0$dx_pneumonia_severity==98 & d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]!=d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe pneumonia / very severe disease"))]) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category%in%c("IMCI/IMAI Pneumonia"))]) ))  ] , dia_tz_ch$IMCI.code[5], sep=";")
}


#Cough / cold
dia_tz_ch[6,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough", "Common cold"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough / cold / URTI"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough", "Common cold"))] | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Cough / cold / URTI"))]))], dia_tz_ch$IMCI.code[6], sep=";")
}
}


#Other respiratory
dia_tz_ch[7,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Asthma", "Bronchiolitis", "Wheeze / wheezing"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Reactive Airway Disease", "Severe Croup", "Mild Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Asthma", "Bronchiolitis", "Wheeze / wheezing"))]) )], dia_tz_ch$IMCI.code[7], sep=";")
}

}

#Severe dehydration
dia_tz_ch[8,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Dehydration"))])) )] <-  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(1,2)) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Dehydration"))])) )], dia_tz_ch$IMCI.code[8], sep=";")
}


#Some dehydration
dia_tz_ch[9,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Some Dehydration"))])) )] <-  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==1 & d0$dx_dehydration_severity%in%c(3,4,5)) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Some Dehydration"))])) )], dia_tz_ch$IMCI.code[9], sep=";")
}


#No dehydration
dia_tz_ch[10,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==0 & d0$dx_dehydration_severity==0) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute diarrhea"))])) )] <-  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0 & d0$dx_dehydration==0 & d0$dx_dehydration_severity==0) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Acute diarrhea"))])) )], dia_tz_ch$IMCI.code[10], sep=";")
}


#Severe persistent diarrhoea
dia_tz_ch[11,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & (grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe persistent diarrhoea"))]) ))] <-  paste(  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & (grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==T | grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==T)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe persistent diarrhoea"))]) ))], dia_tz_ch$IMCI.code[11], sep=";")
}


#Persistent diarrhoea
dia_tz_ch[12,2:3]
for(i in 1:n1){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Persistent diarrhea"))]) ))] <-  paste( d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea_duration==1 & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Persistent diarrhea"))]) ))], dia_tz_ch$IMCI.code[12], sep=";")
}


#Dysentery
dia_tz_ch[13,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ( (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ( (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dysentery"))]))], dia_tz_ch$IMCI.code[13], sep=";")
}
}


#Diarrhoea, dehydration unspecified
dia_tz_ch[14,2:3]
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0)  & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_diarrhoea==1 & d0$dx_diarrhoea_severity!=0)  & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Persistent diarrhoea")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Severe dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Some dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="No dehydration")], d0$IMCI_der)==F & grepl(dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Dysentry")], d0$IMCI_der)==F) )], dia_tz_ch$IMCI.code[14], sep=";")

   
#Other gastrointestinal
dia_tz_ch[15,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition","Non-Severe Abdominal Condition","Constipation","Oxyuriasis","Loss of appetite"))]) )], dia_tz_ch$IMCI.code[15], sep=";")
}

#Genitourinary
dia_tz_ch[16,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Febrile urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis", "Lower urinary tract infection", "Febrile urinary tract infection", "Balanitis", "Vulvovaginitis", "Inguinal hernia", "Suspected Testicular Torsion"))]) )], dia_tz_ch$IMCI.code[16], sep=";")
}

#Very severe febrile disease or severe malaria
dia_tz_ch[17,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2)) | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))]) & (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsions"))] | d0$dx_severe==1 | d0$hypox_country==3)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))])  ))] <- paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_malaria==1 & d0$dx_malaria_severity%in%c(1,2)) | ((d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))]) & (d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Convulsions"))] | d0$dx_severe==1 | d0$hypox_country==3)) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very severe febrile disease","Suspected meningitis","Severe malaria","Severe suspected malaria"))])  ))], dia_tz_ch$IMCI.code[17], sep=";")
  
  }
}

#malaria
dia_tz_ch[18,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated malaria", "Suspected malaria"))]) | d0$malaria_res==2))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malaria_severity%in%c(3,4,5,98) |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated malaria", "Suspected malaria"))]) | d0$malaria_res==2))], dia_tz_ch$IMCI.code[18], sep=";")
}


#Fever / Fever (no malaria)
dia_tz_ch[19,2:3]
for(i in 1:n1){
  for(j in 1:n2){
  d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion", "Febrile urinary tract infection"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Simple febrile convulsion", "Febrile urinary tract infection"))]) ))] , dia_tz_ch$IMCI.code[19], sep=";")
  }
}

#Prolonged fever
dia_tz_ch[20,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated prolonged fever", "Prolonged Fever"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated prolonged fever", "Prolonged Fever"))]) )], dia_tz_ch$IMCI.code[20], sep=";")
}

#Severe complicated measles
dia_tz_ch[21,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe complicated measles"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe complicated measles"))]) )], dia_tz_ch$IMCI.code[21], sep=";")
}

#Measles with eye or mouth complications
dia_tz_ch[22,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Measles with eye or mouth complications"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Measles with eye or mouth complications"))]) )], dia_tz_ch$IMCI.code[22], sep=";")
}

#Measles / suspected measles
dia_tz_ch[23,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-severe measles"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Non-severe measles"))]) )], dia_tz_ch$IMCI.code[23], sep=";")
}


#Mastoiditis
dia_tz_ch[24,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))]) | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mastoiditis"))]))], dia_tz_ch$IMCI.code[24], sep=";")
  }
}

#Acute ear infection
dia_tz_ch[25,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==2 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==2 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Acute Ear Infection","Uncomplicated Acute Ear Infection"))]) ))], dia_tz_ch$IMCI.code[25], sep=";")
}

#Chronic ear infection
dia_tz_ch[26,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Chronic Ear Infection","Complicated Chronic Ear Infection"))]) ))], dia_tz_ch$IMCI.code[26], sep=";")
}

#No ear infection
dia_tz_ch[27,2:3]  #not coded


#Other ENT
dia_tz_ch[28,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_ear_infection_duration==98 | d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Foreign body in ear","Dental Abscess","Tooth pain","Oral aphthous ulcers","Oral Candidiasis","Bacterial Acute Pharyngitis","Viral Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis","Uncomplicated lymphadenopathy","Mumps"))]))], dia_tz_ch$IMCI.code[28], sep=";")
}

#Complicated severe acute malnutrition
dia_tz_ch[29,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==2 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated severe acute malnutrition"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==2 | (d0$dx_oth_yn==1 &d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated severe acute malnutrition"))]) ))], dia_tz_ch$IMCI.code[29], sep=";")
}

#Uncomplicated severe acute malnutrition
dia_tz_ch[30,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Severe acute malnutrition"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Uncomplicated Severe acute malnutrition"))]) )], dia_tz_ch$IMCI.code[30], sep=";")
}


#Severe acute malnutrition
dia_tz_ch[31,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity!=2 & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity!=2 & (d0$dx_malnutrition_severity==1 | (d0$muac_meas<115 & !is.na(d0$muac_meas)) | d0$wfh_meas=="-3")))], dia_tz_ch$IMCI.code[31], sep=";")
}


#Moderate acute malnutrition
dia_tz_ch[32,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3") |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate malnutrition"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity==4 | (d0$muac_meas>=115 & d0$muac_meas<125) | d0$wfh_meas%in%c("-2","-3") |  (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Moderate malnutrition"))]) ))], dia_tz_ch$IMCI.code[32], sep=";")
}


#No acute malnutrition
dia_tz_ch[33,2:3]
d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & d0$dx_malnutrition_severity==0)], dia_tz_ch$IMCI.code[33], sep=";")


#Malnutrition / low WFA unspecified
dia_tz_ch[34,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  (d0$dx_oth_yn==1 &d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Low weight"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_malnutrition_severity%in%c(3,5,98) | d0$wfh_meas%in%c("-2","-3") |  (d0$dx_oth_yn==1 &d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Low weight"))]))], dia_tz_ch$IMCI.code[34], sep=";")
}
}

#Severe anaemia
dia_tz_ch[35,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(1,2) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe anemia"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(1,2) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe anemia"))]) ))], dia_tz_ch$IMCI.code[35], sep=";")
}

#Anaemia
dia_tz_ch[36,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild/Moderate anemia"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_anaeamia_severity%in%c(3,4,5,98) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Mild/Moderate anemia"))]) ))], dia_tz_ch$IMCI.code[36], sep=";")
}

#No anaemia
dia_tz_ch[37,2:3]
d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)] <- 
paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & d0$dx_anaeamia_severity==0)], dia_tz_ch$IMCI.code[37], sep=";")


#Sickle cell disease / trait
dia_tz_ch[38,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known sickle cell disease"))]) | d0$scd%in%c(1)))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known sickle cell disease"))]) | d0$scd%in%c(1)))], dia_tz_ch$IMCI.code[38], sep=";")
}



#Confirmed HIV
dia_tz_ch[39,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$hiv==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known HIV"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$hiv==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Known HIV"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("HIV"))]))], dia_tz_ch$IMCI.code[39], sep=";")
}
}

#HIV exposed
dia_tz_ch[40,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$mother_hiv==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Possible HIV"))]) ))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$mother_hiv==1 | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Possible HIV"))]) ))], dia_tz_ch$IMCI.code[40], sep=";")
}


#HIV infection unlikely
dia_tz_ch[41,2:3] #not coded

#TB / suspicion of TB
dia_tz_ch[42,2:3]
for(i in 1:n1){
  for(j in 1:n2){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of Tuberculosis"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tuberculosis (TB)"))]))] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$tb_res==2 | d0$tb%in%c(1,2,3,4) | (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Suspicion of Tuberculosis"))]) |  d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Tuberculosis (TB)"))]))], dia_tz_ch$IMCI.code[42], sep=";")
}
}


#Eye
dia_tz_ch[43,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Conjunctivitis","Viral Conjunctivitis","Orbital Cellulitis","Preseptal Cellulitis","Severe Eye Disease","Corneal Abrasion"))]) )], dia_tz_ch$IMCI.code[43], sep=";")
}

#Skin (non-measles)
dia_tz_ch[44,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess","Simple abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess","Simple abscess","Complicated cellulitis","Uncomplicated Cellulitis","Complicated chicken pox","Uncomplicated chicken pox","Non specific viral rash","Scarlet Fever","Anaphylaxis","Urticaria","Eczema (Atopic dermatitis)","Heat rash (Milliaria crystallina/rubra)","Diaper rash","Complicated Impetigo","Uncomplicated Impetigo","Extensive folliculitis","Folliculitis","Molluscum contagiosum","Herpes simplex - Oral Lesions (Herpes labialis)","Generalized (extensive) Tinea corporis","Tinea corporis","Tinea Capitis","Scabies","Pediculosis (Head lice)"))]) )], dia_tz_ch$IMCI.code[44], sep=";")
}


#Accidents / Trauma / MSK
dia_tz_ch[45,2:3]
for(i in 1:n1){
   d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limp or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))]) )] <- 
  paste(d0$IMCI_der[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis","Chronic limp or joint pain","Acute limp or joint pain","Complicated deep wound","Uncomplicated deep wound","Complicated superifical wound","Uncomplicated superficial wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Contusion","Major head injury","Moderate Head Injury","Minor Head Injury","Major Burn","Minor Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Uncomplicated Suspicion of poisoning","Major trauma"))]) )], dia_tz_ch$IMCI.code[45], sep=";")
}


```

```{r ADJUST FORMATTING}

#delete duplicated codes that could have been appended with for loops above
d0$IMCI_der <- sapply(strsplit(d0$IMCI_der, ";"), function(x) paste(rle(x)$values,collapse=";"))

#remove ";" if string start
d0$IMCI_der[which(substr(d0$IMCI_der,1,1)==";")] <- substring(d0$IMCI_der[which(substr(d0$IMCI_der,1,1)==";")],first=2)

```

```{r SEVERITY AND ANTIBIO}

#flag severity 
d0$severe_diag <- 0
for(j in dia_in_yi$IMCI.code[which(dia_in_yi$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_tz_yi$IMCI.code[which(dia_tz_yi$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_in_ch$IMCI.code[which(dia_in_ch$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_tz_ch$IMCI.code[which(dia_tz_ch$Severe=="y")]){d0$severe_diag[grep(`j`, d0$IMCI_der)] <- 1}

#flag antibiotic required
d0$antibio_req <- 0
for(j in dia_in_yi$IMCI.code[which(dia_in_yi$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_tz_yi$IMCI.code[which(dia_tz_yi$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_in_ch$IMCI.code[which(dia_in_ch$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}
for(j in dia_tz_ch$IMCI.code[which(dia_tz_ch$Needs.systemic.abx=="y")]){d0$antibio_req[grep(`j`, d0$IMCI_der)] <- 1}


########################
###code special cases
##India young infants 
sev_list_in_yi <- dia_in_yi[which((dia_in_yi$Severe!="y" & dia_in_yi$Severe!="n" & dia_in_yi$Severe!="maybe") | (dia_in_yi$Needs.systemic.abx!="y" & dia_in_yi$Needs.systemic.abx!="n" & dia_in_yi$Needs.systemic.abx!="maybe")), c(2,4,6,10)]
sev_list_in_yi[1,]
  d0$antibio_req[which(d0$country=="in" & d0$yg_infant==1 & grepl(sev_list_in_yi$IMCI.code[1],d0$IMCI_der)==T & d0$who_age_ctg%in%c("[7-27d]","[28-59d]"))] <- 1
sev_list_in_yi[2,]
  d0$antibio_req[which(d0$country=="in" & d0$yg_infant==1 & grepl(sev_list_in_yi$IMCI.code[2],d0$IMCI_der)==T & d0$who_age_ctg%in%c("[7-27d]","[28-59d]"))] <- 1
sev_list_in_yi[3,]
  d0$antibio_req[which(d0$country=="in" & d0$yg_infant==1 & grepl(sev_list_in_yi$IMCI.code[3],d0$IMCI_der)==T & d0$who_age_ctg%in%c("[7-27d]","[28-59d]"))] <- 1


##Tanzania young infants 
sev_list_tz_yi <- dia_tz_yi[which((dia_tz_yi$Severe!="y" & dia_tz_yi$Severe!="n" & dia_tz_yi$Severe!="maybe") | (dia_tz_yi$Needs.systemic.abx!="y" & dia_tz_yi$Needs.systemic.abx!="n" & dia_tz_yi$Needs.systemic.abx!="maybe")), c(2,4,6,10)]

sev_list_tz_yi[1,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[1],d0$IMCI_der)==T & d0$who_age_ctg%in%c("[7-27d]","[28-59d]"))] <- 1
sev_list_tz_yi[2,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[2],d0$IMCI_der)==T & d0$who_age_ctg%in%c("[7-27d]","[28-59d]"))] <- 1
sev_list_tz_yi[3,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[3],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_tz_yi[4,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[4],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_tz_yi[5,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[5],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_tz_yi[6,] 
    d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[6],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_tz_yi[7,] #not coded
sev_list_tz_yi[8,] #not coded
sev_list_tz_yi[9,] 
   d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[9],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1
sev_list_tz_yi[10,] #not coded
   d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==1 & grepl(sev_list_tz_yi$IMCI.code[10],d0$IMCI_der)==T & d0$temp_meas>=38)] <- 1

   
##India older children
sev_list_in_ch <- dia_in_ch[which((dia_in_ch$Severe!="y" & dia_in_ch$Severe!="n" & dia_in_ch$Severe!="maybe") | (dia_in_ch$Needs.systemic.abx!="y" & dia_in_ch$Needs.systemic.abx!="n" & dia_in_ch$Needs.systemic.abx!="maybe")), c(2,5,7,10)]

sev_list_in_ch[1 ,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))]) )] <- 1
}
sev_list_in_ch[2,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition"))]) )] <- 1
       
       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Severe Abdominal Condition"))]) & (d0$temp_meas_farenheit>=99.5 | d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever"))]) )] <- 1
}
sev_list_in_ch[3,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis", "Suspected Testicular Torsion"))]) )] <- 1
       
       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Pyelonephritis", "Lower urinary tract infection"))]) )] <- 1
}    
sev_list_in_ch[4,]
    for(i in 1:n1){
       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Fever without source presumed bacterial infection", "Febrile urinary tract infection"))]) )] <- 1
}   
sev_list_in_ch[5,]
    for(i in 1:n1){
       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Dental Abscess", "Bacterial Acute Pharyngitis", "Complicated Neck mass", "Infectious uncomplicated lymphadenitis"))]) )] <- 1
}   
sev_list_in_ch[6,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))]) | d0$wfa_meas=="-3") & d0$age_mo<6)] <- 1

       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & (( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Very low weight for age"))]) | d0$wfa_meas=="-3") & d0$age_mo<6)] <- 1
}  
sev_list_in_ch[7,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_in_ch[8,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_in_ch[9,] #consider for appropriateness in antibiotic
sev_list_in_ch[10,] #consider for appropriateness in antibiotic
sev_list_in_ch[11,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Orbital Cellulitis", "Preseptal Cellulitis", "Severe Eye Disease", "Corneal Abrasion"))]))] <- 1

       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Orbital Cellulitis", "Preseptal Cellulitis"))]))] <- 1
} 
sev_list_in_ch[12,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess", "Complicated cellulitis", "Complicated chicken pox", "Anaphylaxis"))]))] <- 1

       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess", "Complicated cellulitis", "Uncomplicated Cellulitis", "Scarlet Fever", "Complicated Impetigo", "Extensive folliculitis"))]))] <- 1
} 
sev_list_in_ch[13,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Major head injury","Major Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Major trauma"))]))] <- 1

       d0$antibio_req[which(d0$country=="in" & d0$yg_infant==0 & ( d0[,paste("dx", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound"))]))] <- 1
} 


##Tanzania older children
sev_list_tz_ch <- dia_tz_ch[which((dia_tz_ch$Severe!="y" & dia_tz_ch$Severe!="n") | (dia_tz_ch$Needs.systemic.abx!="y" & dia_tz_ch$Needs.systemic.abx!="n") | dia_tz_ch$Column1!=""), c(2,5,7,10,11)]

sev_list_tz_ch[1,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & d0$intervention==2 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("CNS Danger sign"))]) )] <- 1
}
sev_list_tz_ch[2,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Croup", "Suspicion of foreign object in airways", "Significant hemoptysis"))]) )] <- 1
}
sev_list_tz_ch[3,]
    for(i in 1:n1){
          for(j in 1:n2){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition"))]) )] <- 1
       
       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition"))]) & (d0$temp_meas>=37.5 | d0[,paste("dx_mlist", j, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))] | d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever"))]) )] <- 1
}}  
sev_list_tz_ch[4,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis", "Suspected Testicular Torsion"))]) )] <- 1
       
       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis", "Lower urinary tract infection"))]) )] <- 1
}    
sev_list_tz_ch[5,]
    for(i in 1:n1){
       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source presumed bacterial infection", "Febrile urinary tract infection"))]) )] <- 1
}   
sev_list_tz_ch[6,]
    for(i in 1:n1){
       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dental Abscess", "Bacterial Acute Pharyngitis", "Complicated Neck mass", "Infectious uncomplicated lymphadenitis"))]) )] <- 1
}   
sev_list_tz_ch[7,] #maybe, not specified
sev_list_tz_ch[8,]
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))]) | d0$wfa_meas=="-3") & d0$age_mo<6)] <- 1

       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & ((d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))]) | d0$wfa_meas=="-3") & d0$age_mo<6)] <- 1
}  
sev_list_tz_ch[9,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_tz_ch[10,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_tz_ch[11,] #no antibiotic as per analysis definition - consider for appropriateness in antibiotic
sev_list_tz_ch[12,] #no action required
sev_list_tz_ch[13,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Orbital Cellulitis", "Preseptal Cellulitis", "Severe Eye Disease", "Corneal Abrasion"))]))] <- 1

       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Orbital Cellulitis", "Preseptal Cellulitis"))]))] <- 1
} 
sev_list_tz_ch[14,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess", "Complicated cellulitis", "Complicated chicken pox", "Anaphylaxis"))]))] <- 1

       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess", "Complicated cellulitis", "Uncomplicated Cellulitis", "Scarlet Fever", "Complicated Impetigo", "Extensive folliculitis"))]))] <- 1
} 
sev_list_tz_ch[15,] 
    for(i in 1:n1){
       d0$severe_diag[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound","Confirmed fracture","Confirmed dislocation","Suspicion of fracture/dislocation","Clavicular fracture","Major head injury","Major Burn","Inhalation injury","Carbon monoxide poisoning","Suspicion of poisoning","Major trauma"))]))] <- 1

       d0$antibio_req[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound"))]))] <- 1
} 


#format
d0$severe_diag <- factor(d0$severe_diag)
d0$antibio_req <- factor(d0$antibio_req)


###Split severe diagnosis with and without hypoxaemia
d0$severe_diag2 <- NA
d0$severe_diag2[which(d0$severe_diag==0)] <- 0
d0$severe_diag2[which(d0$severe_diag==1 & d0$hypox_country!=3)] <- 1
d0$severe_diag2[which(d0$severe_diag==1 & d0$hypox_country==3)] <- 2
d0$severe_diag2 <- set_labels(factor(d0$severe_diag2, levels=c(2,1,0)), labels=c("Yes, with severe hypoxaemia", "Yes, without severe hypoxaemia", "No"))



```

```{r FIRST LINE ANTIBIOTIC}

#flag single diagnosis
d0$single_diag <- NA
d0$single_diag[which(grepl(";", d0$IMCI_der)==T)] <- 0
d0$single_diag[which(grepl(";", d0$IMCI_der)==F & d0$IMCI_der!="")] <- 1

########################
##flag antibiotic appropriateness (based on single diagnosis only)

#initialize as zero diagnosis requiring a specific antibiotic
d0$antibio_first_line <- NA
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==1 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_yi$IMCI.code[which(!is.na(dia_in_yi$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==1 & d0$single_diag==1 & d0$IMCI_der%in%dia_tz_yi$IMCI.code[which(!is.na(dia_tz_yi$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_ch$IMCI.code[which(!is.na(dia_in_ch$First.line.abx))])] <- 0 #all that have first line antibiotics
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_tz_ch$IMCI.code[which(!is.na(dia_tz_ch$First.line.abx))])] <- 0 #all that have first line antibiotics


##
##India young infants
first_line_list_in_yi <- table(dia_in_yi$First.line.abx[which(!is.na(dia_in_yi$First.line.abx))], dia_in_yi$IMCI.code[which(!is.na(dia_in_yi$First.line.abx))])
#flag specific antibiotic if as per recommendation
first_line_list_in_yi[1,];row.names(first_line_list_in_yi)[1]  #amoxicillin
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_in_yi[1,]!=0)==T) & d0$rx_amoxicillin_hf==1)] <- 1

first_line_list_in_yi[2,];row.names(first_line_list_in_yi)[2]  #ampicillin and gentamicin
for(i in 1:a1){
  for(j in 1:a3){
    d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_in_yi[2,]!=0)==T) & !is.na(d0$rx_ampicillin_spec_hf) & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")]) )] <- 1
  }
}

first_line_list_in_yi[3,];row.names(first_line_list_in_yi)[3]  #cotrimoxazole
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_in_yi[2,]!=0)==T) & d0$rx_cotrimoxazole_hf==1)] <- 1

first_line_list_in_yi[4,];row.names(first_line_list_in_yi)[4]  #ampicillin and gentamicin
for(i in 1:a1){
  for(j in 1:a3){
    d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_in_yi[4,]!=0)==T) & !is.na(d0$rx_ampicillin_spec_hf) & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")]) )] <- 1
  }
}


##
##Tanzania young infants
first_line_list_tz_yi <- table(dia_tz_yi$First.line.abx[which(!is.na(dia_tz_yi$First.line.abx))], dia_tz_yi$IMCI.code[which(!is.na(dia_tz_yi$First.line.abx))])

#flag specific antibiotic if as per recommendation
first_line_list_tz_yi[1,];row.names(first_line_list_tz_yi)[1]  #amoxicillin
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_tz_yi[1,]!=0)==T) & d0$rx_amoxicillin==1)] <- 1

first_line_list_tz_yi[2,];row.names(first_line_list_tz_yi)[2]  #ampi and genta or genta and amox or genta and penicillin
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_tz_yi[2,]!=0)==T) & ((d0$rx_ampicillin==1 & d0$rx_gentamicin==1) | (d0$rx_gentamicin==1 & d0$rx_amoxicillin==1) | (d0$rx_gentamicin==1 & d0$rx_penicillinG==1)) )] <- 1

first_line_list_tz_yi[3,];row.names(first_line_list_tz_yi)[3]  #cotrimox
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==1 & d0$IMCI_der%in%names(which(first_line_list_tz_yi[3,]!=0)==T) & d0$rx_cotrimoxazole==1)] <- 1


##
##India older children
first_line_list_in_ch <- table(dia_in_ch$First.line.abx[which(!is.na(dia_in_ch$First.line.abx))], dia_in_ch$IMCI.code[which(!is.na(dia_in_ch$First.line.abx))])

#flag specific antibiotic if as per recommendation
first_line_list_in_ch[1,];row.names(first_line_list_in_ch)[1] #re-set to no first line required
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[1,]!=0)==T))] <- NA

first_line_list_in_ch[2,];row.names(first_line_list_in_ch)[2] 
for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[2,]!=0)==T) & ((((is.na(d0$rx_ampicillin_spec_hf) | d0$rx_amoxicillin_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Benzathine benzylpenicillin OR Benzathine penicillin G", "Benzylpenicillin (Benpen) OR Penicillin G") )])) & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")])) | d0$rx_ceftriaxone_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cefotaxime")]) )] <- 1
}
}

first_line_list_in_ch[3,];row.names(first_line_list_in_ch)[3] 
for(k in 1:n1){
  for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[3,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated abscess", "Complicated cellulitis", "Uncomplicated Cellulitis"))] & (d0$rx_aclav_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cefazolin")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cloxacillin")])) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Complicated Impetigo"))] & (d0$rx_aclav_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Clindamycin")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cloxacillin")])) ))] <- 1
}
}
}

first_line_list_in_ch[4,];row.names(first_line_list_in_ch)[4] 
for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[4,]!=0)==T) & ((d0$rx_amoxicillin_hf==1 & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")])) | d0$rx_ceftriaxone_hf==1)  )] <- 1
}
}

first_line_list_in_ch[5,];row.names(first_line_list_in_ch)[5] 
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[5,]!=0)==T) & d0$rx_amoxicillin_hf==1)] <- 1

first_line_list_in_ch[6,];row.names(first_line_list_in_ch)[6] 
for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[6,]!=0)==T) & ((!is.na(d0$rx_ampicillin_spec_hf) & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")])) | (d0$rx_amoxicillin_hf==1 & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")])) | d0$rx_ceftriaxone_hf==1)  )] <- 1
}
}

first_line_list_in_ch[7,];row.names(first_line_list_in_ch)[7] 
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[7,]!=0)==T) & d0$rx_ceftriaxone_hf==1)] <- 1


first_line_list_in_ch[8,];row.names(first_line_list_in_ch)[8] 
for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[8,]!=0)==T) & ((d0$rx_ceftriaxone_hf==1 & d0$rx_metronidazol_hf==1 & (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")])) | d0$rx_ciprofloxacin_hf==1) )] <- 1
}
}

first_line_list_in_ch[9,];row.names(first_line_list_in_ch)[9] 
for(i in 1:a1){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[9,]!=0)==T) & (d0$rx_ceftriaxone_hf==1 | d0$rx_cotrimoxazole_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cefixime")])  )] <- 1
}

first_line_list_in_ch[10,];row.names(first_line_list_in_ch)[10] 
for(i in 1:a1){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[10,]!=0)==T) & (d0$rx_ciprofloxacin_hf==1 | d0$rx_azithromycin_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cefixime")])  )] <- 1
}

first_line_list_in_ch[11,];row.names(first_line_list_in_ch)[11] 
for(i in 1:a1){
    for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[11,]!=0)==T) & (d0$rx_aclav_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cefazolin")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Cloxacillin")]) )] <- 1
}
}

first_line_list_in_ch[12,];row.names(first_line_list_in_ch)[12] 
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[12,]!=0)==T))] <- NA

first_line_list_in_ch[13,];row.names(first_line_list_in_ch)[13] 

first_line_list_in_ch[14,];row.names(first_line_list_in_ch)[14] 
for(k in 1:n1){
  for(i in 1:a1){
  for(j in 1:a3){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[14,]!=0)==T) & (d0[,paste("dx", k, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Osteomyelitis/septic arthritis")] & (d0$rx_aclav_hf==1 | (d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin (Genta)")] | d0[,paste("rx_misc_hf", j, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Gentamicin")]) | d0$rx_ceftriaxone_hf==1) ) )] <- 1
}
}
}

first_line_list_in_ch[15,];row.names(first_line_list_in_ch)[15] 
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[15,]!=0)==T))] <- NA

first_line_list_in_ch[16,];row.names(first_line_list_in_ch)[16] 
for(k in 1:n1){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[16,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Pyelonephritis")] & (d0$rx_aclav_hf==1 | d0$rx_ciprofloxacin_hf==1)) | (d0[,paste("dx", k, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Lower urinary tract infection")] & (d0$rx_amoxicillin_hf==1 | d0$rx_cotrimoxazole_hf==1)) ))] <- 1
}

first_line_list_in_ch[17,];row.names(first_line_list_in_ch)[17] 
for(k in 1:n1){
  for(i in 1:a1){
d0$antibio_first_line[which(d0$country=="in" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_in_ch[17,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Febrile urinary tract infection")] & (d0$rx_cotrimoxazole_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cefixime","Nitrofurantoin"))])) | (d0[,paste("dx", k, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Fever without source presumed bacterial infection")] & (d0$rx_cotrimoxazole_hf==1 | d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]%in%d0_cb_in$value[which(d0_cb_in$category%in%c("Cefixime","Nitrofurantoin"))]))) )] <- 1
}
}


##
##Tanzania older children
first_line_list_tz_ch <- table(dia_tz_ch$First.line.abx[which(!is.na(dia_tz_ch$First.line.abx))], dia_tz_ch$IMCI.code[which(!is.na(dia_tz_ch$First.line.abx))])

#flag specific antibiotic if as per recommendation
first_line_list_tz_ch[1,];row.names(first_line_list_tz_ch)[1] #re-set to no first line required
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[1,]!=0)==T))] <- NA

first_line_list_tz_ch[2,];row.names(first_line_list_tz_ch)[2] 
for(k in 1:n1){
  for(i in 1:a2){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[2,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess", "Complicated cellulitis", "Uncomplicated Cellulitis", "Complicated Impetigo","Extensive folliculitis"))] & (d0$rx_ampicillin_spec==2 | d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Erythromycin OR Erythrogen")])) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Scarlet Fever"))] & (d0$rx_amoxicillin==1 | d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Phenoxymethylpenicillin (Pen V)")])) ))] <- 1
}
}

first_line_list_tz_ch[3,];row.names(first_line_list_tz_ch)[3] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[3,]!=0)==T) & d0$rx_amoxicillin==1)] <- 1

first_line_list_tz_ch[4,];row.names(first_line_list_tz_ch)[4] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[4,]!=0)==T) & ((d0$rx_ampicillin==1 & d0$rx_gentamicin==1) | d0$rx_ceftriaxone==1))] <- 1

first_line_list_tz_ch[5,];row.names(first_line_list_tz_ch)[5] 
for(i in 1:a2){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[5,]!=0)==T) & (d0$rx_ampicillin_spec==2 | d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Erythromycin OR Erythrogen")]))] <- 1
}

first_line_list_tz_ch[6,];row.names(first_line_list_tz_ch)[6] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[6,]!=0)==T) & d0$rx_ceftriaxone==1)] <- 1

first_line_list_tz_ch[7,];row.names(first_line_list_tz_ch)[7] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[7,]!=0)==T) & (d0$rx_ceftriaxone==1 | d0$rx_ciprofloxacin==1) & d0$rx_metronidazol==1  )] <- 1

first_line_list_tz_ch[8,];row.names(first_line_list_tz_ch)[8] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[8,]!=0)==T) & (d0$rx_ciprofloxacin==1 | d0$rx_azithromycin==1))] <- 1

first_line_list_tz_ch[9,];row.names(first_line_list_tz_ch)[9] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[9,]!=0)==T) & d0$rx_ciprofloxacin==1)] <- 1

first_line_list_tz_ch[10,];row.names(first_line_list_tz_ch)[10] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[10,]!=0)==T))] <- NA

first_line_list_tz_ch[11,];row.names(first_line_list_tz_ch)[11] 
for(k in 1:n1){
  for(i in 1:a2){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[11,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dental Abscess"))] & (d0$rx_aclav==1 | d0$rx_amoxicillin==1 | d0$rx_metronidazol==1)) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated Neck mass", "Infectious uncomplicated lymphadenitis"))] & (d0$rx_ampicillin_spec==2 | d0$rx_azithromycin==1)) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Bacterial Acute Pharyngitis"))] & (d0$rx_amoxicillin==1 | d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Phenoxymethylpenicillin (Pen V)")])) ))] <- 1
}
}

first_line_list_tz_ch[12,];row.names(first_line_list_tz_ch)[12] 
for(k in 1:n1){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[12,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Fever without source presumed bacterial infection"))] & d0$rx_ciprofloxacin==1 & d0$rx_amoxicillin==1) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c(" Febrile urinary tract infection"))] & (d0$rx_ciprofloxacin==1 | d0$rx_aclav==1))) )] <- 1
}

first_line_list_tz_ch[13,];row.names(first_line_list_tz_ch)[13] 
for(k in 1:n1){
  for(i in 1:a2){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[13,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated deep wound", "Complicated superifical wound"))] & (d0$rx_aclav==1 | d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Erythromycin OR Erythrogen")])) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis"))] & (d0$rx_ceftriaxone==1 | d0$rx_aclav==1)) ))] <- 1
}
}


first_line_list_tz_ch[14,];row.names(first_line_list_tz_ch)[14] 
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[14,]!=0)==T))] <- NA


first_line_list_tz_ch[15,];row.names(first_line_list_tz_ch)[15] 
for(k in 1:n1){
d0$antibio_first_line[which(d0$country=="tz" & d0$yg_infant==0 & d0$IMCI_der%in%names(which(first_line_list_tz_ch[15,]!=0)==T) & ((d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis "))] & (d0$rx_aclav==1 | d0$rx_ciprofloxacin==1)) | (d0[,paste("dx", k, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Lower urinary tract infection"))] & (d0$rx_cotrimoxazole==1 | d0$rx_amoxicillin==1)) ))] <- 1
}


```

```{r ANTIBIOTIC APPROPRIATENESS}

#appropriate
d0$antibio_app <- NA
d0$antibio_app[which(d0$single_diag==1 & d0$antibio_req==1 & d0$antibio_flag==1)] <- 1
d0$antibio_app[which(d0$single_diag==1 & d0$antibio_req==1 & d0$antibio_flag==0)] <- 0
d0$antibio_app <- as.factor(d0$antibio_app)

#unappropriate
d0$antibio_unapp <- NA
d0$antibio_unapp[which(d0$single_diag==1 & d0$antibio_req==0 & d0$antibio_flag==1)] <- 1
d0$antibio_unapp[which(d0$single_diag==1 & d0$antibio_req==0 & d0$antibio_flag==0)] <- 0
d0$antibio_app <- as.factor(d0$antibio_app)


####adapt for special cases (older children) 
###India
dia_in_ch[grep("Yes*", dia_in_ch$Needs.systemic.abx), c(2,7,8,10)]

#hiv
d0$antibio_app[which(d0$country=="in" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_ch$IMCI.code[grep("co-trimoxazole", dia_in_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & d0$rx_cotrimoxazole_hf==1)] <- 1

d0$antibio_unapp[which(d0$country=="in" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_ch$IMCI.code[grep("co-trimoxazole", dia_in_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & d0$rx_cotrimoxazole_hf==1)] <- 0

#sickle cells
for(k in 1:n1){
  for(i in 1:a1){
d0$antibio_app[which(d0$country=="in" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_ch$IMCI.code[grep("(prophylactic penicillin V)", dia_in_ch$Needs.systemic.abx)] & (d0$scd==2 | d0[,paste("dx",k,sep="_")]=="Known sickle cell disease") & d0$antibio_flag==1 & d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Phenoxymethylpenicillin (Penicillin V)")])] <- 1

d0$antibio_unapp[which(d0$country=="in" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_in_ch$IMCI.code[grep("(prophylactic penicillin V)", dia_in_ch$Needs.systemic.abx)] & (d0$scd==2 | d0[,paste("dx",k,sep="_")]=="Known sickle cell disease") & d0$antibio_flag==1 & d0[,paste("rx_antimicrobials_antimalarials_hf", i, sep="_")]==d0_cb_in$value[which(d0_cb_in$category=="Phenoxymethylpenicillin (Penicillin V)")])] <- 0
}
}

###Tanzania
dia_tz_ch[grep("Yes*", dia_in_ch$Needs.systemic.abx), c(2,7,8,11)]

#hiv
d0$antibio_app[which(d0$country=="tz" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_tz_ch$IMCI.code[grep("co-trimoxazole", dia_tz_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & d0$rx_cotrimoxazole==1)] <- 1

d0$antibio_unapp[which(d0$country=="tz" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_tz_ch$IMCI.code[grep("co-trimoxazole", dia_tz_ch$Needs.systemic.abx)] & d0$antibio_flag==1 & d0$rx_cotrimoxazole==1)] <- 1

#sickle cells
for(k in 1:n1){
  for(i in 1:a2){
d0$antibio_app[which(d0$country=="tz" & d0$yg_infant==0 & d0$single_diag==1 & d0$IMCI_der%in%dia_tz_ch$IMCI.code[grep("(prophylactic penicillin V)", dia_tz_ch$Needs.systemic.abx)] & (d0$scd==2 | d0[,paste("dx",k,sep="_")]=="Known sickle cell disease") & d0$antibio_flag==1 & d0[,paste("rx_antibio_oth", i, sep="_")]==d0_cb_tz$value[which(d0_cb_tz$category=="Phenoxymethylpenicillin (Pen V)")])] <- 1


}
}


```

```{r DEFINE PULSE OX INDICATION}

#all young infants, all older children in Tanzania, children with cough/difficulty breathing or yellow/red IMCI in Senegal

##from IMCI
d0$pulse_ox_ind_imci <- 0
d0$pulse_ox_ind_imci[d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="in")] <- 1
for(k in dia_tz_ch$IMCI.code[which(dia_tz_ch$Pulse.ox=="y")]){d0$pulse_ox_ind_imci[grepl(`k`, d0$IMCI_der)==T & d0$country=="tz" & d0$yg_infant==0] <- 1}

###code special cases
pulseox_list_tz <- dia_tz_ch[which(dia_tz_ch$Pulse.ox!="y" & dia_tz_ch$Pulse.ox!="n"), c(2,4,11)]

#Hypoxaemia
pulseox_list_tz[1,] #not coded

#Other gastrointestinal
pulseox_list_tz[2,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 &d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Severe Abdominal Condition"))]) )] <- 1
}

#Genitourinary 
pulseox_list_tz[3,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 &d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Pyelonephritis", "Lower urinary tract infection"))]) )] <- 1
}

#Fever / Fever (no malaria)
pulseox_list_tz[4,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Simple febrile convulsion","Fever without source presumed bacterial infection","Fever without source: Presumed viral illness","Febrile urinary tract infection"))]))] <- 1
}

#Other ENT
pulseox_list_tz[5,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & d0$dx_ear_infection_duration==98 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Dental Abscess","Bacterial Acute Pharyngitis","Complicated Neck mass","Infectious uncomplicated lymphadenitis"))]) )] <- 1
}

#Other nutritional problem/malnutrition unspecified
pulseox_list_tz[6,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Very low weight for age"))]) & d0$wfa_meas=="-3" )] <- 1
}

#Eye
pulseox_list_tz[7,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Orbital Cellulitis","Preseptal Cellulitis"))] ))] <- 1
}

#Skin (non-measles)
pulseox_list_tz[8,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Complicated abscess", "Simple abscess","Complicated cellulitis", "Uncomplicated Cellulitis","Complicated chicken pox", "Uncomplicated chicken pox", "Scarlet Fever", "Anaphylaxis", "Urticaria"))] ))] <- 1
}

#Accidents / Trauma / MSK 
pulseox_list_tz[9,]
for(i in 1:n1){
  d0$pulse_ox_ind_imci[which(d0$country=="tz" & d0$yg_infant==0 & (d0$dx_oth_yn==1 & d0[,paste("dx", i, sep="_")]%in%d0_cb_tz$value[which(d0_cb_tz$category%in%c("Osteomyelitis/septic arthritis","Complicated deep wound","Complicated superifical wound","Inhalation injury","Carbon monoxide poisoning"))] ))] <- 1
}

##from caregiver
d0$pulse_ox_ind_cg <- 0
d0$pulse_ox_ind_cg[d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="in")] <- 1
d0$pulse_ox_ind_cg[which(d0$country=="tz" & d0$yg_infant==0 & (d0$sx_cough==1 | d0$sx_difficulty_breath==1))] <- 1

##Overall
d0$pulse_ox_ind <- 0
d0$pulse_ox_ind[which(d0$yg_infant==1 | (d0$yg_infant==0 & d0$country=="in") | (d0$yg_infant==0 & d0$country=="tz" & (d0$pulse_ox_ind_imci==1 | d0$pulse_ox_ind_cg==1)))] <- 1


```

```{r DERIVE ADDITIONAL VARIABLES FOR ANALYSIS}

#children who received referral advise on day 0 and are classified as not having severe disease
d0$ref_non_sev <- 0
d0$ref_non_sev[which(d0$severe_diag==0 & d0$urg_ref==1)] <- 1

#flag severe hypoxaemia with no other severe disease
d0$sev_hyp <- 0
d0$sev_hyp[which(d0$hypox_country==3 & (d0$severe_diag==0 | d0$IMCI_der%in%c(dia_in_yi$IMCI.code[which(dia_in_yi$IMNCI.diagnosis=="Hypoxaemia")], dia_tz_yi$IMCI.code[which(dia_tz_yi$IMNCI.diagnosis=="Hypoxaemia")], dia_in_ch$IMCI.code[which(dia_in_ch$IMNCI.diagnosis=="Hypoxaemia")], dia_tz_ch$IMCI.code[which(dia_tz_ch$IMNCI.diagnosis=="Hypoxaemia")]) ) )] <- 1
d0$sev_hyp <- factor(d0$sev_hyp)

##flag hypoxaemic children (country cut-off), referred, who received oxygen at hospital
d0$hypo_o2_ref <- 0
d0$hypo_o2_ref[which(d0$hypox_country==3 & d0$urg_ref==1 & d0$o2==1)] <- 1
d0$hypo_o2_ref <- factor(d0$hypo_o2_ref)

```

```{r SAVE DATASET AFTER MANIPULATION}

save(d0, d7, d28, hos, scrn, country_list, file=file.path(paste(dir_gen_dat, "manipulated_data.RData", sep="/")))

```

